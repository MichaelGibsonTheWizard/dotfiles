QY.prototype.uNa=ea(253,function(a){this.J=mb(arguments,0)});function x_(a){nf(this,a,0,-1,null,null)}w(x_,mf);function y_(a){nf(this,a,0,-1,null,null)}w(y_,mf);function z_(a,b){X(a,1,b)}function Zdd(a,b){X(a,3,b)}function $dd(a,b){X(a,6,b)}function A_(a,b){return V(a,2,b)}function B_(a,b){return V(a,2,b)}function aed(a){return a.C["ritz-DisplayExplorePivotPromoV2"].getValue()}
function bed(a,b,c,d,e){return muc(a,u(function(){return this.C.calculateArrayFormulaResultPreview(b,c,d,e,!1,this.H,!0)},a))}function ced(a,b){a.C=b}function ded(a){var b=0;x(a,function(c,d){c.length>a[b].length&&(b=d)});return Wa(a[b],function(b,d){return Wa(a,function(a){return a[d]})})}
function eed(a,b){var c={row:0,column:0};ritz_api.RitzModelApi.getActiveFilterId(a)&&b&&(b=b.rect,ritz_api.RitzModelApi.getNumberOfRows(a)>b.Zc()+1?c.row=b.Zc()+1:ritz_api.RitzModelApi.getNumberOfColumns(a)>b.ad()+1&&(c.column=b.ad()+1));return c}function fed(a,b,c,d){b="="!=b[0]?"="+b:b;var e=c.C;c=eed(e,c);(a=bed(a.C,b,e,c.row,c.column))&&d&&a.length<a[0].length&&(a=ded(a));return a}
function ged(a){if(a)for(var b=1<a.length?1:0;b<a.length;b++){for(var c=!1,d=a[b],e=0;e<d.length;e++)if(!d[e]){c=!0;break}if(!c)return!0}return!1}function hed(a,b){PY(a);for(var c=0;c<b.length;c++)v6c(a,b[c])}function ied(a,b){if(a.sb()){if(b){var c=le(document);c&&c==a.D.Qa()&&a.C.focus()}Sk(a.Qa(),"waffle-autovis-lightbox-readonly",b);a.D.setVisible(!b)}}var jed=[2];function ked(a){nf(this,a,0,-1,jed,null)}w(ked,mf);var led={Ktc:0,eta:1,tta:2},med=[1,2];
function ned(a){nf(this,a,0,-1,med,null)}w(ned,mf);var oed=[1];function ped(a){nf(this,a,0,-1,oed,null)}w(ped,mf);var qed=[1];function red(a){nf(this,a,0,-1,qed,null)}w(red,mf);var sed=[1];function ted(a){nf(this,a,0,-1,sed,null)}w(ted,mf);var ued=[3];function ved(a){nf(this,a,0,-1,ued,null)}w(ved,mf);ved.prototype.getChartType=function(){return F(this,1)};function wed(a){nf(this,a,0,-1,null,null)}w(wed,mf);function xed(a){nf(this,a,0,-1,null,null)}w(xed,mf);
xed.prototype.getChartType=function(){return F(this,1)};function yed(a){nf(this,a,0,-1,null,null)}w(yed,mf);yed.prototype.uf=function(){return F(this,2)};function C_(a,b){var c=[],d={};if(a>b*b)for(var e=0;e<b;e++){do var f=Math.floor(Math.random()*a);while(d[f]);d[f]=1;c.push(f)}else{for(d=0;d<a;d++)c.push(d);for(d=0;d<b;d++)e=Math.floor(Math.random()*(a-d)+d),f=c[d],c[d]=c[e],c[e]=f}return c.slice(0,b)}function D_(a){return a[C_(a.length,1)[0]]}
function zed(a){var b={};x(a,function(a){b[a]||(b[a]=0);b[a]++});nb(a);qb(a,function(a,d){return b[d]-b[a]})}function Aed(){return P('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content"><div class="waffle-assistant-answercard-interpret-content"><div class="waffle-assistant-answercard-interpret"></div></div><div class="waffle-assistant-answercard-answer-content"><div class="waffle-assistant-answercard-pivot-content"></div></div></div></div>')}
function Bed(a,b,c){b=c||b;return P(O(Kt({Jd:"waffle-assistant-insert-pivottable-button waffle-assistant-readonly-hidden",content:Vs(""+O(au({icon:"docs-icon-img docs-icon-insert-pivot-table"},b))),style:4},b))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+O(Kt({Jd:"waffle-assistant-zoom-button",content:Vs(""+O(au({icon:"docs-icon-img docs-icon-zoom-in"},b))),style:4},b)))}
function Ced(a,b,c){b=c||b;a=Us("Ask a question about your data");a='<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container">'+('<div class="waffle-assistant-answers-search-icon">'+O(au({icon:"docs-icon-img docs-icon-search-this-document"},b))+'</div><input type="text" class="waffle-assistant-answers-input-box" placeholder="'+Q(a)+'" aria-label="'+Q(a)+'"/></div><div class="waffle-assistant-answers-input-controls"><div class="waffle-assistant-answers-button-container">');
a+='<div class="'+Q("waffle-assistant-answers-query-box-button waffle-assistant-answers-clear-query-button")+'">'+O(au({icon:"docs-icon-img docs-icon-cancel"},b))+'</div></div><div class="waffle-assistant-answers-spinner-container" style="display:none"></div></div></form></div>';return P(a)};function E_(){}w(E_,Vr);va(E_);E_.prototype.Tb=n("waffle-assistant-button");function F_(a){M.call(this,a);this.D=new Wr("",new E_,this.va());this.Ha(this.D);this.H=new SW(!1,"#4285f4");this.Ha(this.H);this.C=this.J=this.F=null}r(F_,M);F_.prototype.Ea=function(){this.Qc(N(Ced))};F_.prototype.Qc=function(a){M.prototype.Qc.call(this,a)};
F_.prototype.Ja=function(){M.prototype.Ja.call(this);var a=this.va();this.C=a.Ka("waffle-assistant-answers-query-box",this.Qa());this.D.Wa(a.Ka("waffle-assistant-answers-clear-query-button",this.C));this.F=a.Ka("waffle-assistant-answers-spinner-container",this.C);this.H.render(this.F);this.J=a.Ka("waffle-assistant-answers-input-box",this.C)};F_.prototype.setVisible=function(a){this.getElement()&&(K(this.getElement(),a),(a=bv)&&a.dispatchEvent("resize"))};function Ded(a,b,c,d,e,f){D.call(this,"sqc");this.O=a;this.F=f||"";this.R=b;this.H=d;this.ma=e;this.C=c}w(Ded,D);Ded.prototype.Lj=g("R");function Eed(a,b,c,d,e,f,h){d=void 0===d?null:d;e=void 0===e?null:e;f=void 0===f?null:f;h=void 0===h?null:h;D.call(this,"answers-submit-query");this.O=a;this.R=b;this.H=c;this.F=d;this.ma=e;this.C=f;this.Ga=h}w(Eed,D);function Fed(){this.F=[];this.D={};this.J=null;this.C=new l6c}function Ged(a,b,c,d){function e(a){return a.toLowerCase()}nb(b,void 0,e);nb(c,void 0,e);nb(d,void 0,e);x(b,a.H,a);x(c,a.H,a);x(d,a.H,a)}Fed.prototype.H=function(a){var b=a.toLocaleLowerCase(),c=0;if(100>b.length)for(var d=0;d<b.length&&3>c;++d)if(0==d||/[^a-zA-Z0-9]/.test(b[d-1])&&!/[^a-zA-Z0-9]/.test(b[d])){++c;var e=a,f=b.substr(d),h=this.C.get(f);h||(h=[],this.C.add(f,h));h.push(e)}};
function Hed(a,b){a.D[b.toLowerCase()]||(a.D[b.toLowerCase()]=b)}Fed.prototype.JG=function(a,b,c){if(Lb(a||"")){var d=this.J.xm();d=Ied(this,a.substring(0,d));var e=Jed(this,b-d.length,a);d=jb(d,e)}else d=Jed(this,b);d.length>b&&(d=mb(d,0,b));c(a,d)};
function Jed(a,b,c){var d=c||"";c=fc(a.D,function(a){return Bb(a,d)});var e=Ked(kc(c),d?1:2,1);a=Va(a.F,function(a){return Bb(a.query,d)&&!e[a.query.toLowerCase()]});b=Ked(a,b-jc(e),2);b=kc(b);var f=Wa(b,function(a,b){a.rpa=b;return a.XOa});x(b,function(a){a.qpa=f});return jb(b,kc(e))}
function Ied(a,b){for(var c=[],d=3,e={},f=b.toLowerCase(),h={},k=0;k<f.length&&0<d;h={h$:h.h$,XY:h.XY,UQ:h.UQ},++k)if(0==k||" "==f[k-1]&&" "!=f[k]){h.UQ={};h.XY=0;h.h$=f.substr(k);var l=a.C.ke(h.h$);x(l,function(b){return function(c){var d=c.length-b.h$.length;b.XY=Math.max(d,b.XY);c=a.C.get(c);b.UQ[d]||(b.UQ[d]=[]);lb(b.UQ[d],c)}}(h));for(l=0;l<=h.XY&&0<d;++l){var m=h.UQ[l];if(m)for(var q=0;q<m.length&&0<d;++q){var t=m[q];pba(b,t)||e[t]||(--d,c.push({text:t,aq:"",Wz:0,$ua:f.length-k,XOa:void 0,qpa:[],
rpa:-1}),e[t]=!0)}}}return c}function Ked(a,b,c){b=C_(a.length,Math.min(a.length,b));var d={};x(b,function(b){b=a[b];var e=na(b)?b:b.query;d[e.toLowerCase()]={text:e,aq:na(b)?"":b.aq,Wz:c,$ua:0,XOa:na(b)?void 0:b.type,qpa:[],rpa:-1}});return d};function G_(){pv.call(this,"",null,!1)}w(G_,pv);G_.prototype.yC=function(a,b){if(2==a.Wz||1==a.Wz)return G_.qa.yC.call(this,a.text,b);var c=this.getValue(),d=this.xm(),e=" "==c[d];void 0==c[d]&&(c=c.trim(),d>c.length&&(d=c.length));var f=c.substring(0,d-a.$ua)+a.text;e||(f+=" ");a=G_.qa.yC.call(this,{toString:function(){return f+c.substring(d)}},b);b=this.ek;b.blur();b.focus();this.j_(f.length);return a};
G_.prototype.Sf=function(a){var b=G_.qa.Sf.call(this,a);b||39!=a.keyCode||a.ctrlKey||a.shiftKey||(b=this.C,tYa(b)&&b.qB()&&a.preventDefault(),b=!0);return b};function Led(a,b,c){b=c||b;return P('<div class="waffle-assistant-answers-ac-suggestion"><div class="waffle-assistant-answers-ac-suggestion-icon-container"><div class="waffle-assistant-answers-ac-suggested-query-icon">'+O(au({icon:"docs-icon-img docs-icon-help"},b))+'</div><div class="waffle-assistant-answers-ac-session-query-icon">'+O(au({icon:"docs-icon-img docs-icon-clock"},b))+'</div><div class="waffle-assistant-answers-ac-entity-icon">'+O(au({icon:"docs-icon-img docs-icon-arrow-tilted"},b))+
'</div></div><span class="waffle-assistant-answers-ac-suggestion-text"></span></div>')};function Med(a){this.cb=a||Cd()}
Med.prototype.Ms=function(a,b,c){b=N(Led);var d=this.cb.Ka("waffle-assistant-answers-ac-suggestion-text",b);a=a.data;this.cb.Me(d,a.text);d=this.cb.Ka("waffle-assistant-answers-ac-entity-icon",b);var e=this.cb.Ka("waffle-assistant-answers-ac-suggested-query-icon",b),f=this.cb.Ka("waffle-assistant-answers-ac-session-query-icon",b);K(d,0==a.Wz);K(e,2==a.Wz);K(f,1==a.Wz);d="";switch(a.Wz){case 0:d="waffle-assistant-answers-ac-row-entity";break;case 1:d="waffle-assistant-answers-ac-row-session-query";break;
case 2:d="waffle-assistant-answers-ac-row-suggested-query"}d&&J(c,d);this.cb.appendChild(c,b)};function H_(a,b,c){a&&(ma(b)||(b=a.hasAttribute("title")?a.getAttribute("title"):""),b=Lb(b),Bm(a,b,void 0),KYc(a),JYc(a,500),RT(a,ma(c)?c:1,2))};function Ned(a){var b=a.type;switch(na(b)&&b.toLowerCase()){case "checkbox":case "radio":return a.checked?a.value:null;case "select-one":return b=a.selectedIndex,0<=b?a.options[b].value:null;case "select-multiple":b=[];for(var c,d=0;c=a.options[d];d++)c.selected&&b.push(c.value);return b.length?b:null;default:return null!=a.value?a.value:null}}
function Oed(a,b){var c=a.type;switch(na(c)&&c.toLowerCase()){case "checkbox":case "radio":a.checked=b;break;case "select-one":a.selectedIndex=-1;if(na(b))for(var d=0;c=a.options[d];d++)if(c.value==b){c.selected=!0;break}break;case "select-multiple":na(b)&&(b=[b]);for(d=0;c=a.options[d];d++)if(c.selected=!1,b)for(var e,f=0;e=b[f];f++)c.value==e&&(c.selected=!0);break;default:a.value=null!=b?b:""}};function Ped(a,b,c,d){z.call(this);this.O=a;this.D=a.J;this.F=a.D;this.L=a.C;this.H=new G_;this.H.Nza=!0;this.H.Ga=!0;this.Ba(this.H);this.R=c;this.R.J=this.H;a=new sv(null,new Med(a.va()));this.C=new rv(this.R,a,this.H);this.Ba(this.C);this.oa=b;this.J=!1;this.ma=Pm(new Om,d).build();this.Ma=new Vk(this);this.Ba(this.Ma);Qed(this)}r(Ped,z);
function Qed(a){Red(a);a.H.C=a.C;a.C.UW=!1;a.C.s7=6;VXa(a.H,a.D);H_(a.F.getElement(),"Clear query");a.Ma.V(a.C,"update",a.kgb).V(a.L,"submit",a.FFb).V(a.L,"focus",function(){return Sed(a,!0)},!0).V(a.L,"blur",function(){return Sed(a,!1)},!0).V(a.F,"action",a.A0a).V(a.D,"input",a.UPa).V(a.D,"focus",a.zMa);a.F.setVisible(!1)}p=Ped.prototype;p.Ia=function(){z.prototype.Ia.call(this);this.R.J=null};function Ted(a,b,c){c=void 0===c?!1:c;Oed(a.D,b);c&&a.D.focus();a.UPa()}
function Red(a){a=a.C.Od();a.className="waffle-assistant-answers-ac-renderer";a.vL="waffle-assistant-answers-ac-row";a.Y0="waffle-assistant-answers-ac-active";a.Fja="waffle-assistant-answers-ac-highlighted"}p.kgb=function(a){a.row&&(a=a.row,2==a.Wz?(Ued(this,1,a.qpa,a.rpa,a.aq,2),this.oa.C(2652,this.ma)):0==a.Wz?(this.J=!0,this.oa.C(2651,this.ma)):1==a.Wz&&Ued(this,3))};function Sed(a,b){Sk(a.L,"waffle-assistant-answers-query-box-focused",b);qv(a.C)&&!b&&a.C.Eh()}p.UPa=function(){this.F.setVisible(!!Ned(this.D))};
p.zMa=function(){this.C.Ov(this.D);var a=Wb(Ned(this.D));this.H.j_(a.length);this.C.setToken(a||"  ");this.C.update(!0)};p.FFb=function(a){a.stopPropagation();a.preventDefault();Ued(this,2)};function Ued(a,b,c,d,e,f){c=void 0===c?null:c;d=void 0===d?null:d;e=void 0===e?null:e;f=void 0===f?null:f;var h=Lb(Ned(a.D));a.F.setVisible(!!h);Ved(a);a.O.dispatchEvent(new Eed(b,h,a.J,c,d,e,f));a.J=!1}p.A0a=function(){Oed(this.D,"");this.F.setVisible(!1)};function Ved(a){a.D.blur();qv(a.C)&&a.C.Eh()};function Wed(a,b){M.call(this,b);this.F=a;this.H=new Fed;this.C=new F_(this.va());this.Ha(this.C);this.D=null}r(Wed,M);Wed.prototype.Qc=function(a){M.prototype.Qc.call(this,a);this.C.render(a)};Wed.prototype.Ja=function(){M.prototype.Ja.call(this);this.D=new Ped(this.C,this.F,this.H,4);this.Ba(this.D);J(this.C.Qa(),"waffle-assistant-answers-input-with-icon")};function Xed(){return P('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-before-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-preview"></div><div class="waffle-assistant-after-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-highlights"></div></div>')}
function Yed(a,b,c){b=c||b;return P(O(Kt({Jd:"waffle-assistant-insert-chart-button waffle-assistant-readonly-hidden",content:Vs(""+O(au({icon:"docs-icon-img docs-icon-insert-autovis-chart"},b))),style:4},b))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+O(Kt({Jd:"waffle-assistant-zoom-button",content:Vs(""+O(au({icon:"docs-icon-img docs-icon-zoom-in"},b))),style:4},b)))};function Zed(a){var b='<div class="waffle-assistant-facet-section"><div class="waffle-assistant-facet-header"><div class="waffle-assistant-pie-icon"></div><div class="waffle-assistant-facet-top-text">',c='By <span class="waffle-assistant-facet-title">'+(O(a.I0a)+"</span>"),d=0==a.bza.length;b=b+c+'</div><div class="waffle-assistant-facet-toggle" tabindex="0"></div></div>';if(d)c=P('<div class="waffle-assistant-facet-by-color-container"><div class="waffle-assistant-faceted-chart waffle-assistant-facet-by-color"></div></div>');
else{c='<div class="waffle-assistant-facet-charts-container">';a=a.bza;for(var e=a.length,f=0;f<e;f++){var h=a[f];c+=(0==f%2?'<div class="waffle-assistant-facet-chart-row">':"")+'<div class="waffle-assistant-single-facet"><div class="waffle-assistant-single-facet-title">';c=h?c+O(h):c+"(empty)";c+='</div><div class="waffle-assistant-faceted-chart"></div></div>'+(1==f%2||f==e-1?"</div>":"")}c=P(c+"</div>")}b+='<div class="waffle-assistant-facet-content-wrapper'+(d?" waffle-assistant-facet-white-section":
"")+'">'+c+(dE?'<div class="waffle-assistant-facet-feedback-container"></div><div class="waffle-assistant-facet-thumbs-container"></div>':"")+"</div></div>";return P(b)};function $ed(a,b,c,d){M.call(this,d);this.O=a;this.R=b;this.F=c;this.C=null;this.L=Pm(new Om,10).build()}w($ed,M);$ed.prototype.UDa=function(a,b){this.H(this.O,2746,a,b)};function afd(a,b,c){V4c(b,a.Qa(),a.R,a.F,function(b){bfd(a,b)},void 0,c)}function bfd(a,b){a.getHandler().V(b,"waffle-tvizchart-tooltip-shown",function(){a.C=Ea()}).V(b,"waffle-tvizchart-tooltip-hidden",function(){qa(a.C)&&500<Ea()-a.C&&a.F.C(2750,a.L);a.C=null})};function I_(a,b,c,d,e,f){d=void 0===d?null:d;e=void 0===e?null:e;f=void 0===f?null:f;D.call(this,a,b);this.C=b;this.La=c;this.H=d;this.O=e;this.Na=f}r(I_,D);I_.prototype.Ji=g("La");function cfd(a,b,c,d,e,f,h){h=void 0===h?null:h;I_.call(this,"Ve",null,d,e,f);this.R=a;this.ma=b;this.Ga=c;this.F=h}r(cfd,I_);cfd.prototype.xw=g("R");function dfd(a,b,c,d,e,f,h){$ed.call(this,d,e,f,h);this.ma=a;this.J=b;this.D=c}w(dfd,$ed);dfd.prototype.Ja=function(){dfd.qa.Ja.call(this);afd(this,this.J,this.D)};dfd.prototype.H=function(a,b,c,d){this.dispatchEvent(new cfd(this.ma.copy(),this.D,a,b,c,d))};function efd(a,b,c,d,e,f,h){h=void 0===h?null:h;I_.call(this,"We",null,d,e,f);this.R=a;this.ma=b;this.Kc=c;this.F=h}r(efd,I_);efd.prototype.ge=g("Kc");function ffd(a,b,c,d,e,f){$ed.call(this,c,d,e,f);this.ma=a;this.D=b;this.Kc=null}w(ffd,$ed);ffd.prototype.Ja=function(){ffd.qa.Ja.call(this);(new bW(LL,this.D.qj)).send(u(this.J,this,this.D))};ffd.prototype.H=function(a,b,c,d){this.dispatchEvent(new efd(this.ma.clone(),a,this.Kc,b,c,d))};
ffd.prototype.J=function(a,b){if(b)if(b.Vi())tL.wD(this.Qa(),b);else{a.Mi(b.ge());AX(a,a.ge());var c=(b=a.ge())?b.toJSON():null,d=new ritz.charts.model.GvizChart;d.updateChartWrapperJsonString(a.toJSON());c&&d.updateDataTableJsonString(c);afd(this,d);this.Kc=b}};function gfd(){return P('<div class="waffle-assistant-feedback-card waffle-assistant-feedback-card-hidden"><div class="waffle-assistant-feedback-card-content"><div class="waffle-assistant-feedback-card-text">Tell us what could be improved.</div><div class="waffle-assistant-feedback-card-link">Send feedback</div></div></div>')};function hfd(a,b){M.call(this,b);this.D=a;this.C=new Wr("",new MY,this.va());this.Ha(this.C)}w(hfd,M);p=hfd.prototype;p.Ea=function(){this.mb(N(gfd))};p.Ja=function(){hfd.qa.Ja.call(this);var a=this.Ka("waffle-assistant-feedback-card-link");this.C.Wa(a);this.getHandler().V(this.Qa(),"mousedown",this.$Tb).V(this.C,"action",this.ZTb);this.show(!1)};p.$Tb=function(a){a.stopPropagation()};
p.show=function(a){var b=this.Qa(),c=this.Ka("waffle-assistant-feedback-card-link");Sk(b,"waffle-assistant-feedback-card-hidden",!a);he(c,a)};p.ZTb=function(){(Zj(),Hi).Ob({source:this.D});this.show(!1);this.dispatchEvent(new D("feedback-dialog-opened"))};function ifd(a,b,c){b=c||b;a='<div class="waffle-assistant-thumbs"><div class="waffle-assistant-thumbs-text">Was this useful?'+('</div><div class="waffle-assistant-thumbs-button-holder"><div class="waffle-assistant-thumbs-up-button">'+O(au({icon:"docs-icon-img docs-icon-thumb-up"},b))+'</div><div class="waffle-assistant-thumbs-down-button">'+O(au({icon:"docs-icon-img docs-icon-thumb-down"},b))+"</div></div></div>");return P(a)};function J_(a){M.call(this,a);this.C=new Wr("",new E_,this.va());this.Ha(this.C);this.D=new Wr("",new E_,this.va());this.Ha(this.D)}w(J_,M);J_.prototype.Ea=function(){this.mb(N(ifd))};J_.prototype.Ja=function(){J_.qa.Ja.call(this);var a=this.Ka("waffle-assistant-thumbs-down-button");this.C.Wa(a);H_(a,"Not useful");a=this.Ka("waffle-assistant-thumbs-up-button");this.D.Wa(a);H_(a,"Useful");this.getHandler().V(this.C,"action",this.F).V(this.D,"action",this.H)};
function jfd(a,b){a.va().Me(a.Ka("waffle-assistant-thumbs-text"),b)}J_.prototype.F=function(){this.dispatchEvent(new D("thumbs-down"));K(this.Qa(),!1)};J_.prototype.H=function(){this.dispatchEvent(new D("thumbs-up"));K(this.Qa(),!1)};function kfd(a){a.setLegendPositionType(0);var b=a.getAxis(ritz.charts.model.AxisNames.X);b&&(b.setSlantedTextAngle(0),b.getTickTextStyle().setFontSize(11));(b=a.getAxis(ritz.charts.model.AxisNames.Y))&&b.getTickTextStyle().setFontSize(11);(b=a.getAxis(ritz.charts.model.AxisNames.RIGHT))&&b.getTickTextStyle().setFontSize(11);b=a.getGlobalTextStyle();b.setFontSize(10);b.setItalic(!1);a=a.getTitleTextStyle();a.setBold(!1);a.setFontSize(12)};function lfd(a,b,c,d,e,f){M.call(this,f);this.C=a;this.Na=b;this.Ra=c;this.R=d;this.La=e;this.H=Fx(this.C,23);this.O=V(this.C,22);this.F=V(this.C,26);this.ma=[];this.Oa=new Fz;this.Aa=this.L=this.D=null;this.Da=!1;this.Ga=new Lt("",this.va());this.Ha(this.Ga);this.J=this.oa=null}w(lfd,M);p=lfd.prototype;p.Ea=function(){lfd.qa.Ea.call(this);this.mb(N(Zed,{I0a:this.F,bza:this.H}));this.Qa().style.visibility="hidden"};
p.Ja=function(){lfd.qa.Ja.call(this);var a=this.Ka("waffle-assistant-facet-toggle");this.Ga.Wa(a);this.getHandler().V(this.Qa(),"mousedown",this.HTb).V(this.Ga,"action",this.Vzb);dE&&(this.Aa=new hfd("assistantAutovisFacetFeedback",this.va()),this.Aa.render(this.Ka("waffle-assistant-facet-feedback-container")),this.D=new J_(this.va()),this.Ha(this.D),this.D.render(this.Ka("waffle-assistant-facet-thumbs-container")),jfd(this.D,this.H.length?"Were these charts useful?":"Was this chart useful?"),this.getHandler().V(this.D,
"thumbs-up",this.JTb).V(this.D,"thumbs-down",this.ITb));mfd(this,I(H(),"fefsbd"))};p.Md=g("Da");p.HTb=function(a){a.stopPropagation()};p.Vzb=function(){var a=Kk(this.Ka("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden");mfd(this,a);nfd(this,a?2647:2646)};
function mfd(a,b){var c=a.Ka("waffle-assistant-facet-toggle");ge(c,b?"HIDE":"SHOW");Sk(a.Ka("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden",!b);x(a.$h("waffle-assistant-faceted-chart"),function(a){he(a,b)});a.D&&K(a.D.Qa(),b);var d='Show chart broken down by "'+(a.F+'"');a='Hide chart broken down by "'+(a.F+'"');H_(c,b?a:d)}
function ofd(a,b){var c=a.$h("waffle-assistant-faceted-chart");1==c.length&&2==b.getTypeOrdinal()&&b.setStackingType(1);var d=V(a.C,28).clone();Ex(d,1);for(var e=Fx(a.C,27),f=0;f<e.length;f++)d.addRange(e[f]);for(e=0;e<c.length;e++){f=na(a.H[e])?a.H[e]:null;var h=b.copy();f?h.setFilter(a.O,f):h.setFacet(a.O,[a.O-1]);var k=a,l=h.getTitle();l||(l=z_c(h));h.setTitle(pfd(k,l,f));k=h.copy();k.setChartDataSource(ritz_api.ChartsApi.createChartDataSource(a.Oa.serialize(d)));kfd(k);l=new dfd(h,k,d,a.Na,a.Ra,
a.R,a.va());a.Ha(l);var m=c[e];l.Wa(m);a.ma.push(l);qfd(a,m,z_c(h),f);a.oa=k}rfd(a);a.Qa().style.visibility="visible"}function qfd(a,b,c,d){var e=c+(' broken down by "'+(a.F+('" for "'+(d+'"'))));a=c+(' broken down by "'+(a.F+'"'));Ik(b,d?e:a)}function pfd(a,b,c){var d=b+(' when "'+(a.F+('" is "'+(c+'"'))));a=b+(' by "'+(a.F+'"'));return c?d:a}
function sfd(a){a.setOption("legend","top");a.setOption("titleTextStyle.fontSize",10);a.setOption("allowAsync",!0);a.setOption("applyAggregateData",void 0);a.setOption("pieSliceTextStyle.fontSize",11);a.setOption("tooltip.textStyle.fontSize",11);"BarChart"==a.getChartType()&&a.setOption("isStacked",!0)}function tfd(a){"BarChart"==a.getChartType()&&a.setOption("isStacked",!0);a.setOption("applyAggregateData",void 0)}
function rfd(a){a.Da||x(a.ma,u(function(a){var b=a.Qa();if(!this.La.contains(b)){var d=this.La;a=new ufd(b,a);Bmc(d,a)}},a))}p.JTb=function(){nfd(this,2649)};p.ITb=function(){nfd(this,2648);this.Aa.show(!0)};function nfd(a,b){if(a.oa)F4c(a.R,b,new ZX,10,a.oa,V(a.C,28));else if(a.J){var c=a.R,d=new ZX,e=a.J.getChartType();d.F=e;e=a.J.ge();d.D=e?e.clone():null;I4c(c,b,d,10,a.J,a.J.qj)}};function vfd(){return P('<div class="waffle-assistant-card" tabindex="0" role="region">'+(dE?'<div class="waffle-assistant-card-feedback-container waffle-assistant-feedback-card-hidden"></div>':"")+'<div class="waffle-assistant-card-spinner-container"></div><div class="waffle-assistant-card-inner"><div class="waffle-assistant-button-holder waffle-assistant-card-options"></div><div class="waffle-assistant-card-content-container"></div>'+(dE?'<div class="waffle-assistant-thumbs-container"></div>':"")+
"</div></div>")};function K_(a,b){var c=this;M.call(this,b);this.H=a;this.La=this.Ga=this.O=null;this.kb=new SW(!0,"#4285f4");this.Ha(this.kb);this.Jb=this.Wc=this.xe=!1;this.Ra=new im(function(){c.Ra.stop();c.Qa().parentNode.querySelector(":hover")==c.Qa()?c.Ra.start():c.DF()},100);this.Ba(this.Ra);this.jg=this.Sc=!1}w(K_,M);p=K_.prototype;p.$z=Cc;p.f6=Dc;p.gB=Ec;p.fB=Ec;p.c4=Ec;p.eha=Ec;p.dha=Ec;p.Xs=ca("jg");p.Md=g("jg");p.Ea=function(){var a=N(vfd);this.mb(a)};
p.Ja=function(){K_.qa.Ja.call(this);var a=this.Ka("waffle-assistant-card-spinner-container");this.kb.render(a);cl(this.Ka("waffle-assistant-card-inner"),"visibility","hidden");if(this.$z()){a=this.Qa();var b=new kt(a);this.Ba(b);this.getHandler().V(b,"focusin",this.ghb).V(b,"focusout",this.fhb).V(a,"mouseenter",this.mK).V(a,"mouseleave",this.DF)}wfd(this,!1);dE&&(this.La=new hfd(this.Gy(),this.va()),this.La.render(this.Ka("waffle-assistant-card-feedback-container")),this.getHandler().V(this.La,"feedback-dialog-opened",
this.imb).V(this,"trigger_feedback",this.NSb),this.f6()?(this.Ga=new J_(this.va()),this.Ga.render(this.Ka("waffle-assistant-thumbs-container")),xfd(this,!0),a=Wb(this.c4()),Jb(a)||jfd(this.Ga,a),a=Wb(this.eha()),Jb(a)||H_(this.Ga.Ka("waffle-assistant-thumbs-up-button"),a),a=Wb(this.dha()),Jb(a)||H_(this.Ga.Ka("waffle-assistant-thumbs-down-button"),a),this.getHandler().V(this.Ga,"thumbs-down",this.XTb).V(this.Ga,"thumbs-up",this.YTb)):xfd(this,!1));this.Jx()};
function L_(a){return a.Ka("waffle-assistant-card-content-container")}function M_(a){a.$z();return a.Ka("waffle-assistant-card-options")}function xfd(a,b){dE&&K(a.Ka("waffle-assistant-thumbs-container"),a.f6()&&b)}p.uI=function(){this.isDisposed()||(this.xe=!0,yfd(this))};function zfd(a,b){!a.Wc&&b&&(a.Wc=!0,yfd(a))}function yfd(a){if(a.xe&&a.Wc){var b=u(a.WTb,a);a.Mx(b)}}p.mK=function(){this.Jb||(wfd(this,!0),this.Jb=!0,this.Ra.start())};p.DF=function(){wfd(this,!1);this.Jb=!1};
p.ghb=function(){wfd(this,!0)};p.fhb=function(){var a=this,b=new im(function(){ee(a.Qa(),document.activeElement)||a.Qa().parentNode.querySelector(":hover")==a.Qa()||wfd(a,!1)},0);this.Ba(b);b.start()};p.XTb=function(){Afd(this,!0);xfd(this,!1);var a=this.fB();this.dispatchEvent(new I_("af",this,a))};p.YTb=function(){xfd(this,!1);var a=this.gB();this.dispatchEvent(new I_("af",this,a))};p.imb=function(){Afd(this,!1)};p.NSb=function(){Afd(this,!0)};
function wfd(a,b){var c=a.Ka("waffle-assistant-card-options");a=a.$z();K(c,a&&b)}p.WTb=function(){this.kb.setActive(!1);K(this.kb.Qa(),!1);cl(this.Ka("waffle-assistant-card-inner"),"visibility","visible");this.dispatchEvent(new D("content-rendered"))};function Afd(a,b){Sk(a.Ka("waffle-assistant-card-feedback-container"),"waffle-assistant-feedback-card-hidden",!b);a.La.show(b)};var Bfd={options:{hAxis:{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},vAxes:[{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0}],fontName:"Roboto",legacyContinuousAxisRemoved:!0,booleanRole:"certainty",theme:"material",width:null,height:null}};function Cfd(a){var b=new CL(vc(Bfd));return q6c(a,b)}
function Dfd(a){a.setOption("legend.position","none");a.setOption("hAxis.slantedText",!1);a.setOption("hAxis.textStyle.fontSize",11);a.setOption("vAxes.0.textStyle.fontSize",11);a.setOption("vAxes.1.textStyle.fontSize",11);a.setOption("fontStyle.size",10);a.setOption("fontStyle.italic",!1);a.setOption("titleTextStyle.bold",!1);a.setOption("titleTextStyle.fontSize",12);a.setOption("async",40);!1!==a.getOption("useFirstColumnAsDomain")&&a.ge()&&"number"===a.ge().xd(0)&&a.setOption("hAxis.gridlines.count",
-1);return a};function Efd(a,b,c){var d=a.Zc(),e=a.ad();switch(b){case 0:d=Math.min(d,a.rc()+c);break;case 1:e=Math.min(e,a.qc()+c)}return rB(a.jb(),a.rc(),a.qc(),d,e)}function Ffd(a){var b=new xsa;G(b,1,a.C);var c=a.rect.rc();G(b,2,c);c=a.rect.Zc();G(b,3,c);b.qr(a.rect.qc());b.yx(a.rect.ad());return b}function Gfd(a,b){var c=new bk;if(a){var d=new dk,e=Ffd(a);xf(d,7,e);null!=b&&G(d,19,a.C!=b);xf(c,58,d)}return c};function N_(a,b,c,d,e,f,h,k){K_.call(this,a,k);this.C=V(a,8);this.Ya=b;this.pb=c;this.rb=d;this.L=e;this.Sa=f;this.Vb=h;this.R=new Lt("",this.va());this.Ha(this.R);this.ma=new Lt("",this.va());this.Ha(this.ma);this.Ua=new Fz;this.gb=null;this.Da=!1;this.fb=[];this.$a=[];this.Oa=[];this.Na=this.Aa=this.D=this.J=this.oa=null;a=Gfd(this.Vb,TJ(b));this.F=Qm(Pm(new Om,10),a).build()}w(N_,K_);
var O_={pRa:"waffle-assistant-after-chart-preview",HRa:"waffle-assistant-before-chart-preview",WRa:"waffle-assistant-card-draggable",J0:"waffle-assistant-chart-highlights",qUa:"waffle-assistant-insert-chart-button",kba:"waffle-assistant-chart-preview",bXa:"waffle-assistant-button-separator",KXa:"waffle-assistant-styled-border",LXa:"waffle-assistant-styled-rect",kZa:"waffle-assistant-zoom-button"};p=N_.prototype;
p.Mx=function(a){var b=this;this.isDisposed()||(ritz_api.ChartsApi?(this.gb=a,Hfd(this)):ritz_api.RitzEntryPoint.loadChartsApi(function(){b.Mx(a)}))};p.Jx=function(){var a=this;if(!this.isDisposed())if(I(H(),"fecpmr"))if(ritz_api.ChartsApi){var b=C_c(Ifd(this),V(this.C,28));Ik(this.Qa(),b)}else ritz_api.RitzEntryPoint.loadChartsApi(function(){a.Jx()});else Jfd(this,u(function(a){a=D_c(this.Ya,a);Ik(this.Qa(),a)},this),!1)};p.$z=Dc;p.Gy=n("autovisFeedback");p.gB=n(2208);p.fB=n(2207);p.c4=n("Was this chart useful?");
p.Ea=function(){N_.qa.Ea.call(this);L_(this).appendChild(N(Xed));M_(this).appendChild(N(Yed));if(Bx(this.C,22)){this.D=new lfd(this.C,this.O,this.rb,this.L,this.Sa,this.va());this.Ha(this.D,!0);var a=this.D,b=this.Md();a.Da=b;rfd(a)}};
p.Ja=function(){N_.qa.Ja.call(this);J(this.Qa(),O_.WRa);var a=this.Ka(O_.qUa);this.R.Wa(a);H_(a,"Insert chart");a=this.Ka(O_.kZa);this.ma.Wa(a);H_(a,"View full size");a=this.Ka(O_.HRa);var b=this.Ka(O_.pRa);this.getHandler().V(this.Qa(),"keydown",this.FTb).V(a,"focus",this.Ggb).V(b,"focus",this.xfb).V(this.R,"action",this.Nob).V(this.R.Qa(),"mousedown",this.lqa).V(this.ma,"action",this.FBb).V(this.ma.Qa(),"mousedown",this.lqa).V(this.Ka(O_.J0),"mousedown",this.lqa).V(bJ(this.Ya),"Qb",this.GTb);Kfd(this);
this.L.C(2790,this.F);this.D&&this.L.C(2791,this.F)};p.Xs=function(a){N_.qa.Xs.call(this,a);Kfd(this);this.sb()&&Lfd(this)};function Kfd(a){if(a.sb()){var b=a.Md();a.R.setVisible(!b);a=a.va().Ka(O_.bXa,M_(a));K(a,!b)}}p.FTb=function(a){13==a.keyCode&&a.target==this.Qa()&&(a.preventDefault(),a.stopPropagation(),Mfd(this,2255))};
function Nfd(a){var b=a.getChartType(),c=!!V(a.C,14),d=V(a.C,16),e=!!V(a.C,15),f="Histogram"==b;b="PieChart"==b;var h=$V(Fx(a.H,4));if(!h[0]||h[0].C==TJ(a.Ya)){for(var k=1<h.length,l=[],m=0;m<h.length;m++){var q=h[m].rect;q=c!=b?ojb(q,new zd(q.width,1)):ojb(q,new zd(1,q.height));lb(l,q)}c=nI(a.pb).C;var t=[];for(v in SA)t.push(Z0b(c,SA[v]));var v=Wa(l,function(a){return Wa(t,Da(bB,a))});f&&e&&(v=mb(v,1));a.Oa=Ofd(v.length,b&&0<d||!f&&!b&&e,b&&k);d=nI(a.pb);for(e=0;e<v.length;e++)for(f=a.Oa[e],b=0;b<
v[e].length;b++)v[e][b]&&oB(v[e][b])&&(k=dYc(d,v[e][b],O_.LXa),a.Ba(k),tQ(d.R,"default",k,!0),cl(k.Qa(),"background-color",f),k.setVisible(!0),a.fb.push(k),k=UP(d,v[e][b],O_.KXa,1,0),a.Ba(k),Y9b(k,f),k.setVisible(!0),a.$a.push(k))}}function Pfd(a){xb(a.fb);xb(a.$a);a.fb=[];a.$a=[];a.Oa=[]}p.GTb=function(){this.Da&&(Pfd(this),Nfd(this))};p.mK=function(){N_.qa.mK.call(this);this.Aa=Ea();this.Da||(Nfd(this),this.Da=!0)};
p.DF=function(){N_.qa.DF.call(this);qa(this.Aa)&&500<Ea()-this.Aa&&this.L.C(2789,this.F);this.Aa=null;Pfd(this);this.Da=!1};p.Ggb=function(){var a=this.Ka(O_.J0);Dl(a)?a.focus():this.Qa().nextSibling&&this.Qa().nextSibling.focus()};p.xfb=function(){var a;if(a=this.La)a=this.La,a.ib("waffle-assistant-feedback-card-hidden")?a=!1:(a.Ka("waffle-assistant-feedback-card-link").focus(),a=!0);a||this.ma.Qa().focus()};p.Nob=function(){Mfd(this,2255)};p.lqa=function(a){a.stopPropagation()};
p.FBb=function(){Vrb.Ob(this,this.F)};p.UDa=function(a,b){Mfd(this,2257,a,b)};function Mfd(a,b,c,d){if(I(H(),"fecpmr")){var e=Ifd(a);a.dispatchEvent(new cfd(e,V(a.C,28),a.O,b,c,d,Ewa(a.F)))}else Jfd(a,u(function(a){a=new efd(a,this.O,this.J&&this.J.ge(),b,c,d,Ewa(this.F));this.dispatchEvent(a)},a),!1)}function Qfd(a,b){V4c(b,a.Ka(O_.kba),a.rb,a.L,function(b){Rfd(a,b)})}
function Rfd(a,b){null!==a.oa&&(rq(pq(),a.oa),a.oa=null);a.isDisposed()||(a.getHandler().V(b,"waffle-tvizchart-tooltip-shown",function(){a.Na=Ea()}).V(b,"waffle-tvizchart-tooltip-hidden",function(){qa(a.Na)&&500<Ea()-a.Na&&a.L.C(2750,a.F);a.Na=null}),a.gb(),Lfd(a))}function Lfd(a){if(!a.Md()){var b=a.Ka(O_.kba);if(!a.Sa.contains(b)){var c=a.Sa;a=new ufd(b,a);Bmc(c,a)}}}
function Sfd(a,b,c){var d=[];try{var e=a.Ua.serialize(c);d=Wa(S3c(Da(ritz_api.RitzModelApi.getVerbalHighlightsForProto,e),b).call(),P3c)}catch(f){d=[]}a=a.Ka(O_.J0);K(a,0<d.length);0<d.length&&(a.appendChild(d[0]),he(a,!0))}function Ifd(a){Tfd(a);var b=new ritz.charts.model.ChartImpl,c=V(a.C,28);b.setChartModel(a.Ua.serialize(c.xw()));b.setChartDataSource(ritz_api.ChartsApi.createChartDataSource(a.Ua.serialize(c)));return b}
function Ufd(a){Tfd(a);V(a.C,16);var b=Cfd(a.C);b.toa(LL);var c=s6c(a.H);b.Nl(c.toString());a.D&&(c=c.clone(),a.D.L=c);return b}function Tfd(a){a.Sc&&(a.oa=qq(pq(),"aaoar"),a.Sc=!1)}
function Hfd(a){if(I(H(),"fecpmr")){var b=Ifd(a),c=b.copy();kfd(c);Sfd(a,b,V(a.C,28));Qfd(a,c);a.D&&ofd(a.D,b)}else{var d=Dfd(Ufd(a),a.Ka("waffle-assistant-card-inner"));(new bW(LL,d.qj)).send(function(b){if(b)if(b.Vi())tL.wD(a.Ka(O_.kba),b);else{d.Mi(b.ge());AX(d,d.ge());b=new BD;b.setContext(d.toJSON());var c=!!V(a.C,14);X(b,3,c);var e=V(a.C,16);X(b,4,e);X(b,5,c);X(b,8,0);V(a.C,24)&&(c=V(a.C,25),X(b,9,c));c=$V(Fx(a.H,4));for(e=0;e<c.length;e++)b.addRange(uB(c[e].rect,c[e].C));c=(c=d.ge())?c.toJSON():
null;e=new ritz.charts.model.GvizChart;e.updateChartWrapperJsonString(d.toJSON());c&&e.updateDataTableJsonString(c);Sfd(a,e,b);a.J=d;b=(b=d.ge())?b.toJSON():null;c=new ritz.charts.model.GvizChart;c.updateChartWrapperJsonString(d.toJSON());b&&c.updateDataTableJsonString(b);Qfd(a,c)}});a.D&&Jfd(a,function(b){var c=a.D,e=d;b=new CL(b.toJSON());e=new CL(e.toJSON());var k=c.$h("waffle-assistant-faceted-chart");if(1<k.length){tfd(b);var l=e;sfd(l);l.setOption("pieSliceText","percentage");l.setOption("axisFontSize",
0);l.setOption("hAxis.title",null);l.setOption("hAxis.textPosition","none");l.setOption("vAxes.0.title",null);l.setOption("vAxes.0.textPosition","none");l.setOption("vAxes.1.title",null);l.setOption("vAxes.1.textPosition","none");l.setOption("legend","none");l.setOption("titleTextStyle.fontSize",0)}else l=b,tfd(l),l.setOption("applyAggregateData",void 0),l.setOption("legend","right"),sfd(e);l=$V(Fx(c.C,27));mNb(c.L,l);l=V(c.C,25);for(var m=0;m<k.length;m++){var q=na(c.H[m])?c.H[m]:null,t=l.clone(),
v=c.O,y=new HD;X(y,1,v);na(q)&&y.setValue(q);X(t,7,y);c.L.jc("dt",encodeURIComponent(JSON.stringify(c.Oa.serialize(t))));t=new CL(b.toJSON());t.Nl(c.L.toString());v=e.clone();v.Nl(c.L.toString());y=c;var B=t.getOption("title");B||(B=A_c(t));y=pfd(y,B,q);t.setOption("title",y);v.setOption("title",y);y=new ffd(t,v,c.Na,c.Ra,c.R,c.va());c.Ha(y);B=k[m];y.Wa(B);c.ma.push(y);qfd(c,B,A_c(t),q);c.J=v}rfd(c);c.Qa().style.visibility="visible"},!1)}}
function Jfd(a,b,c){var d=Ufd(a);(new bW(LL,d.qj)).send(function(a){a?(a=a.ge(),c&&d.Mi(a),AX(d,a),b(d)):b(null)})}p.getChartType=function(){return this.C.getChartType()};function Ofd(a,b,c){var d=b?["#666"]:[];c&&(a/=2);b&&--a;b=d2c("material").colors;for(var e=0;e<a;e++)d.push(b[e%b.length].color);c&&lb(d,d);return d};function ufd(a){fS.apply(this,arguments)}r(ufd,fS);ufd.prototype.pha=g("element");function Vfd(){dS.call(this);cmc(this,this);this.Ra="waffle-assistant-dragged-card"}w(Vfd,Amc);Vfd.prototype.contains=function(a){return!!x(this.L,function(b){if(b.element==a)return!0})};Vfd.prototype.nha=function(a){var b=Vfd.qa.nha.call(this,a);a=a.querySelectorAll("CANVAS");for(var c=b.querySelectorAll("CANVAS"),d=0;d<a.length;d++)c[d].getContext("2d").drawImage(a[d],0,0);return b};function Wfd(){return P('<div class="waffle-assistant-word-cloud-card"><div class="waffle-assistant-word-cloud-title"></div><div class="waffle-assistant-word-cloud-words-container"></div></div>')};function Xfd(a,b){K_.call(this,a,b);this.C=V(a,8)}w(Xfd,K_);p=Xfd.prototype;p.Jx=ua;p.Gy=n("assistantWordCloudFeedback");p.gB=n(2634);p.fB=n(2633);p.Ea=function(){Xfd.qa.Ea.call(this);L_(this).appendChild(N(Wfd));J(L_(this),"waffle-assistant-word-cloud-content-container")};
p.Mx=function(a){for(var b=Fx(this.C,19),c=Fx(this.C,20),d=this.Ka("waffle-assistant-word-cloud-words-container"),e=0;e<b.length;e++)if(Yfd(this,b,c,e),120<d.clientHeight){Yfd(this,b,c,e-1);break}b=this.va();c=V(this.C,2);c=qe(b,c);d=this.Ka("waffle-assistant-word-cloud-title");b.appendChild(d,c);a()};
function Yfd(a,b,c,d){var e=a.Ka("waffle-assistant-word-cloud-words-container");for(a=a.va();e.firstChild;)e.removeChild(e.firstChild);for(var f=c[d],h=c[0],k=0;k<=d;k++){0!=k&&e.appendChild(qe(a," "));var l=a.createElement("SPAN");a.appendChild(l,qe(a,b[k]));a.appendChild(e,l);J(l,"waffle-assistant-word-cloud-word");var m=c[k];l.style.color=0==k%2?"#00695C":"#61443C";l.style.fontSize=(m-f)/(h-f)*15+9+"px"}};function Zfd(a,b,c){b=c||b;c='<div class="waffle-assistant-feature-section" tabindex="0" role="region" aria-label="';var d=" "+(Q(a.title)+" Section ");c+=Ys(d);c+='"><div class="waffle-assistant-section-header"><div class="waffle-assistant-section-title">'+O(a.title)+"</div>";c+=O(Kt({Jd:"waffle-assistant-section-more-button",content:Vs("More"),style:4},b));return P(c+'</div><div class="waffle-assistant-section-content"></div><div class="waffle-assistant-section-card-holder"></div></div>')};function $fd(){var a=P;var b='<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content">'+O(zsc({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div aria-live="polite"><div class="waffle-assistant-empty-list-title">';b=P(b+'Nothing interesting here right now</div><div class="waffle-assistant-empty-list-body">Try selecting different data. Information with numbers works best.</div></div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try an example</a></div></div></div>');
return a('<div class="waffle-assistant-scroll-pane" style="display: none;"><div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-panel-pane">'+b+'<div class="waffle-assistant-panel-content-container"><div class="waffle-assistant-panel-card-holder"></div></div></div></div>')}
function agd(a,b,c){b=c||b;return P('<div class="waffle-assistant-panel-title-bar">'+O(Kt({Jd:"waffle-assistant-panel-back-button",content:Vs(""+O(au({icon:"docs-icon-img-container docs-explore-img docs-explore-back-white",nt:"waffle-assistant-panel-back-button-icon"},b))),style:4},b))+'<div class="waffle-assistant-title-text" role="heading">'+O(a.title)+"</div></div>")};function P_(a){M.call(this,a);this.yc=new SW(!1,"#4285f4");this.Ha(this.yc);this.H=new M(this.va());this.Ha(this.H);this.C=[];this.Rd=this.Vb=!1;this.bd=this.Wc=this.Ua=this.Aa=null;this.rb=new Lt("",a,4);Dm(this.rb,2,!1);this.Ha(this.rb)}w(P_,M);var bgd={defaultHelpArticleId:"6280499"};p=P_.prototype;p.Ea=function(){P_.qa.Ea.call(this);this.mb(N($fd));this.Wc=this.Ka("waffle-assistant-panel-content-container");this.bd=this.Ka("waffle-assistant-empty-list")};
p.Ja=function(){P_.qa.Ja.call(this);var a=this.Ka("waffle-assistant-spinner-container");this.yc.render(a);this.H.Wa(this.Ka("waffle-assistant-panel-card-holder"));this.rb.Wa(this.Ka("waffle-assistant-empty-list-learn-more"));this.getHandler().V(this.rb,"action",this.bUb).V(this.Qa(),"scroll",xYc(this.F$,10,this))};p.setVisible=function(a){var b=this;K(this.Qa(),a);x(this.C,function(a){if(!a.sb()){var c=b.H.$c();a.O=c;b.H.Ha(a,!0);a.uI()}});(this.Vb=a)&&0<this.C.length&&this.C[0].Qa().focus()};
p.Nna=function(a,b){var c=this.va();this.Aa&&this.d2();this.Aa=new M;this.Ha(this.Aa);a=Ks(a,agd,{title:b});this.Ua=new Lt("",this.va());this.Aa.Ha(this.Ua);this.Ua.Wa(c.Ka("waffle-assistant-panel-back-button",a));H_(this.Ua.Qa(),"Back");this.Aa.getHandler().V(this.Ua,"action",this.aUb)};p.d2=function(){this.Aa.dispose();this.Aa=null};function cgd(a,b){a.yc.setActive(b);K(a.Ka("waffle-assistant-panel-pane"),!b)}p.eH=function(a){K(this.bd,a);K(this.Wc,!a)};
function dgd(a,b){hb(a.C,b);a.H.removeChild(b);a.H.Uf(b,0);a.C.push(b)}p.HG=function(a){hb(this.C,a);-1!=Wl(this.H,a)&&this.H.removeChild(a,!0)};p.tU=function(){this.H.Ed(!0);xb(this.C);this.C=[]};p.F$=function(){var a=this.Qa();a=a.scrollTop+wl(a).height;for(var b=0,c=0;c<this.C.length;c++){var d=this.C[c];b<a?(zfd(d,!0),b+=wl(d.Qa()).height):zfd(d,!1)}};function egd(a,b){a.Rd=b;x(a.C,function(a){a.Xs(b)})}p.Md=g("Rd");p.bUb=function(){(Zj(),Ii).Ob(bgd)};p.aUb=function(){this.dispatchEvent("Se")};function Q_(a,b,c,d){M.call(this,d);this.ma=a;this.Sa=b;this.Aa=new Lt("",this.va());this.Ha(this.Aa);this.L=new M(this.va());this.Ha(this.L);this.C=null;this.Ra=[];this.oa=this.Oa=!1;this.R=c}w(Q_,M);p=Q_.prototype;p.hGa=Cc;p.Moa=Dc;p.Ea=function(){Q_.qa.Ea.call(this);this.mb(N(Zfd,{title:this.getTitle()}))};
p.Ja=function(){Q_.qa.Ja.call(this);this.L.Wa(this.Ka("waffle-assistant-section-card-holder"));this.Aa.Wa(this.Ka("waffle-assistant-section-more-button"));this.getHandler().V(this.Aa,"action",this.Yqb);this.C=this.Vva();this.Ba(this.C);K(fgd(this),this.hGa());this.setVisible(!1)};p.setVisible=function(a){if(this.sb()&&this.isVisible()!=a&&(K(this.Qa(),a),a)){K(this.Aa.Qa(),this.jOa());a=new dk;G(a,4,this.p0());var b=new bk;xf(b,58,a);a=Qm(Pm(new Om,10),b).build();this.R.C(2774,a)}};
p.isVisible=function(){return this.sb()&&Dl(this.Qa())};p.jOa=function(){return this.Ra.length>this.ma};p.Vva=function(){return new P_(this.va())};p.nM=function(a){this.oa=a;x(ggd(this),function(b){b.Xs(a)});egd(this.C,a)};p.Md=g("oa");p.rf=ua;
p.lM=function(a){this.Ra=a;for(var b=0;b<a.length;b++){if(this.L.$c()<this.ma){var c=this.tN(a[b]);c.Xs(this.oa);var d=this.L.$c();c.O=d;this.L.Ha(c,!0)}if(this.Moa()&&(this.C.eH(!1),c=this.tN(a[b]),c.Xs(this.oa),d=this.C,d.C.push(c),d.Vb)){cgd(d,!1);var e=d.H.$c();c.O=e;d.H.Ha(c,!0);c.uI()}}};function ggd(a){var b=[];a.L.Xe(function(a){b.push(a)});return b}function fgd(a){return a.Ka("waffle-assistant-section-content")}p.wja=function(){return this.L.DX()};
p.mM=function(){this.Ra=[];xb(this.L.Ed(!0));this.setVisible(!1);this.Moa()&&(this.C.tU(),this.C.eH(!0))};function hgd(a){a.L.Xe(function(a,c){c<this.ma&&a.uI()},a)}p.q0=function(a){var b=0;if(this.Oa)this.C.F$();else if(this.wja()){this.setVisible(!0);b=wl(this.Ka("waffle-assistant-section-header")).height+wl(fgd(this)).height;for(var c=ggd(this),d=0;d<c.length;d++)b<a&&d<this.ma?(this.pDa(c[d]),zfd(c[d],!0),b+=wl(c[d].Qa()).height):zfd(c[d],!1)}else this.setVisible(!1);return a-b};p.pDa=ua;
p.setActive=function(a){(this.Oa=a)||this.C.d2()};p.yb=g("Oa");p.kQa=function(a){this.C&&cgd(this.C,a)};function igd(a,b){a.C.Nna(b,a.getTitle())}p.Yqb=function(){this.setActive(!0);this.dispatchEvent("Ye")};function R_(a,b,c,d,e,f){var h=jh(H(),"fmnac");h||(h=20);Q_.call(this,h,e,d,f);this.Da=a;this.J=b;this.Ga=c;this.D=new Vfd;this.Ba(this.D);this.F=null;this.H=0;this.O=null}w(R_,Q_);p=R_.prototype;p.Ja=function(){R_.qa.Ja.call(this);this.D.init();this.getHandler().V(this.D,"drag",this.ETb).V(this.D,"dragend",this.DTb)};p.getTitle=n("Analysis");p.lU=function(a){return 0==a};
p.tN=function(a){return"WordCloud"==V(a,8).getChartType()?new Xfd(a,this.va()):new N_(a,this.Da,this.J,this.Ga,this.R,this.D,this.O,this.va())};p.nM=function(a){R_.qa.nM.call(this,a);a&&emc(this.D)};p.pDa=function(a){this.getHandler().Rc(a,"content-rendered",this.CTb);this.H++};p.lM=function(a,b){this.O=b||null;R_.qa.lM.call(this,a,b)};p.CTb=function(){0==--this.H&&this.dispatchEvent("Ue")};p.ETb=function(){this.F=pl(this.D.Pc.target)};
p.DTb=function(a){var b=this.F,c=nI(this.J).D;if($k(aO(c,"page",!1,!1)).contains(b)){var d=ZN(c,b.x,b.y,"page");c=HN(c,d,"page");b=new vd(b.x-c.left,b.y-c.top);a.C.getData().UDa(d,b)}this.F=null};p.p0=n(2);var jgd={zYa:0,tba:1,oaa:2,fVa:3,WYa:4,HXa:5,ssa:6,aT:7,rXa:8,sXa:9},kgd={UNKNOWN_ERROR:0,wuc:1,nlc:2,L8b:3},lgd={fuc:0,a9b:1,uaa:2,Tj:3,Rtc:4,u0b:5,p$b:6},mgd={auc:0,jA:1,rlc:2,Ykc:3,$nc:4},ngd={Ttc:0,olc:1,Vx:2,tic:3},ogd={Gtc:0,ftc:1,ecc:2,isc:3,hsc:4,O3b:5,gjc:6},pgd={orc:0,kA:1,rSa:2,Psc:3,tqc:4,dWa:5,uuc:6,lsa:7,Sqa:8,pra:9,xM:10},qgd={UNKNOWN:0,f0b:1,e0b:2,d0b:3,G1b:4,m3b:5,I3b:6,f7b:7,D9b:8,Mjc:9,loc:10,yoc:11,Frc:12,Grc:13,vsc:14,Dnc:15};var rgd={DEFAULT:0,RIGHT:1,LEFT:2,rD:3,mD:4},sgd={$sa:0,Yic:1};function tgd(){T.call(this)}w(tgd,T);var ugd=null;function S_(){T.call(this)}w(S_,T);var vgd=null;S_.prototype.getTitle=function(){return V(this,1)};function T_(){T.call(this)}w(T_,T);var wgd=null;T_.prototype.getPosition=function(){return V(this,1)};T_.prototype.setPosition=function(a){X(this,1,a)};function U_(){T.call(this)}w(U_,T);var xgd=null;function V_(){T.call(this)}w(V_,T);var ygd=null;
V_.prototype.getTitle=function(){return V(this,3)};tgd.prototype.Ca=function(){var a=ugd;a||(ugd=a=Hx(tgd,{0:{name:"ChartScale",Za:"virtualanalyst.sheets.ChartScale"},1:{name:"custom_scale",xa:14,defaultValue:0,type:sgd},2:{name:"factor",xa:1,type:Number}}));return a};tgd.Ca=tgd.prototype.Ca;S_.prototype.Ca=function(){var a=vgd;a||(vgd=a=Hx(S_,{0:{name:"ChartTitle",Za:"virtualanalyst.sheets.ChartTitle"},1:{name:"title",xa:9,type:String}}));return a};S_.Ca=S_.prototype.Ca;
T_.prototype.Ca=function(){var a=wgd;a||(wgd=a=Hx(T_,{0:{name:"ChartLegend",Za:"virtualanalyst.sheets.ChartLegend"},1:{name:"position",xa:14,defaultValue:0,type:rgd}}));return a};T_.Ca=T_.prototype.Ca;U_.prototype.Ca=function(){var a=xgd;a||(xgd=a=Hx(U_,{0:{name:"ChartAxis",Za:"virtualanalyst.sheets.ChartAxis"},1:{name:"scale",xa:11,type:tgd}}));return a};U_.Ca=U_.prototype.Ca;
V_.prototype.Ca=function(){var a=ygd;a||(ygd=a=Hx(V_,{0:{name:"ChartOptions",Za:"virtualanalyst.sheets.ChartOptions"},1:{name:"h_axis",xa:11,type:U_},2:{name:"v_axis",xa:11,type:U_},3:{name:"title",xa:11,type:S_},4:{name:"subtitle",xa:11,type:S_},5:{name:"legend",xa:11,type:T_},6:{name:"chart_conversation",xa:8,type:Boolean}}));return a};V_.Ca=V_.prototype.Ca;function W_(){T.call(this)}w(W_,T);var zgd=null;W_.prototype.zg=function(){return V(this,1)};function X_(){T.call(this)}w(X_,T);var Agd=null;X_.prototype.getText=function(){return V(this,1)};X_.prototype.Cm=function(){return Bx(this,1)};function Y_(){T.call(this)}w(Y_,T);var Bgd=null;Y_.prototype.getStatus=function(){return V(this,1)};Y_.prototype.Lj=function(){return V(this,2)};Y_.prototype.getError=function(){return V(this,9)};function Z_(){T.call(this)}w(Z_,T);var Cgd=null;
function Dgd(){T.call(this)}w(Dgd,T);var Egd=null;function $_(){T.call(this)}w($_,T);var Fgd=null;$_.prototype.Ot=function(){return Bx(this,1)};$_.prototype.Lj=function(){return V(this,2)};$_.prototype.getType=function(){return V(this,3)};$_.prototype.setType=function(a){X(this,3,a)};function Ggd(){T.call(this)}w(Ggd,T);var Hgd=null;function Igd(){T.call(this)}w(Igd,T);var Jgd=null;
W_.prototype.Ca=function(){var a=zgd;a||(zgd=a=Hx(W_,{0:{name:"Error",Za:"ritz.assistant.Error"},1:{name:"message",xa:9,type:String},2:{name:"code",xa:14,defaultValue:0,type:kgd},3:{name:"unsupported_op_reason",xa:14,defaultValue:0,type:lgd}}));return a};W_.Ca=W_.prototype.Ca;
X_.prototype.Ca=function(){var a=Agd;a||(Agd=a=Hx(X_,{0:{name:"AnswerQueryPhrase",Za:"ritz.assistant.AnswerQueryPhrase"},1:{name:"text",xa:9,type:String},2:{name:"start_byte",xa:5,type:Number},3:{name:"num_bytes",xa:5,type:Number}}));return a};X_.Ca=X_.prototype.Ca;
Y_.prototype.Ca=function(){var a=Bgd;a||(Bgd=a=Hx(Y_,{0:{name:"AnswerResponse",Za:"ritz.assistant.AnswerResponse"},1:{name:"status",xa:5,type:Number},10:{name:"parse_status",xa:14,defaultValue:0,type:mgd},11:{name:"answer_status",xa:14,defaultValue:0,type:ngd},2:{name:"formula",xa:9,type:String},3:{name:"debug_parse_response",xa:9,type:String},4:{name:"interpretation",xa:9,type:String},5:{name:"debug_interpretation_response",xa:9,type:String},6:{name:"unused_phrase",Wb:!0,xa:11,type:X_},7:{name:"used_entity_phrase",
Wb:!0,xa:11,type:X_},8:{name:"unused_entity_phrase",Wb:!0,xa:11,type:X_},9:{name:"error",xa:11,type:W_},12:{name:"alternate_suggestion",Wb:!0,xa:11,type:$_},14:{name:"deprecated_formula_builder_used",xa:9,type:String},15:{name:"answer_visualization_type",Wb:!0,xa:14,defaultValue:0,type:pgd},16:{name:"formula_builder_used",xa:14,defaultValue:0,type:qgd},17:{name:"charting_info",xa:11,type:Dgd},18:{name:"answer_field_info",Wb:!0,xa:11,type:Z_},19:{name:"charting_formula",xa:9,type:String},21:{name:"parse_info",
Wb:!0,xa:11,type:Ggd},22:{name:"answer_field_info_for_ranges",Wb:!0,xa:11,type:Z_},23:{name:"va_query",xa:9,type:String},24:{name:"pivot_table_def",xa:11,type:zC}}));return a};Y_.Ca=Y_.prototype.Ca;Z_.prototype.Ca=function(){var a=Cgd;a||(Cgd=a=Hx(Z_,{0:{name:"AnswerFieldInfo",Za:"ritz.assistant.AnswerFieldInfo"},1:{name:"cell_data_type",xa:14,defaultValue:0,type:fhb},2:{name:"range_ref",xa:9,type:String}}));return a};Z_.Ca=Z_.prototype.Ca;
Dgd.prototype.Ca=function(){var a=Egd;a||(Egd=a=Hx(Dgd,{0:{name:"ChartingInfo",Za:"ritz.assistant.ChartingInfo"},1:{name:"suggested_type",Wb:!0,xa:14,defaultValue:0,type:pgd},2:{name:"recommended",xa:8,type:Boolean},3:{name:"user_requested_type",Wb:!0,xa:14,defaultValue:0,type:pgd},4:{name:"show_only_chart",xa:8,type:Boolean},5:{name:"chart_options",xa:11,type:V_}}));return a};Dgd.Ca=Dgd.prototype.Ca;
$_.prototype.Ca=function(){var a=Fgd;a||(Fgd=a=Hx($_,{0:{name:"QuerySuggestion",Za:"ritz.assistant.QuerySuggestion"},1:{name:"query",xa:9,type:String},2:{name:"formula",xa:9,type:String},3:{name:"type",xa:14,defaultValue:0,type:ogd},4:{name:"deprecated_formula_builder_used",xa:9,type:String},5:{name:"formula_builder_used",xa:14,defaultValue:0,type:qgd}}));return a};$_.Ca=$_.prototype.Ca;
Ggd.prototype.Ca=function(){var a=Hgd;a||(Hgd=a=Hx(Ggd,{0:{name:"ParseInfo",Za:"ritz.assistant.ParseInfo"},1:{name:"intent_info",Wb:!0,xa:11,type:Igd}}));return a};Ggd.Ca=Ggd.prototype.Ca;Igd.prototype.Ca=function(){var a=Jgd;a||(Jgd=a=Hx(Igd,{0:{name:"IntentInfo",Za:"ritz.assistant.IntentInfo"},1:{name:"intent_type",xa:14,defaultValue:0,type:jgd}}));return a};Igd.Ca=Igd.prototype.Ca;function Kgd(){this.D=this.O="";this.J=!1;this.F=0;this.L=!1;this.H=0;this.C=""}Kgd.prototype.getTitle=g("O");var Lgd="help;how can;how do i;how do you;how do u;how to;what can;what does;what is this;how does this".split(";"),Mgd=[{Ls:["Thank you","Thankyou","Thanks"],rq:"No problem"},{Ls:["you are amazing","This is great","omg"],rq:"Happy to help"},{Ls:["I love you"],rq:"Must be in the air"},{Ls:["How do you know","How are you so smart"],rq:"It's all in the data"},{Ls:["Are you sure"],rq:"Send feedback if this doesn't seem correct to help improve accuracy"},{Ls:["How are you"],rq:"Pretty good, thanks"},
{Ls:["Hi","Hello","Hey"],rq:"Hi, there. Try asking a question about your data."},{Ls:["You are stupid","This is dumb","You are wrong"],rq:"Help improve this experience by sending feedback"},{Ls:["How smart are you"],rq:"Pretty smart"}];function Ngd(a){for(var b=0;b<Mgd.length;++b)if(-1!=ab(Mgd[b].Ls,function(b){return Bb(a,b)}))return b;return-1};function Ogd(a,b,c,d){var e=new ted;G(e,2,c);x(b,function(a){uf(e,1,a)});G(e,3,d);d=new y_;G(d,1,a);G(d,3,b[c]);xf(d,11,e);return d}function Pgd(a,b,c,d){var e=new ped;G(e,2,c);x(b,function(a){uf(e,1,a)});G(e,3,d);d=new y_;G(d,1,a);G(d,2,b[c]);xf(d,10,e);return d}function Qgd(a){var b=new ned;x(a,function(a){uf(b,1,a.type);a.Iza&&uf(b,2,a.Iza)});return b}function Rgd(a){var b=new red;x(a,function(a){uf(b,1,a.type)});return b}
function Sgd(a,b,c,d){var e=new ved;a&&G(e,1,a);b&&G(e,2,b);for(a=0;a<c.length;a++)uf(e,3,c[a]);G(e,4,d);return e};function a0(a,b){this.D=a;this.C=b}a0.prototype.getChartType=g("D");var Tgd={2:new a0("ColumnChart","Column chart"),3:new a0("LineChart","Time series"),4:new a0("ScatterChart","Scatter chart"),5:new a0("PieChart","Pie chart"),10:new a0("Histogram","Histogram"),7:new a0("LineChart","Line chart")};function b0(a,b,c,d,e,f,h,k){this.D=a;this.OT=b;this.F=(void 0===h?null:h)||b;this.C=d;this.aq=c;this.La=d?Fx(d,6):[];this.Na=d?Fx(d,7):[];this.Ga=d?Fx(d,8):[];this.error=e||1;this.interpretation=d&&Bx(d,4)?V(d,4):null;this.oa=new Kgd;this.O=d?Fx(d,12):[];this.Da=d?Fx(d,21):[];this.Aa=f;this.Oa=null!=k?k:ZL(f.C);this.H=null;this.ma=this.J=!1;this.L=[];this.R=null;Ugd(this)}function Vgd(a){return 1==a.error&&null!=a.aq}
function Wgd(a){return{qL:Xgd(a),interpretation:a.interpretation,OT:a.OT,aq:a.aq,nY:1<a.OT.length&&1<a.OT[0].length,sj:a.sj(),dRb:a.ma,ez:a.ez(),LCb:a.L}}function Ygd(a){a.ez();return a.C?V(a.C,24):null}b0.prototype.sj=function(){return null!=this.H&&(this.H in Tgd?!0:!1)&&2<this.F.length};b0.prototype.ez=function(){return I(H(),"feapt")&&null!==this.C&&Bx(this.C,24)};
b0.prototype.getChartType=function(){if(!this.sj())return null;var a=this.H;if(a in Tgd)return Tgd[a].getChartType();throw Error("Unknown chart type.");};function Zgd(a){a.sj();return a.F[0][0]}function $gd(a){a.sj();return a.F[0][1]||""}function ahd(a){return Wa(Fx(a.C,22),function(b){if(V(b,2)){var c=a.Aa.C,d=RJ(c,a.Oa);return aK(V(b,2),c,!1,!1,d)}},a)}function bhd(a){return{qL:Xgd(a),error:chd(a)}}
function dhd(a,b,c,d){var e=d.length;if(0==e)return b;1<e&&hb(b,10);var f=V(d[0],1);2<e&&9==f&&hb(b,4);var h=e-1;d=V(d[h],1);if(e=2>=e&&9==d){for(var k=e=!1,l=1;l<a.F.length;l++){var m=ehd(a,a.F[l][h],fhd(d));if(0<m)e=!0;else if(0>m){k=!0;break}}e=e&&!k}e||hb(b,5);2!=f&&3!=f&&12!=f&&hb(b,3);bb(c,10)&&bb(b,10)&&Iaa(b,function(a){return 10!=a});return b}
function Ugd(a){var b=null;a.J=!1;a.H=null;if(a.C&&Bx(a.C,17)){var c=V(a.C,17);a.ma=V(c,4)||!1;var d=Fx(c,3),e=dhd(a,Fx(c,1),d,Fx(a.C,18));0<d.length&&(0==e.length||1>=a.F.length||1>a.F[0].length)?a.L.push("Charts for this question are not supported."):(0<d.length?(b=Va(e,function(a){return bb(d,a)}),c=Va(d,function(a){return!bb(e,a)}),hb(c,6),0<b.length?(a.J=!0,a.H=b[0],b=a.H):bb(d,10)&&bb(e,2)?(a.J=!0,a.H=2,hb(c,10),b=a.H):(b=0<c.length?c[0]:6,a.J=!0,a.H=ghd(a,e)),0<c.length&&a.L.push("Requested chart type is not supported for this question.")):
0<e.length&&1<a.F.length&&1<a.F[0].length&&(a.H=ghd(a,e),a.J=V(c,2)||!1,20<=a.F.length||3<=a.F[0].length)&&(a.J=!0),a.R=Sgd(a.H,b,e,a.J))}}function ghd(a,b){if(!Fx(a.C,18).length)return b[0];a=hhd(a);a=ritz_api.AssistantApi.getAnswersChartsRecommedation(a.toJSON());for(var c=0;c<a.length;c++)if(bb(b,a[c]))return a[c];return b[0]}function ihd(a,b,c){var d={};null!=b?(d.v=ehd(a,b,c),d.f=b):d.v=null;return d}
function hhd(a){for(var b=new lL,c=a.F[0],d=mb(a.F,1),e=Fx(a.C,18),f=[],h=0;h<c.length;h++)null!=e[h]&&Bx(e[h],1)?f.push(fhd(V(e[h],1))):f.push(0==h?"string":"number"),b.Yl({type:f[h],label:c[h]||"",id:"Axis"+h});for(e=0;e<d.length;++e){h=[];for(var k=0;k<c.length;k++)h.push(ihd(a,d[e][k],f[k]));b.$n(h)}return b}
function ehd(a,b,c){switch(c){case "boolean":return"true"==b.toLowerCase()||"1"==b;case "number":return a=a.Aa.L.F,b=(b||"0").replace(new RegExp("[^-0-9"+a+"]","g"),""),b=b.replace(a,"."),ac(b);case "date":case "datetime":return new Date(b);case "timeofday":if(b){a=b.replace(/[^a-zA-Z0-9]/g," ").split(" ");c=[0,0,0,0];if(!(2>a.length)&&Kb(a[0])&&Kb(a[1])&&(Kb(a[a.length-1])||"am"==a[a.length-1].toLowerCase()||"pm"==a[a.length-1].toLowerCase())){for(var d=0;d<b.length&&4>d;d++)Kb(a[d])&&(c[d]=ac(a[d]));
"am"==a[a.length-1].toLowerCase()&&12==c[0]&&(c[0]=0);"pm"==a[a.length-1].toLowerCase()&&12!=c[0]&&(c[0]+=12)}b=c}else b=[0,0,0,0];return b;default:return b||""}}function fhd(a){switch(a){case 1:return"boolean";case 9:return"number";case 2:return"date";case 3:return"datetime";case 12:return"timeofday";default:return"string"}}
function jhd(a){if(!Bx(a.C,9))return"";if(Bx(a.C.getError(),3))switch(V(a.C.getError(),3)){case 1:return"Sorry, questions related to formatting are not supported at this time.";case 2:return"Answers provides formulas based on your data. Charts are currently not supported. Please use the menus to create a chart.";case 3:return"Sorry, this action is not supported at this time.";case 4:return"Sorry, this function is not supported at this time.";case 5:return"Sorry, your question is too generic. Please ask a more specific question.";
default:return"Sorry, this function is not supported at this time."}return a.C.getError().zg()||""}
function chd(a){switch(a.error){case 2:return"Looks like you are offline. Try again when you reconnect.";case 3:return"There was a problem getting your answer at this time. Please try again later.";case 4:return"Sorry, couldn't understand your question.";case 5:return"Answers lets you ask question and learn more about your data.";case 6:return jhd(a)||"Sorry, couldn't understand your question.";case 7:return a=Ngd(a.D),-1!=a?Mgd[a].rq:""}return""}
function Xgd(a){var b=[];if(Vgd(a)){var c=[];x(jb(a.La,a.Ga),function(a){c.push(khd(a,"waffle-assistant-answercard-question-unused-phrase"))});x(a.Na,function(a){c.push(khd(a,"waffle-assistant-answercard-question-used-entity"))});qb(c,function(a,b){return a.aM>b.aM?1:-1});var d=0;x(c,function(c){var e=c.length,h=c.aM;h>d?b.push({text:a.D.substring(d,h),className:null}):(e-=d-h,h=d);0<e&&(d=h+e,b.push({text:a.D.substring(h,d),className:c.Yk}))});d<a.D.length&&b.push({text:a.D.substring(d),className:null})}else b.push({text:a.D,
className:null});return b}function khd(a,b){return{aM:V(a,2),length:V(a,3),Yk:b}};function lhd(a,b,c){return P('<div class="waffle-assistant-answers-card-remove">'+O(au({icon:"docs-icon-img docs-icon-trash"},c||b))+"</div>")}
function mhd(a,b){var c=a.error;a=a.showHelp;b='<div class="waffle-assistant-answercard-error-container"><div class="waffle-assistant-answercard-error-image">'+O(au({icon:"docs-icon-img docs-icon-unsupported-black"},b))+'</div><div class="waffle-assistant-errorcard-content">';a?(b+='<div class="waffle-assistant-errorcard-text">',c=O(c)+' Look in <div class="waffle-assistant-answers-helpcenter-link">Sheets help</div> instead?',b=b+c+"</div>"):b+='<div class="waffle-assistant-errorcard-text">'+O(c)+
"</div>";return P(b+"</div></div>")};function nhd(a,b,c){b=c||b;c=P;var d='<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+ohd({qL:a.mA.qL}),e=a.mA.OT;var f=a.mA.aq;var h=a.mA.interpretation,k=a.mA.nY,l=a.mA.sj,m=a.mA.ez,q=a.mA.dRb;a=a.mA.LCb;null==e||xa(e);xa(a);h=h={interpretation:h};h=h.interpretation;var t='<div class="waffle-assistant-answercard-answer-header" role="heading" aria-label="'+Ys("Answer");t=t+'"><span aria-hidden="true">Answer'+("</span></div>"+(h?'<div class="waffle-assistant-answercard-interpret-content"><div class="waffle-assistant-answercard-interpret">'+
O(h)+"</div></div>":""));var v='<div class="waffle-assistant-answercard-answer-container">'+P(t)+'<div class="waffle-assistant-answercard-answer-content">';if(e){if(!q)if(l&&(v+='<div class="waffle-assistant-answercard-tabs"><div class="waffle-assistant-answercard-formula-tab">FORMULA</div><div class="waffle-assistant-answercard-pivot-tab" id="waffle-assistant-answercard-pivot-tab">PIVOT TABLE</div><div class="waffle-assistant-answercard-chart-tab" id="waffle-assistant-answercard-chart-tab">CHART</div></div>'),
m)v+='<div class="waffle-assistant-answercard-pivot-content"></div>';else{v+='<div class="waffle-assistant-answercard-answer">';if(k){v+='<div class="waffle-assistant-answercard-answer-rowheader">';q=e[0];h=q.length;for(t=0;t<h;t++)v+='<span class="waffle-assistant-answercard-answer-col">'+O(q[t])+"</span>";v+="</div>"}v+='<div class="waffle-assistant-answercard-answer-rows">';q=Us("waffle-assistant-answercard-answer-row"+(k?" waffle-assistant-answercard-answer-list-row":""));h=e.length;for(t=0;t<
h;t++){var y=e[t];if(k&&0==t)y="";else{var B=q;xa(y);B='<div class="'+Q(B)+'">';for(var L=y.length,R=0;R<L;R++){var U=y[R];U?B+='<span class="waffle-assistant-answercard-answer-col">'+O(U)+"</span>":(B+='<span class="'+Q("waffle-assistant-answercard-answer-col waffle-assistant-answercard-answer-empty")+'">',B+="N/A",B+="</span>")}y=P(B+"</div>")}v+=y}v+="</div></div>"}v+=l?'<div class="waffle-assistant-answercard-chart-container"><div class="waffle-assistant-answercard-chart-type-select"></div><div class="waffle-assistant-answercard-chart"></div></div>':
""}if(0<a.length){v+='<div class="waffle-assistant-answercard-info-msgs">';e=a.length;for(k=0;k<e;k++)v+='<div class="waffle-assistant-answercard-info-msg">* '+O(a[k])+"</div>";v+="</div>"}v+='<div class="waffle-assistant-answercard-footer">';m&&(v+='<div class="waffle-assistant-answercard-insert-pivot">INSERT PIVOT TABLE</div>');l&&(v+='<div class="waffle-assistant-answercard-insert-chart">INSERT CHART</div>');m||(v=v+'<div class="waffle-assistant-answercard-formula-holder"><div class="waffle-assistant-answercard-see-formula-link">See formula</div><div class="waffle-assistant-answercard-hide-formula-link">Hide formula</div><div class="waffle-assistant-answercard-formula"><div class="waffle-assistant-answercard-formula-help">Click to copy or drag to insert'+
('</div><div class="waffle-assistant-answercard-formula-display"><div class="waffle-assistant-answercard-formula-icon">'+O(au({icon:"docs-icon-img docs-icon-insert-formula"},b))+'</div><div class="waffle-assistant-answercard-formula-text-container"><div class="waffle-assistant-answercard-formula-text" tabindex="0">'+O(f)+"</div></div></div></div></div>"));f=P(v+"</div></div></div>");return c(d+f+"</div></div>")}
function ohd(a){xa(a.qL);a=a.qL;var b='<div class="waffle-assistant-answercard-question-container"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+Ys("Question");b+='"><span aria-hidden="true">Question</span></div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">';for(var c=a.length,d=0;d<c;d++){var e=a[d];b+=e.className?'<span class="'+Q(e.className)+'">'+O(e.text)+"</span>":O(e.text)}return P(b+"</div></div></div>")}
function phd(a,b,c){b=c||b;a=a.ez;return P(O(lhd(null,b))+(a?'<div class="waffle-assistant-button-separator"></div>'+O(Kt({Jd:"waffle-assistant-zoom-button",content:Vs(""+O(au({icon:"docs-icon-img docs-icon-zoom-in"},b))),style:4},b)):""))};function qhd(a){this.C=a}function rhd(a,b){var c=new x_;G(c,3,b);G(c,8,!0);b=new XV;xf(b,4,c);c=new bk;xf(c,46,b);c=Qm(Pm(new Om,10),c).build();a.C.C(2753,c)};function c0(a,b,c,d){E.call(this);this.oa=a;this.O=b;this.R=c;this.Ga=d;this.Ma=new Vk(this);this.Ba(this.Ma);this.F=this.C=this.H=null;this.D=!1}r(c0,E);c0.prototype.init=function(a){K6c(a,this.oa);a.Aa=10;a.Ra=!0;a.R=!1;a.uNa("waffle-assistant-visible");a.L=Lb("waffle-assistant-dragged-object").split(" ");a.init();this.Ma.V(a,D6c,this.Aa).V(a,G6c,this.Oa).V(a,H6c,this.Na)};
c0.prototype.Oa=function(a){var b=a.event instanceof jt?a.event.Hi:a.event;this.D?(a.H.Mw(b,!0),a.preventDefault()):(hl(a.F,a.event.clientX,a.event.clientY),a=il(a.F),b=nI(this.O).D,$k(aO(b,"page",!1,!1)).contains(a)?(a=ZN(b,a.x,a.y,"page"),(b=iJ(HK(this.R),a.y,a.x))?a=new vd(b.qc(),b.rc()):b=$A(a),this.H=a,this.C&&this.C.getRect().equals(b)||(a=nI(this.O),A(this.C),this.C=dYc(a,b,"waffle-assistant-insertion-rect"),this.Ba(this.C),tQ(a.R,"default",this.C),A(this.F),this.F=UP(a,b,"waffle-assistant-insertion-border",
2,0),this.Ba(this.F),Y9b(this.F,"#000"),this.F.setVisible(!0))):shd(this))};c0.prototype.ma=ba();c0.prototype.Na=function(a){this.H&&(LQ(nI(this.O),!1),this.Da(this.H));a.H.Mw(null,!0);a.preventDefault();this.ma();shd(this)};function shd(a){a.H=null;A(a.C);a.C=null;A(a.F);a.F=null};function thd(a,b,c,d){c0.call(this,a,b,c,d);this.La=new QY;this.Ba(this.La);this.L="";this.J=[];this.init(this.La)}r(thd,c0);thd.prototype.Aa=function(a){a=Ta(this.oa.childNodes,a.C);this.L=this.J[a]};thd.prototype.Da=function(a){var b=HK(this.R);this.Ga.C(new $Q(b,a,this.L));this.dispatchEvent(new D("formula_inserted"))};thd.prototype.ma=function(){this.L=""};function uhd(a){QY.apply(this,arguments)}r(uhd,QY);uhd.prototype.rha=function(a){var b=QY.prototype.rha.call(this,a);"CANVAS"==a.tagName&&b.getContext("2d").drawImage(a,0,0);return b};function vhd(a,b,c,d){c0.call(this,a,b,c,d);this.L=new uhd;this.Ba(this.L);this.J=null;this.init(this.L)}r(vhd,c0);vhd.prototype.Aa=ba();vhd.prototype.Da=function(a){var b=HK(this.R);a=OI(this.J,b.kc(),a,b.kc());this.Ga.C(new aR(a,b));this.dispatchEvent(new D("pivot_inserted"))};function d0(a,b,c,d,e,f,h,k,l,m,q,t,v){K_.call(this,new wK,v);this.F=a;this.Rd=ahd(a);this.pb=a.sj();this.Aa=a.ez();this.$f=q;this.L=this.C=this.fb=null;this.Ua=a.sj()&&a.J;this.Wf=a.ma;this.rb=!1;this.Ne=b;this.le=c;this.bd=d;this.Xi=l;this.Th=h;this.ma=e;this.Eg=f;this.Dg=k;this.tf=m;this.$e=Pm(new Om,10).build();this.Xd=new Wr("",new E_,this.va());this.Ha(this.Xd);this.Qg=t;this.Sa=new Wr("",new E_,this.va());this.Ha(this.Sa);this.gb=new Wr("",new E_,this.va());this.Ha(this.gb);this.$a=this.Da=
null;this.R=new Wr("",new MY,this.va());this.Ha(this.R);this.D=a.oa;this.Oa=new Wr("",new MY,this.va());this.Ha(this.Oa);this.Ya=new Wr("",new E_,this.va());this.Ha(this.Ya);this.oa=new dX;this.Ha(this.oa);this.Na=new AQ("");this.Ha(this.Na);this.Mf=new Fz;this.J=null;this.Vb=2;this.Kc=hhd(this.F);this.ud=new NY(b,"waffle-assistant-answers-range-styled-border","waffle-assistant-answers-range-styled-rect");this.Ba(this.ud);this.Fd=!1}w(d0,K_);p=d0.prototype;p.fga=g("Dg");
p.Ea=function(){d0.qa.Ea.call(this);M_(this).appendChild(N(phd,{ez:this.Aa}))};
p.Ja=function(){d0.qa.Ja.call(this);var a=this.Ka("waffle-assistant-answers-card-remove");this.Xd.Wa(a);H_(a,"Remove card",0);this.getHandler().Rc(this.Xd,"action",this.MTb);if(this.F.ez()){a=this.Rd[0]?this.Rd[0].C:HK(this.le).kc();var b=Ygd(this.F),c=u6c(this.Qg,b);this.fb=new x6c(c,b,this.Xi.L.C,this.$f,a,this.bd)}else this.getHandler().V(this.R,"action",this.Qwb).V(this.Oa,"action",this.Unb).Rc(this.R,"action",this.ZHa).Rc(this.Oa,"action",this.yEb)};
function whd(a){function b(b,d,e,f){var c=new bX("");c.Wa(a.Ka(b));a.oa.Ha(c);a.getHandler().Rc(c,"action",u(a.vEb,a,d));f||c.setVisible(!1);e&&f&&a.oa.Qz(c)}a.oa.Wa(a.Ka("waffle-assistant-answercard-tabs"));a.getHandler().V(a.oa,"select",a.vzb);b("waffle-assistant-answercard-formula-tab",0,!a.Ua,!a.Aa);b("waffle-assistant-answercard-pivot-tab",1,!a.Ua,a.Aa);b("waffle-assistant-answercard-chart-tab",2,a.Ua,!0)}
function xhd(a){var b=V(a.F.C,17);b=Fx(b,1);for(var c=0;c<b.length;c++)a.Na.kd(yhd(b[c]));a.Na.Wa(a.Ka("waffle-assistant-answercard-chart-type-select"));xs(a.Na,yhd(a.F.H));b=a.Ka("waffle-assistant-answercard-insert-chart");a.Ya.Wa(b);zhd(a);a.getHandler().V(a.Ya,"action",a.KTb).V(a.Na.Zb(),"action",a.Phb)}
p.Mx=function(a){L_(this).appendChild(N(nhd,{mA:Wgd(this.F)}));if(this.F.ez()){this.pb&&(whd(this),xhd(this));var b=this.Ka("waffle-assistant-answercard-insert-pivot");this.Sa.Wa(b);b=this.Ka("waffle-assistant-zoom-button");this.gb.Wa(b);H_(b,"Preview Pivot Table");this.getHandler().V(this.Sa,"action",this.LTb).V(this.gb,"action",this.jQa);Ahd(this);var c=this.va();this.C=c.Ea("CANVAS","waffle-pivottable-pivot-canvas");c.Rj(this.C,!0);Ik(this.C,"Pivot table canvas");b=this.Ka("waffle-assistant-answercard-pivot-content");
c.appendChild(b,this.C);c=Ygd(this.F);this.$a=new vhd(b,this.Ne,this.le,this.bd);this.$a.J=c;b=this.Md();this.$a.D=b;this.getHandler().og(this.C,Me,this.jQa).V(this.C,"mousedown",this.mqa).Rc(this.$a,"pivot_inserted",this.NTb);z6c(this.fb,this.C);this.Vb=this.Ua?1:3}else this.R.Wa(this.Ka("waffle-assistant-answercard-see-formula-link")),this.Oa.Wa(this.Ka("waffle-assistant-answercard-hide-formula-link")),this.Da=new thd(this.Ka("waffle-assistant-answercard-formula-text-container"),this.Ne,this.le,
this.bd),b=this.Md(),this.Da.D=b,this.Da.J=[this.F.aq],this.Ba(this.Da),b=this.Ka("waffle-assistant-answercard-formula-text"),Ik(b,"Formula: "+(this.F.aq+". Click/Press ENTER to copy or drag to insert on to sheet.")),this.getHandler().Rc(this.Da,"formula_inserted",this.xEb).og(this.Ka("waffle-assistant-answercard-formula-text"),Me,this.$mb),Bhd(this,this.tf),Chd(this),this.tf&&(Dhd(this,!0),this.getHandler().Hc(this.R,"action",this.ZHa)),this.pb&&(this.Wf?(Ehd(this,this.F.getChartType()),this.rb=
!0):whd(this),xhd(this),this.Vb=1);a()};function yhd(a){if(a in Tgd)return new Kn(Tgd[a].C,a);throw Error("Unknown chart type.");}p.Phb=function(a){a=a.target.Ta();if(a in Tgd)Ehd(this,Tgd[a].getChartType());else throw Error("Unknown chart type model.");};
function Fhd(a,b){a.D.D&&b.setSubtitle(a.D.D);var c=b.getAxis(ritz.charts.model.AxisNames.X);c&&(c.setLogScale(a.D.J),a.D.F&&c.setScaleFactor(a.D.F));if(c=b.getAxis(ritz.charts.model.AxisNames.Y))c.setLogScale(a.D.L),a.D.H&&c.setScaleFactor(a.D.H);if(a.D.C){c=0;switch(a.D.C.toLowerCase()){case "none":c=0;break;case "left":c=3;break;case "right":c=4;break;case "top":c=1;break;case "bottom":c=2;break;case "in":c=5;break;case "labeled":c=6}b.setLegendPositionType(c)}}
function Ghd(a,b){a.D.D&&b.setOption("subtitle",a.D.D);b.setOption("hAxis.logScale",a.D.J);b.setOption("vAxis.logScale",a.D.L);a.D.C&&b.setOption("legend.position",a.D.C);a.D.F&&b.setOption("hAxis.formatOptions.scaleFactor",a.D.F);a.D.H&&b.setOption("vAxis.formatOptions.scaleFactor",a.D.H)}
function Ehd(a,b){if(ritz_api.ChartsApi){a.J=new oK;var c=new BD;X(a.J,28,c);var d=new xD;X(c,10,d);X(a.J,1,b);d.setType(ritz.charts.model.ChartTypes.tagNumberFromGviz(b));var e=a.F.interpretation||"";X(a.J,2,e);var f=new UC;X(d,5,f);var h=new TC;X(f,1,h);z_(h,e);e=new oD;X(d,7,e);d=new cD;X(e,1,d);f=new bD;X(d,1,f);d=new TC;X(f,1,d);f=new cD;X(e,2,f);e=new bD;X(f,1,e);f=new TC;X(e,1,f);"Histogram"===b?(Zdd(a.J,Zgd(a.F)),z_(d,Zgd(a.F)),$dd(a.J,"Count"),z_(f,"Count")):"LineChart"===b||"ColumnChart"===
b?(e=0,"number"!=a.Kc.xd(0)&&(Zdd(a.J,a.Kc.Nf(0)),z_(d,a.Kc.Nf(0)),e=1),1==a.Kc.getNumberOfColumns()-e?($dd(a.J,a.Kc.Nf(e)),z_(f,a.Kc.Nf(e))):($dd(a.J,"Values"),z_(f,"Values"))):(Zdd(a.J,Zgd(a.F)),z_(d,Zgd(a.F)),$dd(a.J,$gd(a.F)),z_(f,$gd(a.F)));d=new MD;c.Mi(d);rXc(d,a.Kc.toJSON());X(d,2,"0.6");d=a.Ka("waffle-assistant-answercard-chart");I(H(),"fecpmr")?(f=Hhd(a,c),kfd(f),Fhd(a,f),f.setTitle(a.D.getTitle())):(e=Cfd(a.J),e.Mi(a.Kc),e=Dfd(e),AX(e,e.ge()),Ghd(a,e),e.setOption("title",a.D.getTitle()),
h=(f=e.ge())?f.toJSON():null,f=new ritz.charts.model.GvizChart,f.updateChartWrapperJsonString(e.toJSON()),h&&f.updateDataTableJsonString(h));V4c(f,d,a.$f.C,a.ma,void 0,void 0,c);a.rb=!0}else ritz_api.RitzEntryPoint.loadChartsApi(function(){Ehd(a,b)})}function Hhd(a,b){var c=new ritz.charts.model.ChartImpl;c.setChartModel(a.Mf.serialize(b.xw()));a=ritz_api.ChartsApi.createChartDataSource(a.Mf.serialize(b));c.setChartDataSource(a);c.setDomainDataBacked(1<a.getColumnCount());return c}
p.LTb=function(){y6c(this.fb);this.dispatchEvent("close-sidebar");this.ma.C(35619,Pm(new Om,67).build())};p.jQa=function(){var a=Pm(new Om,67).build();this.ma.C(35620,a);this.getHandler().Hc(this.L,"ce",this.mqa).Hc(this.L,"de",this.iQa);A(this.L);this.L=new B6c(this.fb,this.F.interpretation||"",this.ma,a,35621,this.va());this.getHandler().V(this.L,"ce",this.mqa).V(this.L,"de",this.iQa);this.L.render();this.Ba(this.L);ied(this.L,this.Md())};p.mqa=function(){this.C.focus()};p.iQa=function(){this.dispatchEvent("close-sidebar")};
p.KTb=function(){if(this.J)if(I(H(),"fecpmr")){var a=V(this.J,28),b=Hhd(this,a);Fhd(this,b);this.D.getTitle()&&b.setTitle(this.D.getTitle());this.dispatchEvent(new cfd(b,a,this.O,2874,void 0,void 0,Ihd(this)))}else a=Cfd(this.J),a.Mi(this.Kc),Ghd(this,a),this.D.getTitle()&&a.setOption("title",this.D.getTitle()),AX(a,a.ge()),this.dispatchEvent(new efd(a,this.O,this.Kc,2874,void 0,void 0,Ihd(this)))};p.Jx=function(){Ik(this.Qa(),"Answer Card for question: "+this.F.D)};p.$z=Dc;p.Gy=n("assistantAnswersFeedback");
p.gB=n(2628);p.fB=n(2627);p.c4=n("Was this answer correct?");p.eha=n("Correct");p.dha=n("Incorrect");p.kM=g("F");p.Xs=function(a){d0.qa.Xs.call(this,a);this.Da&&(this.Da.D=a);this.L&&ied(this.L,a);Chd(this);zhd(this);Ahd(this)};p.mK=function(){d0.qa.mK.call(this);this.Fd||(hed(this.ud,this.Rd),this.Fd=!0)};p.DF=function(){d0.qa.DF.call(this);PY(this.ud);this.Fd=!1};
p.vzb=function(){var a=O0c(this.oa),b=1==a;if(this.Aa){this.gb.setVisible(b);var c=this.va().Ka("waffle-assistant-button-separator",M_(this));K(c,b)}b=2==a;K(this.Ka("waffle-assistant-answercard-chart-container"),b);this.Aa?K(this.Ka("waffle-assistant-answercard-pivot-content"),!b):(K(this.Ka("waffle-assistant-answercard-answer"),!b),K(this.Ka("waffle-assistant-answercard-formula-holder"),!b));zhd(this);!this.rb&&b&&Ehd(this,this.F.getChartType());switch(a){case 1:Ahd(this);break;case 2:Ahd(this)}};
function Chd(a){var b=a.ib("waffle-assistant-answercard-formula-help");b&&K(b,!a.Md())}function zhd(a){var b=(a.Wf||2==O0c(a.oa))&&!a.Md();a.Ya.setVisible(b)}function Ahd(a){var b=a.Aa&&!a.Md()&&(!a.pb||1==O0c(a.oa));a.Sa.setVisible(b)}function Bhd(a,b){a.R.setVisible(!b);a.Oa.setVisible(b);K(a.Ka("waffle-assistant-answercard-formula"),b);b?a.Ka("waffle-assistant-answercard-formula-text").focus():(a.R.Qa().focus(),a.R.Jp(!0))}p.MTb=function(){rhd(this.Eg,!0);this.dispatchEvent(new D("rc"))};
p.Qwb=function(){Bhd(this,!0)};p.Unb=function(){Bhd(this,!1)};p.ZHa=function(){Dhd(this,!0)};p.yEb=function(){Dhd(this,!1)};function Dhd(a,b){var c=new x_;G(c,9,b);b=new XV;xf(b,4,c);c=new bk;xf(c,46,b);c=Qm(Pm(new Om,10),c).build();a.ma.C(2849,c)}p.vEb=function(a){var b=this.F.R,c=new wed;xf(c,1,b);switch(a){case 0:G(c,2,2);break;case 1:G(c,2,3);break;case 2:G(c,2,1);break;default:G(c,2,0)}a=new x_;xf(a,10,c);c=new XV;xf(c,4,a);a=new bk;xf(a,46,c);c=Qm(Pm(new Om,10),a).build();this.ma.C(2850,c)};
function Ihd(a){var b=a.F.H;a=new xed;G(a,1,b);b=new x_;xf(b,11,a);a=new XV;xf(a,4,b);b=new bk;xf(b,46,a);return b}p.xEb=function(){this.ma.C(2709,this.$e)};p.NTb=ba();p.$mb=function(){var a=this.va().wb(),b=a.createElement("textarea");b.textContent=this.F.aq;b.style.position="fixed";a.body.appendChild(b);b.select();var c=!1;try{c=a.execCommand("copy")}catch(d){}finally{a.body.removeChild(b)}c&&(Jhd(this.Th,"Formula copied to clipboard",this.va()),this.ma.C(35534,this.$e))};function Khd(a,b,c){b=c||b;return P('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+O(ohd({qL:a.Lya.qL}))+O(mhd({error:a.Lya.error,showHelp:a.showHelp},b))+"</div></div>")}function Lhd(){return P('<div class="waffle-assistant-answercard-feedback-container"><div class="waffle-assistant-answercard-feedback-link">Send feedback</div></div>')};function e0(a,b,c,d,e){K_.call(this,new wK,e);this.F=a;this.R=b;this.L=d;this.ma=c;this.J=new Wr("",new E_,this.va());this.Ha(this.J);this.C=new Wr("",new MY,this.va());this.Ha(this.C);this.D=new Wr("",new MY,this.va());this.Ha(this.D)}w(e0,K_);p=e0.prototype;p.Jx=function(){Ik(this.Qa(),"Error Card for question: "+this.F.D)};p.Gy=n("assistantAnswersFeedback");p.$z=Dc;p.f6=Cc;p.Xs=function(a){e0.qa.Xs.call(this,a)};p.Ea=function(){e0.qa.Ea.call(this);M_(this).appendChild(N(lhd))};
p.Ja=function(){e0.qa.Ja.call(this);var a=this.Ka("waffle-assistant-answers-card-remove");this.J.Wa(a);this.D.setVisible(this.L);H_(a,"Remove card",0);this.getHandler().Rc(this.J,"action",this.TTb).Rc(this.C,"action",this.cxb).V(this.D,"action",this.STb)};
p.Mx=function(a){L_(this).appendChild(N(Khd,{Lya:bhd(this.F),showHelp:this.L}));if(dE){var b=N(Lhd);this.va().appendChild(this.Qa(),b);this.C.Wa(this.Ka("waffle-assistant-answercard-feedback-link"))}this.L&&this.D.Wa(this.Ka("waffle-assistant-answers-helpcenter-link"));a()};p.fga=g("R");p.kM=g("F");p.cxb=function(){this.C.setVisible(!1);K(this.Ka("waffle-assistant-answercard-feedback-container"),!1);this.dispatchEvent(new D("trigger_feedback"))};p.TTb=function(){rhd(this.ma,!1);this.dispatchEvent(new D("rc"))};
p.STb=function(){(Zj(),Ii).Ob()};function Mhd(a){K_.call(this,new wK,a);this.C=this.va().createElement("div");ge(this.C,"Previous")}w(Mhd,K_);p=Mhd.prototype;p.Jx=function(){Ik(this.Qa(),"Previous questions below")};p.Ea=function(){Mhd.qa.Ea.call(this);Mk(this.Qa(),"waffle-assistant-card");J(this.Qa(),"waffle-assistant-answers-previousheadercard")};p.Mx=function(a){0<this.va().yh(L_(this)).length||L_(this).appendChild(this.C);a()};p.f6=Cc;p.Gy=n("assistantAnswersFeedback");function Nhd(a,b,c){b=c||b;c=""+(a.g3?O(mhd({error:a.g3,showHelp:a.showHelp},b)):"")+(a.title?'<div class="waffle-assistant-suggestionscard-header">'+O(a.title)+"</div>":"");var d=Us("Suggested question");c+='<div class="waffle-assistant-suggested-questions">';a=a.Ss;for(var e=a.length,f=0;f<e;f++){var h=a[f];c+='<div class="waffle-assistant-answercard-question-container" tabindex="0"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+Q(d)+'">'+O(au({icon:"docs-icon-img docs-icon-help"},
b))+'</div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">'+O(h)+"</div></div></div>"}return P(c+"</div>")};function f0(a,b,c,d,e,f){K_.call(this,a,f);this.C=e||null;this.R=b;this.D=d;this.ma=c;this.L=this.C?5==this.C.error:!1;this.F=new Wr("",new MY,this.va());this.Ha(this.F);this.J=new Wr("",new E_,this.va());this.Ha(this.J)}w(f0,K_);p=f0.prototype;p.Ea=function(){f0.qa.Ea.call(this);this.$z()&&M_(this).appendChild(N(lhd))};
p.Ja=function(){f0.qa.Ja.call(this);J(this.Qa(),"waffle-assistant-answers-suggestioncard");this.F.setVisible(this.L);this.getHandler().V(this.F,"action",this.UTb);if(this.$z()){var a=this.Ka("waffle-assistant-answers-card-remove");this.J.Wa(a);H_(a,"Remove card",0);this.getHandler().Rc(this.J,"action",this.VTb)}};p.gB=function(){return bb([Ohd,Phd],this.D)?2799:bb([Qhd,Rhd],this.D)?2801:null};p.fB=function(){return bb([Ohd,Phd],this.D)?2798:bb([Qhd,Rhd],this.D)?2800:null};p.c4=n("Were these interesting?");
p.eha=n("Interesting");p.dha=n("Not interesting");p.Gy=n("assistantAnswersFeedback");p.$z=function(){return this.C?!Vgd(this.C):!1};p.Jx=function(){var a=this.D.title;a&&this.C?(a=(chd(this.C)||"")+(" "+(a+(" for question : "+this.C.D))),Ik(this.Qa(),a)):Ik(this.Qa(),"Suggested questions")};
p.Mx=function(a){var b=this;this.ma.then(function(c){if(b.sb()){if(0==c.length)K(b.Qa(),!1);else{var d=b.va(),e=L_(b);if(0==d.yh(e).length){var f=N(Nhd,{title:b.D.title,Ss:Wa(c,function(a){return a.query}),g3:b.C?chd(b.C):"",showHelp:b.L});e.appendChild(f);var h=Wa(c,function(a){return a.type});e=b.$h("waffle-assistant-answercard-question-container");x(e,function(a,e){var f=new Wr("",new E_,d);b.Ha(f);f.Wa(a);b.getHandler().V(f,"action",u(b.fzb,b,c[e],h,e))});b.L&&b.F.Wa(b.Ka("waffle-assistant-answers-helpcenter-link"))}}a()}})};
p.VTb=function(){rhd(this.R,!1);this.dispatchEvent(new D("rc"))};p.fzb=function(a,b,c){this.dispatchEvent(new Ded(this.D.L_,a.aq||null,b,c,this.D.oU,a.query))};p.UTb=function(){(Zj(),Ii).Ob()};var Shd={title:"",oU:0,L_:null},Ohd={title:"",oU:5,L_:1},Phd={title:"Suggested questions",oU:5,L_:1},Rhd={title:"Did you mean?",oU:2,L_:4},Qhd={title:"Related questions",oU:4,L_:4};function Thd(a){var b=[];if(Bx(a,25)&&(a=V(a,25)))for(var c=0;c<Cx(a,1);c++){var d=V(a,1,c);if(Bx(d,2)){var e=V(d,2);e&&b.push(Uhd(e,Vhd(d)))}}return b}function Whd(a){var b=Thd(a);Bx(a,6)&&(a=V(a,6))&&b.push(Uhd(a,0));return b}function Vhd(a){return(a=Bx(a,4)?V(a,4):0)?a:0}function Uhd(a,b){return{name:a,GZa:b}};function Xhd(a,b,c){this.Aa=a;this.Da=b;this.L=[];this.O=[];this.H=[];this.J=[];this.ma=[];this.oa=[];this.C={};this.F={};this.R={};this.D={};Yhd(this,c)}function Zhd(a,b){return a[b]?a[b].values.Dd():[]}
function Yhd(a,b){for(var c=new Qt,d=new Qt,e=0;e<b.length;e++){for(var f=Whd(b[e]),h=[],k=[],l=0;l<f.length;l++){var m=f[l].name.toLowerCase();if(void 0!=a.Aa[m]){var q=a.Aa[m];c.add(q);h.push(q)}void 0!=a.Da[m]&&(m=a.Da[m],d.add(m),k.push(m))}$hd(a,h,k)}a.L=c.Dd();a.O=d.Dd();qb(a.L);qb(a.O);a.H=Wa(kc(a.C),function(a){return a.key});qb(a.H);a.J=Wa(kc(a.F),function(a){return a.key});qb(a.J);a.ma=Wa(kc(a.R),function(a){return a.key});qb(a.ma);a.oa=Wa(kc(a.D),function(a){return a.key});qb(a.oa)}
function $hd(a,b,c){for(var d=0;d<b.length;d++)for(var e=d+1;e<b.length;e++)b[d]!=b[e]&&(aid(a.C,b[d],b[e]),aid(a.C,b[e],b[d]));for(d=0;d<b.length;d++)for(e=0;e<c.length;e++)aid(a.F,b[d],c[e]),aid(a.R,c[e],b[d]);for(b=0;b<c.length;b++)for(d=b+1;d<c.length;d++)c[b]!=c[d]&&(aid(a.D,c[b],c[d]),aid(a.D,c[d],c[b]))}function aid(a,b,c){var d;a[b]?d=a[b].values:d=new Qt;d.add(c);a[b]={key:b,values:d}};function bid(a,b){this.C=a;for(var c={},d=0;d<a.Qi();d++)c[B_(a,d).getName().toLowerCase()]=d;this.O=c;c={};for(d=0;d<Cx(a,1);d++)c[V(a,1,d).getName().toLowerCase()]=d;this.R=c;c={};for(d=0;d<this.C.Qi();d++)c[V(B_(this.C,d),11)]=d;this.oa=c;c={};for(d=0;d<Cx(this.C,1);d++)c[V(V(this.C,1,d),4)]=d;this.Aa=c;c=[];for(d=0;d<a.Qi();d++)cid(B_(a,d).getName())&&c.push(d);this.J=c;c=[];for(d=0;d<Cx(a,1);d++)cid(V(a,1,d).getName())&&c.push(d);this.L=c;c=[];for(d=0;d<Cx(a,1);d++){for(var e=V(a,1,d).getName(),
f=!0,h=0;h<did.length;h++)if(-1!=e.search(new RegExp("(\\b|_)"+did[h]+"(\\b|_)","i"))){f=!1;break}f&&c.push(d)}this.Ga=c;this.Na=eid(a,0);this.ma=eid(a,1);c=[];for(d=0;d<a.Qi();d++).8<=V(B_(a,d),6)&&c.push(d);this.Da=c;c=[];for(d=0;d<a.Qi();d++)e=B_(a,d),.95<=Fx(e,2).length/V(e,8)&&c.push(d);this.Oa=c;c=[];for(d=0;d<Cx(a,3);d++){e=B_(a,V(a,3,d));a:if(.5<Fx(e,2).length/V(e,8)||.3>Cx(e,3)/Cx(e,2))e=!1;else{for(f=0;f<Cx(e,10);f++)if(.95<V(e,10,f)/V(e,8)){e=!1;break a}e=!0}e&&c.push(V(a,3,d))}qb(c);this.La=
c;this.F=fid(a.Qi());this.H=fid(Cx(a,1));this.D=new Xhd(this.O,this.R,b)}function fid(a){for(var b=[],c=0;c<a;c++)b.push(c);return b}function eid(a,b){for(var c=[],d=0;d<a.Qi();d++)B_(a,d).getType()==b&&c.push(d);return c}function gid(a,b){if(0==a.length&&0==b.length)return[];for(var c=0<a.length?a[0]:b[0],d=1;d<a.length;d++)c=hid(c,a[d]);for(a=0;a<b.length;a++)d=hid(c,b[a]),c=0<d.length?d:c;return c}
function g0(a,b,c,d,e,f,h,k){var l=[a.J,a.D.L],m=[a.F];c&&(m.push(a.Na),m.push(a.Da));d&&m.push(a.La);e&&m.push(a.Oa);null!=h&&-1!=h?l.push(Zhd(a.D.R,h)):f&&l.push(a.D.J);k&&l.push(a.D.H);a=gid(m,l);b=hid(a,b);return 0<b.length?{index:D_(b),zA:3}:0<a.length?{index:D_(a),zA:1}:iid()}
function h0(a,b,c,d,e,f){var h=[a.L,a.D.O],k=[a.H];c&&k.push(a.Ga);null!=e&&-1!=e?h.push(Zhd(a.D.F,e)):d&&h.push(a.D.ma);f&&h.push(a.D.oa);a=gid(k,h);b=hid(a,b);return 0<b.length?{index:D_(b),zA:3}:0<a.length?{index:D_(a),zA:1}:iid()}function jid(a,b){for(var c=5;;){var d=B_(a.C,b),e=C_(Cx(d,2),1)[0];c--;if(cid(A_(d,e))||0==c)return e}}function kid(a,b){for(var c=5;;){var d=B_(a.C,b),e=C_(Cx(d,3),1)[0];e=V(d,3,e);c--;if(cid(A_(d,e))||0==c)return e}}
function i0(a,b){b=B_(a.C,b);a=b.getName();cid(a)||(b=lid(Fx(b,7)),a=null==b?a:b);return a}function j0(a,b){b=V(a.C,1,b);a=b.getName();cid(a)||(b=lid(Fx(b,2)),a=null==b?a:b);return a}function lid(a){for(var b=0;b<a.length;b++)if(cid(a[b]))return a[b];return null}function cid(a){return null==a?!1:50>=a.length}function mid(a,b){return b.toLowerCase()in a.O?a.O[b.toLowerCase()]:-1}function iid(){return{index:-1,zA:0}}
function nid(a){for(var b=C_(a.length,2),c=[],d=0;d<b.length;d++)c.push({index:a[b[d]],zA:1});return c}function hid(a,b){qb(a);qb(b);for(var c=[],d=0,e=0;d<a.length&&e<b.length;)a[d]==b[e]?(c.push(a[d]),d++,e++):a[d]<b[e]?d++:e++;return c}var did=["average","total","sum","mean","median"];function k0(a){this.La=a;this.Ss=[];this.C=this.Da=this.Aa=this.rK=this.Dx=null;this.ma=[];this.Oa=[];this.R=new Qt;this.Ga=new Qt;this.oa=!1;this.D=[];this.F=[]}p=k0.prototype;p.init=function(a,b,c,d,e,f){this.reset();this.Dx=b;this.rK=c;this.Aa=d;this.Da=a;this.Oa=f;this.ma=e;this.C=new bid(a,e)};
p.G7=function(){oid(this);for(var a=[],b=0;b<this.ma.length;b++){var c=this.ma[b];switch(c.getChartType()){case "BarChart":if(this.rk(13)||this.rk(2)){var d=V(c,6);if(d&&-1!=mid(this.C,d)){var e=pid(this,c);1<e.length&&(this.rk(23)?l0(this,a,"Scatter chart of "+e[0].name+" vs "+e[1].name,23,2):this.rk(2)&&l0(this,a,"Correlation of "+e[0].name+" and "+e[1].name,2,1.5))}}break;case "ScatterChart":var f=pid(this,c);1<f.length&&(this.rk(23)?l0(this,a,"Scatter chart of "+f[0].name+" vs "+f[1].name,23,
2):this.rk(2)&&l0(this,a,"Correlation of "+f[0].name+" and "+f[1].name,2,1.5));break;case "PieChart":for(var h=void 0,k=[],l=Thd(c),m=0;m<l.length&&-1!=mid(this.C,l[m].name);m++)k.push(l[m]);h=k;1==h.length&&4==h[0].GZa&&(this.rk(20)?l0(this,a,"Chart of distribution of "+h[0].name,20,2):this.rk(14)&&l0(this,a,"Distribution of "+h[0].name,14,1.5))}}if(this.rk(26))for(var q=ia(this.Oa),t=q.next();!t.done;t=q.next()){var v=t.value;Bx(v,3)&&l0(this,a,v.Ef(),26,2)}if(this.rk(1)){var y=this.C.C,B=h0(this.C,
this.F,!1,!0),L=B.index,R=g0(this.C,this.D,!0,!1,!0,!0,L),U=R.index;if(-1!=U&&-1!=L){var W=10<=Cx(B_(y,U),2)?"5 ":"",pa=i0(this.C,U),ta=j0(this.C,L);if(pa!=ta){var Ga=m0(1,[B],[R]);l0(this,a,this.pBa(1)+" "+W+pa+" by "+ta,1,Ga)}}}if(this.rk(2)&&1<Cx(this.C.C,1)){a:{var Ja=this.C,Ka=this.F;if(2>Ja.H.length)var Sa=[iid(),iid()];else{var Ra=h0(Ja,Ka,!1,!1,void 0,!0),Db=Ra.index;if(-1!=Db){var ub=Zhd(Ja.D.D,Db);if(0<ub.length){var Ob=[Ra],Hc=D_(ub),Fb=2,Hb=hid(ub,Ka);0<Hb.length&&(Hc=D_(Hb),Fb=3);Ob.push({index:Hc,
zA:Fb});Sa=Ob;break a}}Sa=nid(2<=Ja.L.length?Ja.L:Ja.H)}}var Zc=Sa,dd=j0(this.C,Zc[0].index),md=j0(this.C,Zc[1].index);if(dd!=md){var gc=m0(1,Zc,[]);l0(this,a,"Correlation of "+dd+" and "+md,2,gc)}}if(this.rk(3)){var Ze=this.C.C,yb=h0(this.C,this.F,!0),Gd=yb.index;if(-1!=Gd){var Yd=m0(1,[yb],[]);l0(this,a,this.qO(Fx(V(Ze,1,Gd),3),3)+" of "+j0(this.C,Gd),3,Yd)}}if(this.rk(5)){var Xf=this.C.C,Yf=h0(this.C,this.F,!0,!0),Jg=Yf.index,Be=g0(this.C,this.D,!0,!0,!1,!0,Jg),ce=Be.index;if(-1!=Jg&&-1!=ce){var fg=
j0(this.C,Jg),sj=B_(Xf,ce),zh=i0(this.C,ce);if(0<Cx(sj,3)&&zh!=fg){var Pl=m0(1,[Yf],[Be]),tj=kid(this.C,ce);l0(this,a,this.qO(Fx(V(Xf,1,Jg),3),5)+" of "+fg+" when "+zh+" is "+A_(sj,tj),5,Pl)}}}if(this.rk(9)){var Lj=h0(this.C,this.F,!1,!0),Ql=Lj.index,gg=g0(this.C,this.D,!0,!1,!0,!0,Ql),Mj=gg.index;if(-1!=Mj&&-1!=Ql){var uj=j0(this.C,Ql),Nj=i0(this.C,Mj);if(Nj!=uj){var tl=m0(1,[Lj],[gg]);l0(this,a,Nj+" with "+this.Nga(9)+" "+uj,9,tl)}}}if(this.rk(10)&&0<Cx(this.C.C,1)){var ti=h0(this.C,this.F),ui=
m0(1,[ti],[]),Ui=j0(this.C,ti.index);l0(this,a,this.Nga(10)+" "+Ui,10,ui)}if(this.rk(11)){var Lh=this.C.C,ok=g0(this.C,this.D,!0,!0,!1,!1,-1),Ok=ok.index;if(-1!=Ok){var vi=i0(this.C,Ok);if(0<Cx(B_(Lh,Ok),3)){var Pk=m0(1,[],[ok]);l0(this,a,"Most frequent "+vi,11,Pk)}}}if(this.rk(12)){var Ib=this.C.C,Vh=h0(this.C,this.F,!0),Zm=Vh.index;a:{var ul=this.C;if(1==ul.ma.length){var Qr=ul.ma[0];if(!V(B_(ul.C,Qr),5)){var Zf=Qr;break a}}Zf=-1}var wi=Zf;if(-1!=wi&&-1!=Zm){var vj=j0(this.C,Zm),Oj=B_(Ib,wi);if(0<
Cx(Oj,2)){var uq=m0(1,[Vh],[]),wj=jid(this.C,wi);l0(this,a,this.qO(Fx(V(Ib,1,Zm),3),12)+" of "+vj+" "+D_(qid)+" "+A_(Oj,wj),12,uq)}}}if(this.rk(15)){var mm=this.C.C,$m=h0(this.C,this.F,!0),nm=$m.index,Fn=g0(this.C,this.D,!1,!0,!1,!0,nm),vq=Fn.index;if(-1!=nm&&-1!=vq){var pk=j0(this.C,nm),Rr=i0(this.C,vq);if(Rr!=pk){var qk=B_(mm,vq);if(2<=Cx(qk,3)){var Rl=m0(1,[$m],[Fn]),rk=C_(Cx(qk,3),2);l0(this,a,"Compare "+this.qO(Fx(V(mm,1,nm),3),15)+" "+pk+" for "+Rr+" "+A_(qk,V(qk,3,rk[0]))+" and "+A_(qk,V(qk,
3,rk[1])),15,Rl)}}}}if(this.rk(16)){var Wg=g0(this.C,this.D,!0,!0,!1,!1),om=Wg.index;if(-1!=om){var xj=i0(this.C,om),pm=m0(1,[],[Wg]);l0(this,a,"List unique values in "+xj,16,pm)}}if(this.rk(17)){var an=this.C.C,sk=g0(this.C,this.D,!0,!0,!1,!1),xi=sk.index;if(-1!=xi){var Pj=B_(an,xi),vl=i0(this.C,xi);if(!(1>Cx(Pj,3))){var Qk=kid(this.C,xi),xo=m0(1,[],[sk]);l0(this,a,"What percentage of "+vl+" is "+A_(Pj,Qk),17,xo)}}}if(this.rk(13)){var Sl=this.C.C,qm=h0(this.C,this.F,!0,!0),tk=qm.index,Tl=g0(this.C,
this.D,!0,!0,!1,!0,tk),Rk=Tl.index;if(-1!=tk&&-1!=Rk){var Gn=j0(this.C,tk),Hn=i0(this.C,Rk);if(Hn!=Gn){var wq=m0(1,[qm],[Tl]);l0(this,a,this.qO(Fx(V(Sl,1,tk),3),13)+" of "+Gn+" by "+Hn,13,wq)}}}if(this.rk(18)){var rt=h0(this.C,this.F),tp=rt.index;if(-1!=tp){var Qj=m0(2,[rt],[]);l0(this,a,"Histogram of "+j0(this.C,tp),18,Qj)}}if(this.rk(24)){var Zw=g0(this.C,this.D,!0,!0),Cp=Zw.index;if(-1!=Cp){var Nn=m0(1,[Zw],[]);l0(this,a,"Count of "+i0(this.C,Cp),24,Nn)}}if(this.rk(25)){var Yl=this.C.C,zl=g0(this.C,
this.D,!0,!0),Aj=zl.index;if(-1!=Aj){var wm=B_(Yl,Aj),$y=jid(this.C,Aj),Hq=m0(1,[zl],[]);l0(this,a,"Count when "+i0(this.C,Aj)+" is "+A_(wm,$y),25,Hq)}}var XB=3>a.length;if((XB||0==C_(5,1)[0])&&this.rk(7)){var az=this.C.C,dn=h0(this.C,this.F,!1,!0),Fo=g0(this.C,this.D,!1,!1,!1,!0,dn.index);if(-1!=Fo.index&&-1!=dn.index){var es=B_(az,Fo.index),$w=i0(this.C,Fo.index),bz=j0(this.C,dn.index);if(0<Cx(es,2)&&$w!=bz){var YB=m0(1,[dn],[Fo]),ZB=jid(this.C,Fo.index);l0(this,a,"Show "+bz+" for "+$w+" "+A_(es,
ZB),7,YB)}}}if((XB||0==C_(5,1)[0])&&this.rk(8)){var Al=this.C.C;a:{var Gt=this.C,dv=this.D;if(2>Gt.F.length)var en=[iid(),iid()];else{var Dp=g0(Gt,dv,!0,!1,!1,!1,void 0,!0),fs=Dp.index;if(-1!=fs){var Iq=Zhd(Gt.D.C,fs);if(0<Iq.length){var Ep=[Dp],gs=D_(Iq),hs=2,ax=hid(Iq,dv);0<ax.length&&(gs=D_(ax),hs=3);Ep.push({index:gs,zA:hs});en=Ep;break a}}var Zl=nid(2<=Gt.J.length?Gt.J:Gt.F);Zl[0].index!=fs&&(Zl[1]=Zl[0],Zl[0]=Dp);en=Zl}}var Ht=en,ev=Ht[0].index;if(1<Al.Qi()&&-1!=ev){var cz=Ht[1].index,fv=B_(Al,
cz),Bl=i0(this.C,cz),bj=i0(this.C,ev);if(0<Cx(fv,2)&&Bl!=bj){var Cl=m0(1,[],Ht),is=jid(this.C,cz);l0(this,a,"What is "+bj+" where "+Bl+" is "+A_(fv,is),8,Cl)}}}this.Ss=rid(a)};function oid(a){if(a.oa){var b=wJ(a.Dx?MK(a.La,a.Dx.C):HK(a.La)),c=Gx(a.C.C,4);x(b,function(b){var d=b.left,f=b.width;c&&(d=b.top,f=b.height);for(b=0;b<f;b++){var h=a.C.oa[d+b],k=a.C.Aa[d+b];h&&0<=h&&eb(a.D,h);k&&0<=k&&eb(a.F,k)}})}}p.reset=function(){this.Ss=[];this.F=[];this.D=[];this.Ga=new Qt;this.R=new Qt};p.H7=function(){return Se(this.Ss.slice())};
function rid(a){qb(a,function(a,c){return c.weight-a.weight});return Wa(a,function(a){return a.Cx})}function l0(a,b,c,d,e){e=a.nBa(d,e);a.Ga.contains(c)||(b.push({Cx:{query:c,aq:void 0,type:d},weight:e}),a.R.add(d),a.Ga.add(c))}p.rk=function(a){return!this.R.contains(a)};function sid(a,b){return a.H7().then(function(a){return a.length<=b?a:mb(a,0,b)},null,a)}function m0(a,b,c){x(b,function(b){3==b.zA&&a++});x(c,function(b){3==b.zA&&a++});return a}
function pid(a,b){var c=[];b=Thd(b);for(var d=0;d<b.length;d++){var e=a.C,f=b[d].name;if(-1==(f.toLowerCase()in e.R?e.R[f.toLowerCase()]:-1))break;c.push(b[d])}return c}p.qO=function(a){a:{if(0<a.length)for(var b=0;b<a.length;b++)switch(a[b]){case 5:a=tid;break a;case 4:a=uid;break a}a=vid}return D_(a)};p.pBa=function(){return D_(wid)};p.Nga=function(){return D_(xid)};
var vid=["Average","Median"],tid=["Total","Average","Median"],uid=["Median"],xid="Minimum Maximum Most Least Highest Lowest".split(" "),wid=["Top","Bottom"],qid=["before","after"];var yid={};ec({zYa:{type:0,Yz:"",Vz:[]},tba:{type:1,Yz:"Sum",Vz:[3,5,13,12,15]},oaa:{type:2,Yz:"Average",Vz:[3,5,13,12,15]},fVa:{type:3,Yz:"Mode",Vz:[3]},WYa:{type:4,Yz:"Variance",Vz:[3]},HXa:{type:5,Yz:"Standard deviation",Vz:[3]},ssa:{type:6,Yz:"Median",Vz:[3,5,13,12]},aT:{type:7,Yz:"Count",Vz:[24,25]},rXa:{type:8,Yz:"Bottom",Vz:[1,10,14]},sXa:{type:9,Yz:"Top",Vz:[1,11,10,14]}},function(a){yid[a.type]=a});function zid(a){if(a=yid[a])return a};function Aid(a){k0.call(this,a);this.H=[]}r(Aid,k0);p=Aid.prototype;p.reset=function(){k0.prototype.reset.call(this);this.H=[]};p.nBa=function(a,b){return 1+b};p.rk=function(a){return!this.R.contains(a)&&0<Bid(this,a).length};p.pBa=function(a){return Cid(this,a)};p.qO=function(a,b){return Cid(this,b)};p.Nga=function(a){return Cid(this,a)};function Did(a,b){a.reset();x(b,function(b){x(Fx(b,1),function(b){a.H.push(V(b,1))},a)},a);zed(a.H);a.G7();return sid(a,3)}
function Bid(a,b){return Va(a.H,function(a){return bb(zid(a).Vz,b)},a)}function Eid(a,b){a=$a(a.H,function(a){return zid(a).type==b},a);return zid(a)}function Cid(a,b){b=Bid(a,b);return Eid(a,D_(b)).Yz};function n0(a,b,c,d,e,f,h,k,l,m,q,t,v,y){P_.call(this,y);this.Xd=c;this.Ra=d;this.le=e;this.Sc=a;this.$a=new Aid(this.Ra);this.Sa=h;this.oa=m;this.$e=q;this.xe=t;this.L=this.J=this.R=this.pb=this.F=null;this.Ya="";this.Ga=new Fed;this.O=f;this.La=this.Jb=this.Oa=this.D=null;this.Na=k;this.Fd=!1;this.kb=Pm(new Om,10).build();this.Ne=new Fz;this.gb=l;this.ma={};this.ud=pq();this.fb="";this.Da=null;this.tf=v}w(n0,P_);p=n0.prototype;p.Ja=function(){n0.qa.Ja.call(this);this.eH(null==this.D)};
p.Nna=function(a,b){n0.qa.Nna.call(this,a,b);b=this.va();var c=this.Aa;this.R=new F_(b);c.Ha(this.R,!0);b.appendChild(a,this.R.Qa());this.R.Ja();this.J=new Ped(this.R,this.O,this.Ga,10);c.Ba(this.J);c.getHandler().V(this.R,"answers-submit-query",u(this.PTb,this))};p.d2=function(){n0.qa.d2.call(this);this.J=this.R=null};
p.eH=function(a){var b=this;this.R&&this.R.setVisible(!a);a?(this.Da&&this.Da.dispose(),this.Da=new im(function(){n0.qa.eH.call(b,a)},300,this),this.Ba(this.Da),this.Da.start()):(this.Da&&this.Da.stop(),n0.qa.eH.call(this,a))};p.rf=ca("pb");
function Fid(a,b,c,d,e,f,h){h=void 0===h?[]:h;var k=void 0===k?[]:k;a.$a.init(c,b,d,e,h,k);h=Wa(Fx(c,1),function(a){return a.getName()});var l=[],m=[];x(Fx(c,2),function(a){l.push(a.getName());m=m.concat(Fx(a,2))});Ged(a.Ga,h,l,m);a.Sc.H7().then(function(a){this.Ga.F=a;this.J&&(a=this.J,te(a.O.va())==a.D&&a.zMa())},null,a);a.D=b;a.Oa=d;a.Jb=e;a.La=c;a.kb=Qm(Pm(new Om,10),Gid(a)).build();if(f)for(c=Wa(a.C,function(a){if(a instanceof d0||a instanceof e0)return a.kM().D}),a.tU(),d=0;d<c.length;d++)if(e=
c[d])f=new y_,G(f,1,5),Hid(a,e,f);a.eH(null==b)}p.reset=function(){oW(this.ma);oW(this.Ga.D);var a=this.Ga;a.F=[];a.C.clear();this.L=null;this.xea()};
function Hid(a,b,c,d,e){d=void 0===d?null:d;e=void 0===e?!1:e;G(c,13,a.oa.L.J);var f=new x_;xf(f,5,c);a.J&&Ved(a.J);var h=Lb(b.toLowerCase());if(!a.pb||a.pb.getStatus().getState().qh())if(a.ma[h])Iid(a,b,!1);else{d=new b0(b,null,null,null,2,a.oa);Jid(a,d,!0,f);return}else{var k=a.ma[h];k&&k instanceof e0&&2==k.kM().error&&delete a.ma[h]}b&&a.D?a.ma[h]&&!d?(a.O.C(2681,a.kb),Iid(a,b,!0)):(a.ma[h]&&d&&Kid(a,a.ma[h],!1),h=Gid(a),k=vf(vf(h,XV,46),x_,4),G(k,2,e),e=Qm(Pm(new Om,10),h).build(),a.O.C(2635,
e),e=cK(a.D.rect),f=px(ow(pu(nw(ou(Np(Np(Np(Np(Np(a.pb.jf("/answers/parse"),"q",b),"qt",String(F(c,1))),"gid",String(a.D.C)),"range",e),"context",a.Ya),u(a.Xj,a,b,f)),u(a.OTb,a,b,f)),"POST"),2)),a.Oa&&null!=a.Jb&&(b=0==a.Oa.rect.width||0==a.Oa.rect.height?"":cK(a.Oa.rect),Np(Np(f,"headerRange",b),"tableRecordDimension",""+a.Jb)),d&&Np(f,"sgfml",d),f.Oe(),a.fb=qq(a.ud,"satt"),Lid(a,!0)):Ted(a.J,"")}
function Iid(a,b,c){var d=a.ma[Lb(b.toLowerCase())];d!=Qa(a.C)&&(1<a.C.length&&Mid(a),c&&Nid(a,d.kM()).then(function(a){Oid(this,d,a)},null,a),dgd(a,d))}p.PTb=function(a){var b=a.O;var c=a.Ga;var d=a.F,e=a.ma;c?c=Ogd(b,d,e,c):(c=new y_,G(c,1,b));Hid(this,a.R,c,a.C,a.H)};p.OTb=function(a,b){if(this.D){var c=F(vf(b,y_,5),1);c=1==c||4==c?led.eta:led.tta;var d=Gid(this),e=vf(vf(d,XV,46),x_,4);G(e,1,c);G(b,1,c);c=Qm(Pm(new Om,10),d).build();this.O.C(2640,c);Pid(this,a,b)}};
function Pid(a,b,c){Lid(a,!1);b=new b0(b,null,null,null,3,a.oa);Jid(a,b,!1,c);Qid(a)}
p.Xj=function(a,b,c){this.D&&this.Na.C.D.C.then(function(){var d=null,e=null,f=!1,h=vf(b,y_,5),k=F(h,1),l=Gid(this);k=1==k||4==k?led.eta:led.tta;var m=vf(vf(l,XV,46),x_,4);G(m,1,k);G(b,1,k);l=Qm(Pm(new Om,10),l).build();if(c.uj()){e=this.Ne.yd(Y_.Ca(),c.hf());if(f=e.getStatus()){switch(f){case 1:var q=2639;break;case 2:q=2643;break;case 3:q=2644;break;case 4:q=2638;break;case 5:q=2707;break;case 6:q=2706}q&&this.O.C(q,l)}q=V(e,10);G(h,4,q);q=V(e,11);G(h,5,q);Bx(e,16)&&(q=V(e,16),G(h,16,q));if(1==
f){Pid(this,a,b);return}if(2==f){e=-1!=Rid(a);h=-1!=Ngd(a);f=4;d=vf(b,y_,5);e?(f=5,G(d,8,2)):h&&(f=7,G(d,8,1));h=new b0(a,null,null,null,f,this.oa);e?(e=new e0(h,!0,this.gb,!0,this.va()),Sid(this,h,e,b)):Jid(this,h,!0,b);Lid(this,!1);Qid(this);return}k=Bx(e,2)?e.Lj():null;f=!0;if(k){q="";if(this.D.C!=this.Ra.C.jb()){d=RJ(this.Ra,this.D.C).ze();k=K3b(new J3b(this.oa),k);var t="";for(m=0;m<k.length;m++){var v=k[m];"range"==v.getType()?(v=v.getText(),v=YGb(v,d),t+=v):t+=v.getText()}k=t}d=fed(this.Na,
k,this.D,!!this.La&&!!V(this.La,4));G(h,14,!!d);if(!d){if(m=k.match(/([A-Z]*)\(/))t=vf(vf(Ewa(l),XV,46),x_,4),G(t,7,m[1]),G(b,7,m[1]);this.O.C(2645,l)}d&&ged(d)||(q=this.Na,t=this.D,l="="!=k[0]?"="+k:k,m=t.C,t=eed(m,t),q=nuc(q.C,l,m,t.row,t.column));l=Bx(e,19)?fed(this.Na,V(e,19)||"",this.D,!!this.La&&!!V(this.La,4)):d;d=new b0(a,d,"="!=k[0]?"="+k:k,e,null,this.oa,l,this.D.C);if(Bx(e,23)&&d.sj()){if(Bx(e,17)&&Bx(V(e,17),5)){k=V(V(e,17),5);l=d.oa;if(Bx(k,5))switch(V(k,5).getPosition()){case 1:l.C=
"right";break;case 2:l.C="left";break;case 3:l.C="top";break;case 4:l.C="bottom"}Bx(k,1)&&Bx(V(k,1),1)&&Bx(V(V(k,1),1),1)&&1==V(V(V(k,1),1),1)&&(l.J=!0);Bx(k,2)&&Bx(V(k,2),1)&&Bx(V(V(k,2),1),1)&&1==V(V(V(k,2),1),1)&&(l.L=!0);Bx(k,1)&&Bx(V(k,1),1)&&Bx(V(V(k,1),1),2)&&(m=V(V(V(k,1),1),2),l.F=m);Bx(k,2)&&Bx(V(k,2),1)&&Bx(V(V(k,2),1),2)&&(m=V(V(V(k,2),1),2),l.H=m);Bx(k,3)&&(m=k.getTitle().getTitle(),l.O=m);Bx(k,4)&&(k=V(k,4).getTitle(),l.D=k)}this.Ya=Gx(e,23)}else this.Ya="";q&&d.L.push(q);d.sj()&&xf(h,
15,d.R);d.ez()&&Bx(e,24)&&(q=U6c(Gx(e,24)),xf(h,17,q))}else!d&&Bx(e,24)?(d=new b0(a,[[]],"",e,null,this.oa,[[]],this.D.C),this.Ya=Gx(e,23),q=U6c(Gx(e,24)),xf(h,17,q)):Bx(e,9)&&(q=e.getError(),d=new b0(a,null,null,e||null,6,this.oa),l=V(q,2),G(h,6,l),Bx(q,3)&&(q=V(q,3),G(h,12,q)))}else this.O.C(2640,l);d||(d=new b0(a,null,null,e||null,4,this.oa));Lid(this,!1);Vgd(d)?Tid(this,d,f,b):Jid(this,d,f,b);Qid(this)},function(){Pid(this,a,b)},this)};function Qid(a){""!=a.fb&&(rq(a.ud,a.fb),a.fb="")}
function Uid(a){if(null!=a.aq)return Qhd;switch(a.error){case 4:case 6:return 0<a.O.length?Rhd:Phd;case 5:return Phd}return Shd}function Gid(a){var b=new x_;G(b,8,!0);var c=new XV;xf(c,4,b);a=Gfd(a.D,TJ(a.Ra));xf(a,46,c);return a}function Rid(a){return ab(Lgd,function(b){return Bb(a,b)})}
function Vid(a,b){var c=[];b=b.O;for(var d=0;d<b.length&&3>c.length;++d){var e=a.Na,f=b[d].Lj(),h=!!a.La&&!!V(a.La,4);e=fed(e,f,a.D,h);ged(e)&&(e={query:V(b[d],1),aq:b[d].Lj(),type:b[d].getType()},Bx(b[d],5)&&(e.Iza=V(b[d],5)),c.push(e))}return Se(c)}function Tid(a,b,c,d){c=new d0(b,a.Xd,a.Ra,a.le,a.O,a.gb,a.Sa,c,a.oa,a.Fd,a.tf,a.Na,a.va());Sid(a,b,c,d)}
function Wid(a,b){if(a.F&&a.F.isVisible())vR(a.F);else{var c=a.$e.D.C["ritz-ap"]||null;b.Aa&&(a.F=Yjc(Ujc(Xjc(Vjc(Wjc(new Tjc,c),"answersPivotPromo"),a.va()),a.xe)),a.F&&(a.getHandler().Rc(a.F.C,"beforeshow",function(){return a.hTb}).Rc(a,"Se",a.xea),a.F.show(),a.Ba(a.F),E1a(c,"answersPivotPromo")))}}p.F$=function(){n0.qa.F$.call(this);this.F&&this.F.isVisible()&&this.F.C.jd()};p.hTb=function(){var a=this.va().Ka("docs-promo-text-container",this.F.C.Qa());J(a,"waffle-assistant-answercard-pivot-promo-text-container")};
p.xea=function(){this.F&&this.F.isVisible()&&vR(this.F)};function Jid(a,b,c,d){c=new e0(b,c,a.gb,!1,a.va());Sid(a,b,c,d)}function Sid(a,b,c,d){Mid(a);var e=Nid(a,b,d);Xid(a,c);c instanceof d0&&Wid(a,c);Yid(a);Vgd(b)&&Hed(a.Ga,b.D);e.then(function(a){if(d){if(c instanceof d0){var b=vf(d,y_,5);G(b,18,c.Vb)}b=Gid(this);var e=vf(b,XV,46);xf(e,4,d);b=Qm(Pm(new Om,10),b).build();this.O.C(2781,b)}Oid(this,c,a)},null,a);c.fga()&&(a.ma[Lb(b.D.toLowerCase())]=c);a.getHandler().V(c,"rc",a.pFa)}
function Oid(a,b,c){b instanceof e0&&null!=c&&Dl(c.getElement())&&(b=b.getElement(),K(b,!1),a.getHandler().V(c,"rc",a.pFa))}function Mid(a){Zid(a);x(a.C,function(a){a instanceof e0&&(a=a.getElement(),K(a,!0))});$id(a)}function $id(a){0!=a.C.length&&(a.L?dgd(a,a.L):(a.L=new Mhd(a.va()),Xid(a,a.L)))}function Zid(a){x(a.C,function(b){b instanceof d0||b instanceof e0||b==a.L||a.HG(b)})}
function ajd(a,b){var c=Se([]);b=b.Da;0<b.length&&(c=Did(a.$a,b));return c=c.then(function(b){var c=3-b.length;return 0<c?sid(a.Sc,c).then(function(a){return jb(b,a)}):Se(b)})}
function Nid(a,b,c){var d=Uid(b),e=null;d==Qhd||d==Rhd?0<b.O.length&&(e=Vid(a,b)):d==Phd&&(e=ajd(a,b));var f=null;return e?(f=new f0(new wK,a.gb,e,d,b,a.va()),Xid(a,f),a.O.C(2769,a.kb),a.getHandler().V(f,"sqc",u(a.ezb,a)),e.then(function(a){if(c){var b=vf(c,y_,5);bb([Qhd,Rhd],f.D)?(a=Qgd(a),xf(b,7,a)):bb([Ohd,Phd],f.D)&&(a=Rgd(a),xf(b,9,a))}return f},null,a)):Se(f)}p.ezb=function(a){Ted(this.J,a.F,!0);var b=a.O;b=1==b?Ogd(b,a.C,a.H,3):Pgd(b,a.C,a.H,a.ma);Hid(this,a.F,b,a.Lj());this.O.C(2762,this.kb)};
function Lid(a,b){a.R&&(a=a.R,K(a.F,b),K(a.va().Ka("waffle-assistant-answers-button-container",a.C),!b),a.H.setActive(b))}function Xid(a,b){b.Xs(a.Md());a.C.push(b);if(a.Vb){cgd(a,!1);var c=a.H.$c();b.O=c;a.H.Uf(b,0,!0);b.uI()}zfd(b,!0)}function Yid(a){for(var b=a.C;5<b.length;)a.HG(b[0])}p.tU=function(){n0.qa.tU.call(this);this.reset()};p.pFa=function(a){Kid(this,a.target)};p.xvb=function(a){Tid(this,a.kM(),a.fga());Jhd(this.Sa,"Remove answer undone",this.va())};
p.HG=function(a){if(a.sb()){if(a instanceof d0||a instanceof e0)delete this.ma[Lb(a.kM().D.toLowerCase())],a==Qa(this.C)&&Zid(this);n0.qa.HG.call(this,a);this.xea()}A(a)};
function Kid(a,b,c){c=void 0===c?!0:c;var d=a.va();if(b instanceof d0)a.HG(b),c&&Jhd(a.Sa,"Answer removed",d,u(a.xvb,a,b));else if(b instanceof e0)a.HG(b),c&&Jhd(a.Sa,"Card removed",d);else if(b instanceof f0&&b.C&&!Vgd(b.C)){var e=b.C.D;x(a.C,function(b){b instanceof e0&&b.kM().D==e&&(a.HG(b),c&&Jhd(a.Sa,"Card removed",d))})}b=a.C;!a.L||b[0]!=a.L&&b[b.length-1]!=a.L||(a.HG(a.L),a.L=null)};function bjd(a,b,c){b=c||b;a=P('<div class="waffle-assistant-answers-logging-message-container"><div class="waffle-assistant-answers-logging-message"><span class="waffle-assistant-answers-logging-text">We\'re logging your queries and data to improve the feature.</span><div class="waffle-assistant-answers-learn-more">Learn More</div><div class="waffle-assistant-answers-logging-opt-out">Opt-out for this file</div></div></div>')+'<div class="waffle-assistant-answers-input waffle-assistant-answers-input-with-icon"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container"><div class="waffle-assistant-answers-search-icon">'+
O(au({icon:"docs-icon-img docs-icon-search-this-document"},b))+'</div><input class="waffle-assistant-answers-input-box" placeholder="';a+=Ys("Ask a question about your data");return P(a+'"/></div></form></div>')};function cjd(a,b,c){k0.call(this,a);this.J=[];this.O=this.H=null;this.Na=b;this.Sa=c;this.L=null;this.Ra=Pm(new Om,10).build()}r(cjd,k0);p=cjd.prototype;p.G7=function(){this.reset();k0.prototype.G7.call(this);djd(this)};p.reset=function(){k0.prototype.reset.call(this);this.J=[];this.H&&(this.H.cancel(),this.H=null);this.L&&(this.L.dispose(),this.L=null)};p.H7=function(){return this.H?this.H.then(function(){return this.J.slice()},null,this):k0.prototype.H7.call(this)};
p.nBa=function(a,b){return Math.pow(Math.random(),1/(ejd(a)*b))};p.rf=ca("O");function ejd(a){switch(a){case 13:return.34;case 3:return.37;case 12:return.25;case 5:return.3;case 15:return.34;case 2:return.43;case 8:return.76;case 9:return.35;case 14:return.47;case 11:return.4;case 7:return.37;case 10:return.36;case 17:return.41;case 1:return.42;case 16:return.3;case 26:return.5;default:return.3}}
function djd(a){a.H=new Qe(function(a){var b=this;if(!this.O||this.O.getStatus().getState().qh())this.J=this.Ss,a();var d=cK(this.Dx.rect),e=Wa(this.Ss,function(a){return a.query});d=pu(px(ow(Xw(nw(ou(Np(Np(this.O.jf("/answers/parsesuggestions"),"gid",String(this.Dx.C)),"range",d),function(c){b.H&&fjd(b,c).then(a)}),function(c){b.H&&(8==c.getErrorCode()&&b.Sa.C(2833,b.Ra),b.J=b.Ss,a())}),["queries",Lo(e)]).setTimeout(2E3),1)),"POST");this.rK&&null!=this.Aa&&(e=0==this.rK.rect.width||0==this.rK.rect.height?
"":cK(this.rK.rect),Np(Np(d,"headerRange",e),"tableRecordDimension",""+this.Aa));this.L=d.Oe()},a);Xe(a.H,function(){a.L&&(a.L.dispose(),a.J=a.Ss)})}function fjd(a,b){return a.Na.C.D.C.then(function(){var a=[];if(b.uj()&&this.Dx&&1<this.Ss.length)for(var d=b.hf(),e=0;e<d.length;e++){var f;if(f=d[e]){f=this.Na;var h=!!this.Da&&!!V(this.Da,4);f=fed(f,d[e],this.Dx,h);f=ged(f)}f&&(this.Ss[e].aq=d[e],a.push(this.Ss[e]))}this.J=a},function(){this.J.length=0},a)};function o0(a,b,c,d,e,f,h,k,l,m,q){Q_.call(this,1,f,e,q);this.$a=c;this.Na=null;this.Da=new Wr("",new MY,this.va());this.Ha(this.Da);this.Ga=new Wr("",new MY,this.va());this.Ha(this.Ga);f=new luc(a,!0,!0);f=new t6c(f);this.Ua=new qhd(e);this.O=new cjd(this.$a,f,e);this.H=new n0(this.O,a,b,c,d,e,this.Sa,f,this.Ua,h,k,l,m,q);a=gjd;this.D=new NY(b,a.Laa,a.Maa);this.Ba(this.D);this.F=this.J=null;this.Ya=Pm(new Om,10).build();this.La=!1}w(o0,Q_);
var gjd={Laa:"waffle-assistant-answers-styled-border",Maa:"waffle-assistant-answers-styled-rect",pUa:"waffle-assistant-answers-input-box",rWa:"waffle-assistant-answers-query-box",Qoc:"waffle-assistant-answers-query-box-focused",IUa:"waffle-assistant-answers-learn-more",Zic:"waffle-assistant-answers-logging-message-container",NVa:"waffle-assistant-answers-logging-opt-out"};p=o0.prototype;p.Ea=function(){o0.qa.Ea.call(this);var a=N(bjd);this.va().appendChild(fgd(this),a)};
p.Ja=function(){o0.qa.Ja.call(this);var a=gjd,b=this.Ka(a.rWa),c=this.Ka(a.pUa);this.Ga.Wa(this.Ka(a.NVa));this.Da.Wa(this.Ka(a.IUa));this.getHandler().V(b,"focus",this.Pub,!0).V(b,"blur",this.Nub,!0).V(b,"mouseover",this.Rub).V(b,"mouseout",this.Qub).V(b,"click",this.Oub).V(c,"input",this.QTb).V(this.Ga,"action",this.Qsb).V(this.Da,"action",this.zpb).V(bJ(this.$a),"Qb",xYc(this.RTb,25,this));this.setVisible(null!=this.J);hjd(this,Cpb&&Dpb&&hE("showAnswersLoggingOptOut"))};p.jOa=Cc;p.hGa=Dc;
p.Moa=Cc;p.getTitle=n("Answers");p.p0=n(1);p.lU=function(a){return 3==a||0==a||1==a};p.lM=function(a,b){qb(a,function(a,b){return V(b,2)-V(a,2)});for(var c=[],d=[],e=null,f=0;f<a.length;f++){var h=Gx(a[f],1);3==h?e=a[f]:0==h?c.push(V(a[f],8)):1==h&&d.push(a[f])}if(e&&V(e,2)){f=b||null;h=Bx(e,11)?V(e,11):null;var k=null==h?null:xB(V(e,10));0<Cx(e,4)?ijd(this,xB(aW(e)),V(e,9),k,h,c,d):ijd(this,f,V(e,9),k,h,c,d);this.F||(o0.qa.lM.call(this,a,b),this.getHandler().V(this.F,"sqc",this.czb))}else this.mM(!0)};
p.tN=function(a){if(!this.F){var b=sid(this.O,3);this.F=new f0(a,this.Ua,b,Ohd,void 0,this.va())}return this.F};p.Vva=g("H");p.wja=function(){return this.isVisible()};
p.mM=function(a,b,c){this.O.reset();(a||b)&&this.F&&(o0.qa.mM.call(this,a,b,c),this.F.dispose(),this.F=null);if(a||ma(b)&&!b)this.F&&(o0.qa.mM.call(this,a,b,c),this.F.dispose(),this.F=null),this.sb()&&(this.O.reset(),this.J=null,a=this.H,a.sb()&&(b=a.Ga,b.F=[],b.C.clear(),a.J&&(b=a.J,b.O.sb()&&(Oed(b.D),b.F.isDisposed()||b.F.setVisible(!1),b.J=!1)),a.tU(),a.$a.reset(),a.D=null,a.eH(!0)),this.setVisible(!1),this.yb()&&PY(this.D));c&&this.H.reset()};p.kQa=function(a,b){b||cgd(this.H,a)};
p.rf=function(a){this.Na=a;this.H.rf(a);this.O.rf(a)};p.setActive=function(a){o0.qa.setActive.call(this,a);a?OY(this.D,this.J):PY(this.D)};function jjd(a,b){a.yb()&&(b?PY(a.D):OY(a.D,a.J))}function hjd(a,b){K(a.Ka("waffle-assistant-answers-logging-message-container"),b)}function kjd(a,b){a=a.Ka("waffle-assistant-answers-query-box");Sk(a,"waffle-assistant-answers-query-box-focused",b)}p.RTb=function(){this.yb()&&OY(this.D,this.J)};p.Pub=function(){kjd(this,!0);OY(this.D,this.J)};
p.Nub=function(){kjd(this,!1);this.yb()||PY(this.D)};p.Rub=function(){OY(this.D,this.J)};p.Qub=function(){this.yb()||PY(this.D)};p.Oub=function(){ljd(this,"")};p.QTb=function(){var a=this.Ka("waffle-assistant-answers-input-box");ljd(this,a.value);a.value=""};p.czb=function(a){var b=this,c=a.F;ljd(this,c);var d=Ogd(1,a.C,a.H,1),e=new im(function(){Hid(b.H,c,d,a.Lj())},300);this.Ba(e);e.start();this.R.C(2652,this.Ya)};function ljd(a,b,c){a.setActive(!0);a.dispatchEvent("Ye");mjd(a,b,c)}
function mjd(a,b,c){c=void 0===c?!1:c;var d=new im(function(){Ted(a.H.J,b,!0);var d=a.H,f=c||!1;d.Fd=f;d.Sc.oa=f;d.$a.oa=f},300);a.Ba(d);d.start()}function ijd(a,b,c,d,e,f,h){c=c||new rK;a.J=b;a.O.init(c,b,d,e,f,h);a.O.G7();a.setVisible(null!=b);Fid(a.H,b,c,d,e,a.La,f);a.La=!1;a.yb()&&OY(a.D,a.J)}p.Qsb=function(a){a.stopPropagation();a.preventDefault();this.Na&&(pu(nw(ou(this.Na.jf("/answers/logoptout"),u(this.cqb,this)),u(this.bqb,this)),"POST").Oe(),this.R.C(2663,this.Ya))};
p.zpb=function(a){a.stopPropagation();a.preventDefault();nr("https://docs.google.com/document/d/1VxpmAx5RTnwmeXyj3IuPPYIXg9DYzTS8nz8pi1E_ZJk/preview",{target:"_blank"})};p.cqb=function(a){a.uj()&&hjd(this,!1)};p.bqb=ba();function njd(a){a='<div class="waffle-assistant-quicksum-entry" tabindex="0"><span class="waffle-assistant-quicksum-entry-name" title="'+Q(a.title)+'">'+O(a.name)+'</span><span class="waffle-assistant-quicksum-entry-value"></span><span aria-label="';a+=Ys("Press enter to insert formula");return P(a+'"></span></div>')};function p0(a,b){M.call(this);this.C=a;this.D=b}w(p0,M);p=p0.prototype;p.Ea=function(){var a=N(njd,{name:this.C,title:this.D});this.mb(a)};p.Ja=function(){p0.qa.Ja.call(this);var a=this.Ka("waffle-assistant-quicksum-entry-name");H_(a);this.getHandler().V(this.Qa(),"keypress",this.BTb);K(this.Qa(),!1)};p.getFunctionName=g("C");p.setValue=function(a){ge(this.Ka("waffle-assistant-quicksum-entry-value"),a||"");K(this.Qa(),!!a)};p.isVisible=function(){return Dl(this.Qa())};
p.BTb=function(a){13==a.keyCode&&(a.stopPropagation(),a.preventDefault(),this.dispatchEvent(new D("insert",this)))};function ojd(a,b,c,d,e){M.call(this,e);this.Na=a;this.Ga=b;this.L=c;this.O=d;this.D=a.C;this.La=new Fz;this.oa=Pm(new Om,17).build();this.ma=Pm(new Om,2).build();this.R=!1;this.F=[];this.C=this.J=null;this.H=[]}w(ojd,M);
ojd.prototype.Ja=function(){ojd.qa.Ja.call(this);this.Uf(new p0(ritz_api.RitzModelApi.getLocalizedFunctionName("SUM"),"Sum"),0,!0);this.Uf(new p0(ritz_api.RitzModelApi.getLocalizedFunctionName("AVERAGE"),"Average"),1,!0);this.Uf(new p0(ritz_api.RitzModelApi.getLocalizedFunctionName("MIN"),"Minimum"),2,!0);this.Uf(new p0(ritz_api.RitzModelApi.getLocalizedFunctionName("MAX"),"Maximum"),3,!0);this.Uf(new p0(ritz_api.RitzModelApi.getLocalizedFunctionName("COUNTA"),"Count all"),4,!0);this.C=new thd(this.Qa(),
this.Ga,this.D,this.L);this.C.D=this.R;this.Ba(this.C);this.getHandler().V(this,"insert",this.Aa).V(this.C,"formula_inserted",this.Da)};
ojd.prototype.refresh=function(a){function b(a){return h?ritz_api.RitzModelApi.renderNumberAsFormattedString(a,k):null}if(oI(this.D)){if(null==a){var c=HK(this.D),d=wJ(c);a=ZL(this.D);if(!Za(d,c.xn,c)){K(this.Qa(),!1);return}c=[];for(var e=0;e<d.length;e++){var f=d[e];f=rB(a,f.rc(),f.qc(),f.Zc(),f.ad());c.push(f)}a=c}d=[];this.F=[];for(c=0;c<a.length;c++)e=a[c],this.F.push(yB(e)),d.push(this.La.serialize(e));a=a[0].jb();this.J=null;a!=ZL(this.D)&&(this.J=(a=RJ(this.D,a))?a.ze():null);if(d=ritz_api.RitzModelApi.quickSum(d)){K(this.Qa(),
!0);a=d.count;c=d.countNumberFormat;var h=1<d.numericCount,k=h?d.valueNumberFormat:null;this.Tc(0).setValue(b(d.sum));this.Tc(1).setValue(b(d.average));this.Tc(2).setValue(b(d.min));this.Tc(3).setValue(b(d.max));1<a?this.Tc(4).setValue(ritz_api.RitzModelApi.renderNumberAsFormattedString(a,c)):K(this.Qa(),!1);if(this.C){this.C.J=[];this.H=[];for(d=0;d<this.$c();++d)a=this.Tc(d),this.H.push(pjd(this,a.getFunctionName()));this.C.J=this.H}}else K(this.Qa(),!1)}else K(this.Qa(),!1)};
ojd.prototype.Aa=function(a){var b=a.target;a=this.F[0];a=new vd(a.left,a.Zc());b=b.getFunctionName();b=pjd(this,b);a=new $Q(HK(this.D),a,b);this.L.C(a);this.O.C(2624,this.ma)};ojd.prototype.Da=function(){this.O.C(2624,this.oa)};function pjd(a,b){var c=a.Na.L.D,d=a.J;a=Wa(a.F,function(a){return cK(a,d)});return"="+b+"("+a.join(c)+")"};function qjd(a,b,c){E.call(this);this.C=tIb(yK.getInstance(),a,b,c);this.D=gf()}w(qjd,E);qjd.prototype.update=function(a,b,c){var d=this,e=this.C.C;c&&e&&!$a(c,function(a){return kjb(a,e.rect)},this)||!a&&e&&c&&1==c.length&&1==c[0].Zg()&&e.rect.contains(c[0])||(this.D.cancel(!0),a&&wXc(this.C),this.D=rjd(),this.D.addCallback(function(){return NXc(d.C,b,!0)}))};qjd.prototype.rf=function(a){this.C.rf(a)};
function rjd(){var a=null,b=new $e(function(){null===a||gm(a)});a=fm(function(){b.callback()});return b};function sjd(a,b,c){b=c||b;c='<div class="waffle-autovis-lightbox"><div class="waffle-autovis-lightbox-header"><div class="waffle-autovis-lightbox-buttons-wrapper">'+O(Kt({content:Us("INSERT CHART"),style:4,Jd:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-insert waffle-autovis-lightbox-readonly-hidden"},b));c+=O(Kt({Jd:"waffle-autovis-lightbox-close",content:Vs(""+O(au({icon:"docs-icon-img docs-icon-close-white"},b))),style:4,title:Us("Close")},b));c+='</div></div><div class="waffle-autovis-lightbox-content"><div class="waffle-autovis-lightbox-content-inner">';
var d='aria-label="'+Ys("Previous chart");d+='"';c+=O(Kt({content:Vs("&#10094;"),style:4,Jd:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-previous",attributes:Ws(d)},b));c+='<div class="goog-inline-block waffle-autovis-lightbox-container"></div>';d='aria-label="'+Ys("Next chart");d+='"';c+=O(Kt({content:Vs("&#10095;"),style:4,Jd:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-next",attributes:Ws(d)},b));c+='</div><div class="waffle-autovis-lightbox-page-count"><span class="waffle-autovis-lightbox-page-number"></span>/'+
O(a.aIb)+"</div></div></div>";return P(c)}function tjd(){return P('<div class="waffle-autovis-lightbox-chart"></div>')};function ujd(a,b,c,d,e){M.call(this,e);this.F=a;this.D=b;this.ma=c;this.R=d;this.H=[];this.C=new Lt("",this.va());this.Ha(this.C);this.O=new Lt("",this.va());this.Ha(this.O);this.L=new Lt("",this.va());this.Ha(this.L);this.J=new Lt("",this.va());this.Ha(this.J)}w(ujd,M);p=ujd.prototype;p.Ea=function(){ujd.qa.Ea.call(this);this.mb(N(sjd,{aIb:this.F.length}))};
p.Ja=function(){ujd.qa.Ja.call(this);var a=Urb.isEnabled();vjd(this,!a);a=this.Ka("waffle-autovis-lightbox-close");this.C.Wa(a);a=this.Ka("waffle-autovis-lightbox-insert");this.O.Wa(a);var b=this.Ka("waffle-autovis-lightbox-previous");this.L.Wa(b);b=this.Ka("waffle-autovis-lightbox-next");this.J.Wa(b);wjd(this);xjd(this,this.D,!1);this.getHandler().V(document.body,"focusin",this.mUb).V(this.Qa(),"keydown",this.nUb).V(Nd(),"resize",this.qUb).V(this.C,"action",this.close).V(this.O,"action",this.Oob).V(this.L,
"action",this.pUb).V(this.J,"action",this.oUb);b=new gP(this.Qa(),this.va());hP(b);this.Ba(b);a.focus()};function wjd(a){var b=a.Ka("waffle-autovis-lightbox-content"),c=a.Ka("waffle-autovis-lightbox-content-inner");a=a.Ka("waffle-autovis-lightbox-page-count");var d=Ld();a=wl(a);var e=d.height-a.height-195,f=d.width-200;.75<e/f?(d=f,e=.75*f):d=e/.75;ql(c,d,e);ql(b,d,e+a.height+35)}function vjd(a,b){Sk(a.Qa(),"waffle-autovis-lightbox-readonly",b)}
function xjd(a,b,c){c&&$H("Page "+(b+1+(" of "+(a.F.length+"."))));a.H[b]?yjd(a,b):a.F[b]&&(I(H(),"fecpmr")?(c=Ifd(a.F[b]),zjd(a,c,b)):Jfd(a.F[b],function(c){if(!a.isDisposed()&&c){var d=c.ge();d=d?d.toJSON():null;var f=new ritz.charts.model.GvizChart;f.updateChartWrapperJsonString(c.toJSON());d&&f.updateDataTableJsonString(d);zjd(a,f,b)}},!0))}function zjd(a,b,c){var d=a.Ka("waffle-autovis-lightbox-container"),e=N(tjd);d.appendChild(e);a.H[c]=e;V4c(b,e,a.ma,a.R);yjd(a,c)}
function yjd(a,b){K(a.H[a.D],!1);K(a.H[b],!0);a.L.Pa(0!=b);a.J.Pa(b!=a.F.length-1);var c=a.Ka("waffle-autovis-lightbox-page-number");ge(c,b+1);a.D=b}p.mUb=function(a){!ee(this.Qa(),a.target)&&a.relatedTarget&&a.relatedTarget.focus()};p.nUb=function(a){27==a.keyCode?this.close():37==a.keyCode||38==a.keyCode?0!=this.D&&xjd(this,this.D-1,!0):39!=a.keyCode&&40!=a.keyCode||Ajd(this);a.stopPropagation()};
p.qUb=function(){var a=this.Ka("waffle-autovis-lightbox-container");Ud(a);this.H=[];wjd(this);xjd(this,this.D,!0)};p.Oob=function(){this.close();Mfd(this.F[this.D],2256)};p.pUb=function(){0!=this.D&&xjd(this,this.D-1,!0);0==this.D&&this.J.Qa().focus()};p.oUb=function(){Ajd(this);this.D==this.F.length-1&&this.L.Qa().focus()};function Ajd(a){a.D!=a.F.length-1&&xjd(a,a.D+1,!0)}p.close=function(){this.dispose()};p.Gd=function(){ujd.qa.Gd.call(this);var a=this.F[this.D];a&&a.Qa()&&a.Qa().focus()};function Bjd(a,b,c,d,e,f,h){dT.call(this,h);this.Vb=a;this.Rd=b.C;this.jg=zK(b);this.Na=c;this.tf=d;this.J=f;this.Mf=e;this.Ra=new ojd(b,c,d,f,this.va());this.Ha(this.Ra);this.ma=new SW(!1,"#4285f4");this.Ha(this.ma);this.oa=null;this.Fd=this.ud=!1;this.yc=!0;this.Jb=pq();this.pb=this.gb="";this.Wc=null;this.Ua=Pm(new Om,10).build()}w(Bjd,dT);p=Bjd.prototype;p.Ea=function(){Bjd.qa.Ea.call(this);this.mb(N(Cjd,{WL:this.jg}))};
p.Ja=function(){Bjd.qa.Ja.call(this);var a=this.Ka("waffle-assistant-quicksum-panel");this.Ra.Wa(a);a=this.Ka("waffle-assistant-spinner-container");this.ma.render(a);a=this.Vb.C;this.getHandler().V(this,"close-sidebar",this.jja).V(a,"recommender-load-started",this.aja).V(a,"recommender-load-ended",this.$ia).V(a,"recommender-calc-started",this.Cia).V(a,"recommender-calc-ended",this.Bia).V(this.Ka("waffle-assistant-scroll-pane"),"scroll",xYc(this.H$,10,this));a=Urb.isEnabled();this.G$(!a)};
p.resize=function(){var a=this.Ka("waffle-assistant-sidepane-content");a=wl(a).height;var b=this.Ka("waffle-assistant-spinner-container");cl(b,"margin-top",a/2-16+"px");this.H$()};p.rf=ua;function Djd(a,b){var c=Ejd(a);0!=c.length&&(A(a.oa),c=c.filter(function(a){return a instanceof N_}),b=c.indexOf(b),0<c.length&&-1!=b&&(a.oa=new ujd(c,b,a.Mf,a.J,a.va()),a.oa.render(),a.Ba(a.oa),vjd(a.oa,a.Fd)))}
p.G$=function(a){this.Fd=a;Sk(this.Qa(),"waffle-assistant-readonly",a);var b=this.Ra;b.R=a;b.C&&(b.C.D=a);Sk(b.Qa(),"waffle-assistant-quicksum-panel-readonly",a);this.oa&&!this.oa.isDisposed()&&vjd(this.oa,a)};
p.setVisible=function(a){var b=this.isVisible();Bjd.qa.setVisible.call(this,a);if(a&&!b){var c=FXc(this.Vb.C,a);c?(b=new yed,G(b,1,mB(c,"r")),G(b,2,mB(c,"c")),G(b,3,c.Zg()),c=new Lm,xf(c,4,b),b=Sm(Kwa(this.Ua),c).build()):b=this.Ua;this.pb=qq(this.Jb,"sett",!1,b);this.ma.setActive(!0);Fjd(this)}a||Gjd(this,!0)};p.aja=function(){this.isVisible()&&(Gjd(this,!0),this.ma.setActive(!0))};p.$ia=function(){this.isVisible()&&this.ma.setActive(!1)};
p.Cia=function(a){this.isVisible()&&(this.J.C(2775,this.Ua),Gjd(this,void 0,a.C,a.F),Hjd(this)||this.ma.setActive(!0),Fjd(this),this.yc=!1)};
p.Bia=function(a){if(this.isVisible()){this.J.C(2776,this.Ua);var b=a.C;0<b.length&&(this.gb=qq(this.Jb,"serr"));Gjd(this,!1);this.ma.setActive(!1);a=a.F;var c=VV(this.Vb.C),d=this.Ga.C.getActiveGrid();c=!!c&&!!d&&c.jb()!=d.jb();d=ia(this.D);for(var e=d.next();!e.done;e=d.next()){e=e.value;for(var f=[],h=ia(b),k=h.next();!k.done;k=h.next()){k=k.value;var l=Gx(k,1),m;if(!(m=!e.lU(l))&&(m=c)){a:switch(l){case 2:case 4:case 6:l=!1;break a;default:l=!0}m=!l}m||f.push(k)}0<f.length?e.lM(f,a):e.mM(!0)}b=
ia(b);for(a=b.next();!a.done;a=b.next())if(a=a.value,5==Gx(a,1)){this.E1();this.Sa=V(a,12);this.H=aW(a);this.La=V(a,11);Ijd(this);a=this.H;c=!1;for(d=this.Ya.length-1;0<=d;d--)Djb(this.Ya[d],a)&&(c=!0,this.Ya.splice(d,1));this.Ya.push(a);a=c;2!=this.Sa||a||Jjd(this,!0)}b=Ejd(this);0<b.length&&this.ud&&(b[b.length-1].Sc=!0);this.ud=!1;Fjd(this);Kjd(this);this.H$()}};
function Fjd(a){var b=Hjd(a),c=Dl(a.Ka("waffle-assistant-quicksum-panel")),d=a.ma.yb();b=b||c||d;c=a.Ka("waffle-assistant-empty-list");K(c,!b);K(a.ma.Qa(),b)}p.Ic=ua;p.Sna=ua;p.Md=g("Fd");p.jja=ua;p.QEb=function(){""!=this.gb&&(rq(this.Jb,this.gb),this.gb="");""!=this.pb&&(rq(this.Jb,this.pb),this.pb="");this.Wc=Ea();this.yc||(this.J.C(2777,this.Ua),this.yc=!0)};function Cjd(a,b,c){b=c||b;a=a||{};c=P;var d=Vs('<div class="waffle-assistant-replaceable-title">'+Ljd(null,b)+"</div>");var e=e=a||{};var f='<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content" aria-live="polite">'+O(zsc({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div class="waffle-assistant-empty-list-title">';f+='Get insights instantly</div><div class="waffle-assistant-empty-list-body">';f=e.WL?f+"To see answers, formatting, and charts in a single click, try adding more data or selecting different cells in your spreadsheet.":
f+"To see formatting and charts in a single click, try adding more data or selecting different cells in your spreadsheet.";e=P(f+'</div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try it out</a></div></div></div>');e=P('<div class="waffle-sidebar-tables-bar" style="display: none"><div class="waffle-assistant-sidepane-tables-range"></div><div class="waffle-assistant-tables-edit-range-button">Edit'+
('</div></div><div class="waffle-assistant-scroll-pane"><div class="waffle-assistant-scroll-pane-content"><div class="waffle-assistant-scroll-pane-feature-content">'+e+'<div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-quicksum-panel" style="display: none"></div><div class="waffle-assistant-features"></div></div><div class="waffle-assistant-expanded-panel" style="display: none"></div></div></div>'));return c(O(eT(Rs({title:d,Mk:Vs(""+e),id:Us("autovis"),fH:Us("waffle-assistant-sidepanel"),
d$:Us("waffle-assistant-title"),EU:Us("waffle-assistant-sidepane-content")},a),b)))}function Ljd(){return P('<div class="waffle-assistant-title-bar"><div class="waffle-assistant-title-icon">'+O(zsc({color:"#ffffff",iconSize:"21"}))+'</div><div class="waffle-assistant-title-text">'+O("Explore")+"</div></div>")};function Mjd(a,b,c){a=P;b=""+O(Kt({Jd:"waffle-assistant-datavalidation-apply-button",content:Us("Apply"),style:4},c||b));b=P(b);return a('<div class="waffle-assistant-datavalidation-rule-group"><div class="waffle-assistant-datavalidation-details"></div><div class="waffle-assistant-datavalidation-description"></div>'+b+"</div>")}function Njd(a){return P('<div class="waffle-assistant-datavalidation-detail-chip">'+O(a.L1a)+"</div>")};function Ojd(a,b,c,d){K_.call(this,a,d);this.D=new NY(b,"waffle-assistant-highlight-styled-border","waffle-assistant-highlight-styled-rect");this.Ba(this.D);this.C=new Lt("",this.va());this.Ha(this.C);this.F=aW(a);this.J=c}r(Ojd,K_);p=Ojd.prototype;p.Ea=function(){K_.prototype.Ea.call(this);L_(this).appendChild(N(Mjd))};
p.Ja=function(){K_.prototype.Ja.call(this);var a=this.Ka("waffle-assistant-datavalidation-apply-button");this.C.Wa(a);H_(a,"Apply data validation");this.getHandler().V(this.C,"action",this.Zfb).V(this.Qa(),"mouseenter",this.GFb).V(this.Qa(),"mouseleave",this.HFb);a=new dk;hXc(a,W6c(kA(V(V(this.H,13),3))));var b=new bk;xf(b,58,a);a=Qm(Pm(new Om,10),b).build();this.J.C(35577,a)};
p.Mx=function(a){var b=cK(yB(this.F)),c=V(V(this.H,13),3);switch(kA(c)){case 14:var d="Email validation";c=["Is valid email"];break;case 15:d="URL validation";c=["Is valid URL"];break;case 30:d="Date validation";c=["Is valid date"];break;case 24:d="List of items";c=lA(c).map(function(a){return V(a.Co().getValue(),2)});break;case 1:d="Numeric validation";c=["Greater than "+V(lA(c)[0].Co().getValue(),3)];break;case 7:d="Numeric validation";c=lA(c);c=["Between "+(V(c[0].Co().getValue(),3)+(" and "+V(c[1].Co().getValue(),
3)))];break;case 5:d="Numeric validation";c=lA(c);c=["Equal to "+V(c[0].Co().getValue(),3)];break;default:d="unrecognized",c=[]}var e=new lr,f=e.text(d)+(" for "+(e.Ae("SPAN".toString(),{PD:"waffle-assistant-datavalidation-range"})+e.text(b)+e.De("SPAN".toString())));hd(this.Ka("waffle-assistant-datavalidation-description"),e.format(f));var h=this.Ka("waffle-assistant-datavalidation-details");x(c,function(a){a=N(Njd,{L1a:a});h.appendChild(a)});b="Suggested data validation: "+(d+(" "+(c.join()+(" for "+
b))));Ik(this.Qa(),b);a()};p.Jx=ba();p.Gy=n("assistantDataValidationFeedback");p.gB=n(35551);p.fB=n(35550);p.Zfb=function(){this.dispatchEvent(new I_("Re",this,35549))};p.GFb=function(){OY(this.D,xB(this.F))};p.HFb=function(){PY(this.D)};function Pjd(a,b,c,d,e){gu.call(this,a,c,d,e,void 0,void 0,!0);this.L=b}w(Pjd,gu);Pjd.prototype.Ea=function(){Pjd.qa.Ea.call(this);J(this.Qa(),"waffle-assistant-toast");Sk(this.Qa(),"waffle-assistant-toast-companion",0<uu(this.L));J(this.Ka("docs-ui-toast-content"),"waffle-assistant-toast-content")};Pjd.prototype.Zs=function(a,b,c){c=c?c:"waffle-assistant-toast-action";b=Ol(this,b);Pjd.qa.Zs.call(this,a,b,c)};
function Qjd(a,b){a.Zs("Undo","w-a-u-tm-u",void 0);var c=Vl(a,"w-a-u-tm-u");a.getHandler().og(c,Me,u(function(){this.setVisible(!1);b()},a))};function Rjd(a,b){z.call(this);this.D=a;this.F=b||new tu;this.C=null}w(Rjd,z);Rjd.prototype.clear=function(){this.C&&(lu(this.D,this.C),this.C.setVisible(!1),this.C.dispose(),this.C=null)};function Jhd(a,b,c,d){a.clear();a.C=new Pjd(b,a.F,c,!1,5E3);a.C.render();d&&Qjd(a.C,d);a.C.setVisible(!0);a.C.getElement().focus();ku(a.D,a.C)}Rjd.prototype.Ia=function(){Rjd.qa.Ia.call(this);this.clear()};function Sjd(a,b,c,d){Q_.call(this,1,b,a,d);this.D=c}r(Sjd,Q_);p=Sjd.prototype;p.getTitle=n("Data Validation");p.lU=function(a){return 6==a};p.tN=function(a){var b=V(a,1);switch(b){case 6:return new Ojd(a,this.D,this.R,this.va());default:throw Error("Unsupported recommendation type: "+b);}};p.nM=function(a){Q_.prototype.nM.call(this,a);this.setVisible(!a)};p.q0=function(a){return this.Md()?(this.setVisible(!1),a):Q_.prototype.q0.call(this,a)};p.p0=n(4);function Tjd(a,b,c){a='<div class="waffle-assistant-banding-recommendation"><div class="waffle-assistant-banding-color-picker-container"></div><div class="waffle-assistant-banding-range-wrapper">Alternating colors for '+('<span class="waffle-assistant-banding-range"></span></div>'+Ujd(c||b)+"</div>");return P(a)}
function Vjd(a,b,c){return P('<div class="waffle-assistant-conditionalformat-rule-group"><div class="waffle-assistant-conditionalformat-rule-holder" tabindex="0"></div><div class="waffle-assistant-conditionalformat-description"></div>'+Ujd(c||b)+"</div>")}function Ujd(a){a=""+O(Kt({Jd:"waffle-assistant-formatting-edit-button",content:Us("Edit"),style:4},a));return P(a)};function Wjd(a,b,c){K_.call(this,a,c);a=Wa(Fx(this.H,7),Y6c);this.C=new c7c(!1,a,7);this.Ha(this.C);this.J=new Lt("",this.va());this.Ha(this.J);this.L=b;this.F=!1;this.D=-1}w(Wjd,K_);var Xjd={nSa:"waffle-assistant-banding-color-picker-container",Eaa:"waffle-assistant-formatting-edit-button",pD:"waffle-assistant-banding-range"};p=Wjd.prototype;p.Ea=function(){Wjd.qa.Ea.call(this);L_(this).appendChild(N(Tjd))};
p.Ja=function(){Wjd.qa.Ja.call(this);this.getHandler().V(this.J,"action",this.vlb).V(this.C,"ke",this.Agb);this.L.C(2768)};p.Mx=function(a){var b=this.Ka(Xjd.nSa);this.C.render(b);d7c(this.C);b=this.Ka(Xjd.pD);var c=aW(this.H),d=yB(c);ge(b,cK(d));Yjd(this,c);b=this.Ka(Xjd.Eaa);this.J.Wa(b);a()};p.Jx=function(){Ik(this.Qa(),"Suggested alternating background colors");vn(this.C,"Choose a color scheme")};p.Gy=n("assistantBandingFeedback");p.gB=n(2672);p.fB=n(2671);
p.vlb=function(a){YH.dispatchEvent({type:"show-banding-pane-recommendation",iMa:this.H,u1a:f7c(this.C)});a.stopPropagation()};p.Agb=function(a){if(!this.F&&e7c(this.C)){var b=this.D;this.D=this.C.$g();this.D==b?this.dispatchEvent(new I_("Xe",this,2797)):this.dispatchEvent(new I_("Pe",this,2673));a.stopPropagation()}};
function Yjd(a,b){a.F=!0;var c=b.jb();b=yB(b);c=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(c,b.rc(),b.qc(),b.Zc(),b.ad(),7,!1);c.length?(c=ritz_api.RitzModelApi.getBandedRangeByWorkbookRangeId(c[0]),c=(new Fz).yd(JA.Ca(),c),c=Y6c(c)):c=null;c?(c=g7c(a.C,c),UR(a.C,c?c.getElement():null)):UR(a.C,null);a.D=a.C.$g();a.F=!1};function Zjd(a,b){K_.call(this,a,b);this.C=new Lt("",this.va());this.Ha(this.C);this.yc=Fx(a,6)}w(Zjd,K_);var q0={Eaa:"waffle-assistant-formatting-edit-button",STa:"waffle-assistant-conditionalformat-format-preview",PWa:"waffle-assistant-conditionalformat-rule-holder",D0:"waffle-assistant-conditionalformat-description",LVa:"one-rule",rYa:"two-rules",fYa:"three-rules",pWa:"waffle-assistant-conditionalformat-format-preview-label"};p=Zjd.prototype;p.Ea=function(){Zjd.qa.Ea.call(this);L_(this).appendChild(N(Vjd))};
p.Ja=function(){Zjd.qa.Ja.call(this);var a=this.Ka(q0.Eaa);this.C.Wa(a);H_(a,"Apply and edit conditional format rules");this.getHandler().V(this.C,"action",this.Xfb)};p.Mx=function(a){ge(this.Ka(q0.D0),Gx(this.H,3));var b=this.Ka(q0.PWa),c=new $jd(this,this.va());this.Ha(c);c.Wa(b);H_(b,"Apply conditional format rules");a()};p.Jx=ua;p.Gy=n("assistantConditionalFormatFeedback");p.gB=n(2630);p.fB=n(2629);
p.Xfb=function(){this.dispatchEvent(new I_("Qe",this,2563));this.dispatchEvent(new I_("Te",this,2670,void 0,void 0,yB(V(this.yc[0],1,0))));dBb()};function $jd(a,b){tn.call(this,void 0,void 0,b);this.C=a}w($jd,tn);
$jd.prototype.Qc=function(a){$jd.qa.Qc.call(this,a);var b=this.C.yc;switch(b.length){case 0:break;case 1:var c=q0.LVa;break;case 2:case 4:c=q0.rYa;break;default:c=q0.fYa}for(var d=0;d<b.length;d++){var e=b[d],f=Od("DIV");Lk(f,[q0.STa,c]);var h=Od("DIV");J(h,q0.pWa);f.appendChild(h);ge(h,"123");if(Bx(e,2)){var k=V(V(e,2),1);switch(kA(oA(k))){case 9:case 13:k=lA(oA(k))[0];var l=Fx(e,1)[0];ge(h,GI(k,l.Ff(),Gx(l,2),Gx(l,4)))}}p7c(e,f);a.appendChild(f)}};
$jd.prototype.Kg=function(){var a=this.C;a.dispatchEvent(new I_("Qe",a,2563));return!0};function akd(a,b,c){Q_.call(this,2,b,a,c)}w(akd,Q_);p=akd.prototype;p.getTitle=n("Formatting");p.lU=function(a){return I(H(),"feecfr")&&2==a||4==a};p.tN=function(a){var b=V(a,1);switch(b){case 2:return new Zjd(a,this.va());case 4:return a=new Wjd(a,this.R,this.va()),this.getHandler().V(a,"Pe",this.DQb).V(a,"Xe",this.VBb),a;default:throw Error("Unsupported recommendation type: "+b);}};p.DQb=function(a){Jhd(this.Sa,"Alternating colors applied",this.va(),u(this.Bgb,this,a.C))};p.VBb=function(){this.Sa.clear()};
p.Bgb=function(a){this.dispatchEvent(new I_("bf",a,2796))};p.nM=function(a){akd.qa.nM.call(this,a);this.setVisible(!a)};p.q0=function(a){return this.Md()?(this.setVisible(!1),a):akd.qa.q0.call(this,a)};p.p0=n(3);function bkd(a,b,c,d,e,f,h,k,l,m,q){K_.call(this,l,q);this.Na=b;this.Ya=c;this.Da=d;this.$a=m;this.ma=e;this.Sa=h;this.J=new Wr("",new E_,this.va());this.Ha(this.J);this.oa=new Wr("",new E_,this.va());this.Ha(this.oa);this.C=this.L=this.D=null;this.Ua=this.Ya.L.C;this.R=Pm(new Om,66).build();this.Oa=f;this.Aa=new NY(f,"waffle-assistant-highlight-styled-border","waffle-assistant-highlight-styled-rect");this.Ba(this.Aa);this.fb=Fx(l,4);this.F=null}r(bkd,K_);p=bkd.prototype;p.$z=n(!0);
p.Ea=function(){K_.prototype.Ea.call(this);L_(this).appendChild(N(Aed));M_(this).appendChild(N(Bed))};p.Ja=function(){K_.prototype.Ja.call(this);var a=V(this.H,5),b=u6c(this.Sa,a),c=HK(this.Na).kc();this.L=new x6c(b,a,this.Ua,this.$a,c,this.Da);a=this.Ka("waffle-assistant-insert-pivottable-button");this.J.Wa(a);H_(a,"Insert Pivot Table");a=this.Ka("waffle-assistant-zoom-button");this.oa.Wa(a);H_(a,"Preview Pivot Table");this.getHandler().V(this.J,"action",this.IFb).V(this.oa,"action",this.lJa);this.Xs(this.Md())};
p.Mx=function(a){var b=this.va();b.Me(this.Ka("waffle-assistant-answercard-interpret"),Gx(this.H,3));this.C=b.Ea("CANVAS","waffle-pivottable-pivot-canvas");b.Rj(this.C,!0);Ik(this.C,"Pivot table canvas");var c=this.Ka("waffle-assistant-answercard-pivot-content");b.appendChild(c,this.C);b=V(this.H,5);this.F=new vhd(c,this.Oa,this.Na,this.Da);this.F.J=b;c=this.Md();this.F.D=c;this.getHandler().og(this.C,Me,this.lJa).V(this.C,"mousedown",this.Xla).Rc(this.F,"pivot_inserted",this.JFb);z6c(this.L,this.C);
a()};p.JFb=ba();p.Xs=function(a){K_.prototype.Xs.call(this,a);if(this.J&&this.sb()){this.J.setVisible(!a);var b=this.va().Ka("waffle-assistant-button-separator",M_(this));K(b,!a)}this.D&&ied(this.D,this.Md());this.F&&(a=this.Md(),this.F.D=a)};p.Jx=function(){Ik(this.Qa(),"Suggested Pivot Table-"+Gx(this.H,3))};p.Gy=n("assistantPivotTableFeedback");p.gB=n(2632);p.fB=n(2631);p.IFb=function(){y6c(this.L);this.dispatchEvent("close-sidebar");this.ma.C(35619,this.R)};
p.lJa=function(){this.ma.C(35620,this.R);this.getHandler().Hc(this.D,"ce",this.Xla).Hc(this.D,"de",this.kJa);A(this.D);this.D=new B6c(this.L,Gx(this.H,3),this.ma,this.R,35621,this.va());this.getHandler().V(this.D,"ce",this.Xla).V(this.D,"de",this.kJa);this.D.render();this.Ba(this.D);ied(this.D,this.Md())};p.Xla=function(){this.C&&this.C.focus()};p.kJa=function(){this.dispatchEvent("close-sidebar")};p.mK=function(){K_.prototype.mK.call(this);hed(this.Aa,$V(this.fb))};
p.DF=function(){K_.prototype.DF.call(this);PY(this.Aa)};function ckd(a,b,c,d,e,f,h,k,l){Q_.call(this,1,f,e,l);this.H=d;this.Da=b;this.Ga=c;this.F=h;this.La=k;this.J=Pm(new Om,10).build();a=new luc(a,!0,!0);this.O=new t6c(a);this.D=null}r(ckd,Q_);p=ckd.prototype;p.getTitle=n("Pivot Table");p.lU=function(a){return 1==a};p.tN=function(a){var b=V(a,1);switch(b){case 1:return new bkd(this.D,this.Da,this.Ga,this.H,this.R,this.F,this.O,this.J,a,this.La,this.va());default:throw Error("Unsupported recommendation type: "+b);}};
p.lM=function(a,b){V(a[0],5)&&(this.D=b?b:null,Q_.prototype.lM.call(this,a,b))};p.p0=n(5);function r0(a,b,c,d,e){M.call(this);this.O=a;this.Ua=b;this.Na=c;this.J=d;this.C=e}r(r0,M);r0.prototype.getTableRange=g("Na");r0.prototype.I7=function(a,b,c){this.Na=a;this.J=b;this.C=c};r0.prototype.Ja=function(){M.prototype.Ja.call(this);this.getHandler().V(this.O.C,"eb",this.Ya)};r0.prototype.Ya=function(){this.Ua.Ob()};function dkd(a,b,c,d){d=void 0===d?!1:d;I_.call(this,"Ze",null,2859);this.Ga=a;this.ma=b;this.F=c;this.R=!!d}r(dkd,I_);dkd.prototype.getTableRange=g("Ga");function ekd(a,b){z.call(this);this.F=a;this.H=b;this.C=new NY(a,"waffle-assistant-table-range-border","waffle-assistant-table-range-rect");this.Ba(this.C);this.D=new NY(a,"waffle-assistant-header-range-border","waffle-assistant-header-range-rect");this.Ba(this.D)}r(ekd,z);ekd.prototype.Ia=function(){PY(this.C);PY(this.D);z.prototype.Ia.call(this)};
function fkd(a,b,c,d,e,f){JN(b);var h=yB(d);h=new XA(h.rc(),h.qc(),Math.min(h.Zc(),h.rc()+6),Math.min(h.ad(),h.qc()+6));var k=IN(b),l=nI(a.F).D,m=DN(l,new Pw(h.rc(),h.Zc()),"r",!0,!1,!0,!0)-1,q=DN(l,new Pw(h.qc(),h.ad()),"c",!0,!1,!0,!0)-1;l.Ub()&&--q;m=Math.min(200,m);q=Math.min(c.offsetWidth-2,q);KN(b,k,q,m);c=Efd(d,e,f);a.H.render(b,h,c);b=a.C;h=d.rc();k=d.qc();switch(e){case 0:h=Math.min(d.Zc(),d.rc()+f);break;case 1:k=Math.min(d.ad(),d.qc()+f)}d=rB(d.jb(),h,k,d.Zc(),d.ad());OY(b,xB(d));OY(a.D,
xB(c))};function gkd(a){var b=a.zLa,c=a.yLa,d=a.$Ja;a=a.Sua;return P('<div class="waffle-sidebar-overlay"><div class="waffle-tables-popup" aria-label="'+Q(b)+'"><div class="waffle-tables-popup-header"><div class="waffle-tables-popup-title">'+O(b)+'</div></div><div class="waffle-tables-popup-content">'+O(c)+'<div class="waffle-assistant-canvas-container"><canvas class="waffle-assistant-table-canvas"></canvas></div></div><div class="waffle-tables-popup-buttons"><div class="waffle-tables-popup-button waffle-tables-popup-done">'+
O(d)+'</div><div class="waffle-tables-popup-button waffle-tables-popup-cancel">'+O(a)+"</div></div></div></div>")}
function hkd(){var a=Us("Edit data range");var b=P('<div class="waffle-assistant-tables-recommendation"><div class="waffle-assistant-table-range-container"><div class="waffle-assistant-tables-range-wrapper waffle-assistant-tables-data-range-wrapper"><label id="waffle-assistant-tables-data-range-label">Data Range</label><div class="waffle-assistant-tables-edit-sheet-button"></div></div><div class="waffle-assistant-tables-range-error" style="display:none">Invalid range</div></div><div class="waffle-assistant-header-range-container"><div class="waffle-assistant-tables-range-wrapper"><div class="waffle-assistant-tables-edit-headers-button"></div></div></div></div>');a=
""+gkd({zLa:a,yLa:Vs(""+b),$Ja:Us("Update"),Sua:Us("Cancel")});return P(a)}function ikd(){var a=""+gkd({zLa:Us("Improve suggestions"),yLa:Vs('<div class="waffle-tables-popup-header-message"></div>'),$Ja:Us("No"),Sua:Us("Yes")});return P(a)}function jkd(a){a='<div class="waffle-tables-bar-content">For <span class="waffle-assistant-table-bar-range">'+(O(a.Dx)+"</span></div>");return P(a)}
function kkd(a){a='Is <span class="waffle-assistant-table-first-header">'+(O(a.rK)+"</span> a header row, containing titles that describe the columns below?");return P(a)};function lkd(a,b,c,d,e,f,h){r0.call(this,a,qxb,d,e,f);this.D=(new $n).build();this.Ba(this.D);this.H=new Wr("",new E_,this.va());this.Ha(this.H);Gm(this.D,this.H,rxb);this.F=new Wr("",new E_,this.va());this.Ha(this.F);Gm(this.D,this.F,qxb);this.R=new ekd(b,c);this.Ba(this.R);this.L=new xe(this);this.Ba(this.L);this.oa=h}r(lkd,r0);lkd.prototype.Ea=function(){this.mb(N(ikd))};
lkd.prototype.Ja=function(){r0.prototype.Ja.call(this);this.H.Wa(this.Ka("waffle-tables-popup-done"));this.F.Wa(this.Ka("waffle-tables-popup-cancel"));var a=Efd(this.getTableRange(),this.C,1);a=cK(yB(a));a=N(kkd,{rK:a});this.Ka("waffle-tables-popup-header-message").appendChild(a);this.L.subscribe(rxb,"action",this.Aa).subscribe(qxb,"action",this.ma);a=this.Ka("waffle-assistant-table-canvas");var b=this.Ka("waffle-assistant-canvas-container");fkd(this.R,a,b,this.getTableRange(),this.C,this.J);a=this.Ka("waffle-tables-popup");
Sk(a,"waffle-tables-popup-answers-enabled",this.oa);b=new gP(a,this.va());this.Ba(b);hP(b);a.focus()};lkd.prototype.ma=function(){this.dispatchEvent("$e")};lkd.prototype.Aa=function(){var a=yB(this.getTableRange());switch(this.C){case 0:a=YA(a.top+1,a.left,a.top+a.height,a.left+a.width);break;case 1:a=YA(a.top,a.left+1,a.top+a.height,a.left+a.width)}var b=this.J-1,c=this.getTableRange().Ff();this.dispatchEvent(new dkd(new qB(c,a),b,this.C));this.dispatchEvent("$e")};function mkd(a,b,c,d,e,f,h,k,l,m){r0.call(this,a,lxb,d,e,f);var q=this;this.La=m;this.$a=b;this.Ga=d;this.kb=e;this.pb=f;a=yB(d);this.H=cK(a);this.L=d.Ff();this.Sa=new ekd(b,c);this.Ba(this.Sa);this.F=this.D=null;this.oa=h;this.R=(new $n).build();this.Ba(this.R);this.Da=new Wr("",new E_,this.va());this.Ha(this.Da);Gm(this.R,this.Da,nxb);this.Aa=new Wr("",new E_,this.va());this.Ha(this.Aa);Gm(this.R,this.Aa,lxb);b=this.O.C.C.ze();this.ma=new jT(this.$a,function(a,b,c){nkd(q,a,b,c)},!1,"e.g., A2:D5",
!0,b,this.va());this.Ha(this.ma);this.Oa=null;this.Ra=new xe(this);this.Ba(this.Ra);this.fb=k;this.gb=l}r(mkd,r0);p=mkd.prototype;p.Ea=function(){this.mb(N(hkd))};
p.Ja=function(){r0.prototype.Ja.call(this);this.Da.Wa(this.Ka("waffle-tables-popup-done"));this.Aa.Wa(this.Ka("waffle-tables-popup-cancel"));this.ma.render(this.Ka("waffle-assistant-tables-data-range-wrapper"));var a=this.Ka("waffle-range-selection-input");Fk(a,"labelledby","waffle-assistant-tables-data-range-label");this.getHandler().V(a,"keydown",this.OFb).V(a,"keyup",this.PFb).V(a,"focusout",this.Bzb).V(this.O.C,"ob",this.RFb).V(this.ma,"change",this.QFb);this.Ra.subscribe(nxb,"action",this.SFb).subscribe(lxb,
"action",this.bhb);okd(this);a=this.Ka("waffle-tables-popup");Sk(a,"waffle-tables-popup-answers-enabled",this.gb);var b=new gP(a,this.va());this.Ba(b);hP(b);a.focus()};p.Ia=function(){A(this.Oa);r0.prototype.Ia.call(this)};function nkd(a,b,c,d){IK(a.fb,null,b,c,d,!1,void 0,function(b){a.Oa=b})}p.RFb=function(){for(var a=this.O.C,b=!0,c=ia(XGb(a)),d=c.next();!d.done;d=c.next())if((d=d.value)&&d.jb()==this.L){b=!1;break}b&&qa(TJ(a))&&(this.L=TJ(a),pkd(this,this.L));qkd(this)};
function rkd(a){var b=a.Ka("waffle-assistant-table-canvas"),c=a.Ka("waffle-assistant-canvas-container");fkd(a.Sa,b,c,a.getTableRange(),a.C,a.J)}p.bhb=function(){this.dispatchEvent("$e")};
p.SFb=function(){var a=!OGb.test(this.H);K(this.ib("waffle-assistant-tables-range-error"),a);Sk(this.Ka("waffle-assistant-tables-data-range-wrapper"),"waffle-assistant-tables-range-error-input",a);if(!a){a=this.kb!=this.J||this.pb!=this.C;var b=!zB(this.Ga,this.getTableRange()),c=this.Ga.jb()!=this.getTableRange().jb();if(a||b)a&&this.oa.C(35506),b&&this.oa.C(35507),c&&this.oa.C(35723),this.dispatchEvent(new dkd(xB(this.getTableRange()),this.J,this.C,c));this.dispatchEvent("$e")}};
function okd(a){var b=a.Ka("waffle-range-selection-input"),c=yB(a.Ga);a.H=cK(c);b.value=a.H;qkd(a);skd(a);rkd(a)}p.I7=function(a,b,c){r0.prototype.I7.call(this,a,b,c);rkd(this)};function tkd(a){var b=MK(a.O.C,a.L),c=b.kc(),d=SGb(a.H,b),e=null!=d;e&&(b=YBb(b,d),e=oB(b))&&(c=l_c(uB(b,c)),a.I7(c,ukd(a,c),a.C),qkd(a),skd(a));K(a.ib("waffle-assistant-tables-range-error"),!e)}function ukd(a,b){b=vkd(b,a.C);return a.J>b?b:a.J}
function vkd(a,b){a=0==b?Gx(a,3)-Gx(a,2):Gx(a,5)-Gx(a,4);return 0==a?3:Math.min(a-1,3)}function qkd(a){if(a.La){K(me(a.va(),"waffle-assistant-tables-data-range-label"),!1);A(a.F);a.F=new gT;a.F.setContent("Data Range");a.Ha(a.F);Gm(a.R,a.F,oxb);a.F.render(a.Ka("waffle-assistant-tables-edit-sheet-button"));a.getHandler().V(a.F,"action",a.Oxb);for(var b=0,c=ia(XGb(a.O.C)),d=c.next();!d.done;d=c.next())if(d=d.value)d.jb()===a.L&&(b=a.F.Kh()),a.F.kd(new Kn(d.ze(),d.jb()));a.F.Se(b)}}
function skd(a){A(a.D);a.D=new gT;a.Ha(a.D);Gm(a.R,a.D,mxb);a.D.render(a.Ka("waffle-assistant-tables-edit-headers-button"));a.getHandler().V(a.D,"action",a.Onb);for(var b=vkd(a.getTableRange(),0),c=0;c<=b;c++){var d=(new $u("{NUM_HEADER_RECORDS, plural,=0 {No rows}=1 {1 row}other {# rows}}")).format({NUM_HEADER_RECORDS:c});a.D.kd(new Kn(d))}c=vkd(a.getTableRange(),1);for(d=0;d<=c;d++){var e=(new $u("{NUM_HEADER_RECORDS, plural,=0 {No columns}=1 {1 column}other {# columns}}")).format({NUM_HEADER_RECORDS:d});
a.D.kd(new Kn(e))}c=a.J;a.D.Se(0==a.C?c:c+b+1);a.D.setContent("Headers")}p.Bzb=function(){var a=this.Ka("waffle-range-selection-input");this.H!=a.value&&(this.H=a.value,tkd(this))};p.QFb=function(){var a=this.ma.getValue();this.H=a;var b=this.Ka("waffle-range-selection-input");b.value=a;b.select();tkd(this)};p.Oxb=function(){var a=this.F.getValue();a!=this.L&&(this.L=a,pkd(this,this.L));tkd(this)};
function pkd(a,b){if(a.La){var c=MK(a.O.C,b),d=cB(wJ(c));ritz_api.TablesApi.getTables(wB(uB(d,b)),function(b){if(b.length){var c=b[0];b=c.getDimensionTableAccessor().getHeaderRange();var e=yB(LT(b));b=c.getDimensionTableAccessor().getDimensionTagName();e=mB(e,0==b?"r":"c");c=yB(LT(c.getTableRange()))}else c=d,b=e=0;a.C=b;a.J=e;b=cK(c);a.H=b;b=a.Ka("waffle-range-selection-input");b.value=a.H;b.select();tkd(a)})}}
p.OFb=function(a){var b=this.Ka("waffle-range-selection-input");switch(a.keyCode){case 13:a.stopPropagation();a.preventDefault();this.H=b.value;tkd(this);nxb.Ob();break;case 27:a.stopPropagation(),a.preventDefault(),okd(this),lxb.Ob()}};p.PFb=function(){this.H=this.Ka("waffle-range-selection-input").value;tkd(this)};p.Onb=function(){var a=this.D.$g(),b=vkd(this.getTableRange(),0);this.I7(this.getTableRange(),a-(0==(a>b?1:0)?0:b+1),a>b?1:0)};function s0(a,b,c,d,e,f,h,k,l,m,q,t,v){Bjd.call(this,a,b,c,e,d,f,v);this.$e=q;this.xe=h;this.Ga=b;this.$a=new M(this.va());this.Ha(this.$a);this.Da=new Rjd(t);this.Ba(this.Da);this.D=[];this.F=null;this.rb=new Lt("",v,4);Dm(this.rb,2,!1);this.Ha(this.rb);this.Ne=k;this.Dg=l;this.le=m;this.H=null;this.Sa=0;this.La=null;this.Sc=new Wr("",new E_,this.va());this.Ha(this.Sc);this.bd=new M(this.va());this.Ha(this.bd);this.Xd=(new $n).build();this.Ba(this.Xd);Gm(this.Xd,this.Sc,pxb);this.Aa=this.R=null;
this.Ya=[]}w(s0,Bjd);
var t0={nD:"waffle-assistant-scroll-pane-feature-content",Z7b:"waffle-assistant-empty-list",GTa:"waffle-assistant-features",HUa:"waffle-assistant-empty-list-learn-more",fba:"waffle-assistant-expanded-panel",Isa:"waffle-assistant-replaceable-title",WWa:"waffle-assistant-scroll-pane",YXa:"waffle-assistant-sidepane-tables-range",ZXa:"waffle-sidebar-tables-bar",hta:"waffle-assistant-tables-scroll-pane",$Xa:"waffle-assistant-tables-edit-range-button",qD:"waffle-assistant-title"},wkd={defaultHelpArticleId:"6280499"};
p=s0.prototype;
p.Ja=function(){var a=this;s0.qa.Ja.call(this);this.$a.Wa(this.Ka(t0.fba));H_(this.C.Qa(),"Close");this.bd.Wa(this.Ka(t0.YXa));Ijd(this);this.Sc.Wa(this.Ka(t0.$Xa));if(zK(this.Ga)){var b=new o0(this.xe,this.Na,this.Rd,this.tf,this.J,this.Da,this.Ga,this.Dg,this.le,this.$e,this.va());this.Ha(b);this.D.push(b)}b=new akd(this.J,this.Da,this.va());this.Ha(b);this.D.push(b);I(H(),"feedvs")&&(b=new Sjd(this.J,this.Da,this.Na,this.va()),this.Ha(b),this.D.push(b));I(H(),"feepts")&&(b=new ckd(this.xe,this.Rd,
this.Ga,this.tf,this.J,this.Da,this.Na,this.$e,this.va()),this.Ha(b),this.D.push(b));b=new R_(this.Rd,this.Na,this.Mf,this.J,this.Da,this.va());this.Ha(b);this.D.push(b);var c=this.Ka(t0.GTa);x(this.D,function(b){b.render(c);a.$a.Ha(b.C,!0)});this.rb.Wa(this.Ka(t0.HUa));this.getHandler().V(this.rb,"action",this.cUb).V(this,"$e",this.E1).V(this,"Ze",this.dUb);xkd(this)};p.dUb=function(){var a=ykd(this);a&&(a.La=!0)};p.cUb=function(){(Zj(),Ii).Ob(wkd)};function Kjd(a){x(a.D,function(a){hgd(a)})}
function Gjd(a,b,c,d){x(a.D,function(a){a.mM(b,c,d)})}function Hjd(a){return!!$a(a.D,function(a){return a.wja()})}p.H$=function(){var a=this,b=this.Ka("waffle-assistant-scroll-pane").scrollTop+wl(this.Ka("waffle-assistant-sidepane-content")).height;x(this.D,function(c){a.F&&a.F!=c||(c instanceof R_&&a.getHandler().Rc(c,"Ue",a.QEb),b=c.q0(b))})};function Ejd(a){if(a.F)return a.F.C.C;var b=[];x(a.D,function(a){lb(b,ggd(a))});return b}p.G$=function(a){s0.qa.G$.call(this,a);xkd(this)};
p.rf=function(a){x(this.D,function(b){b.rf(a)})};p.Sna=function(){var a=this.Ka(t0.Isa),b=this.Ka(t0.qD);sl(b,wl(a).height)};
p.Ic=function(){var a=this,b=this.Ka(t0.nD),c=this.Ka(t0.Isa),d=this.$a.Qa();if(this.F)this.F.C.setVisible(!1),this.F.setActive(!1),this.F=null,K(d,!1),K(b,!0),Ks(c,Ljd),Gk(c,"label"),this.resize(),$H("Explore Opened");else if(this.F=$a(this.D,function(a){return a.yb()}))K(b,!1),K(d,!0),this.F.C.setVisible(!0),igd(this.F,c),Ik(c,this.F.getTitle()),b=this.F.getTitle()+" section expanded.",$H(b);this.Sna();b=new im(function(){var b=bv;b&&b.dispatchEvent("resize");a.H$()},300);this.Ba(b);b.start()};
p.setVisible=function(a){var b=this.isVisible();s0.qa.setVisible.call(this,a);a&&!b&&zkd(this,!0);a||this.Da.clear()};p.jja=function(){s0.qa.jja.call(this);this.F&&this.Ic();this.E1()};p.aja=function(){s0.qa.aja.call(this);zkd(this,!0)};p.$ia=function(){s0.qa.$ia.call(this);zkd(this,!1)};p.Cia=function(a){s0.qa.Cia.call(this,a);zkd(this,!0,a.C)};p.Bia=function(a){s0.qa.Bia.call(this,a);zkd(this,!1)};
function Akd(a,b){var c=ykd(a);if(b){uIc(a.R);var d=I(H(),"feenas");a.R=new mkd(a.Ga,a.Na,a.Ne,a.H,a.Sa,a.La,a.J,a.le,null!=c&&c.yb(),d);a.Ha(a.R);a.R.render(a.getElement())}else a.R&&(a.removeChild(a.R,!0),A(a.R),a.R=null);c&&jjd(c,b)}function Jjd(a,b){if(1!=a.La){var c=ykd(a);b?(a.Aa=new lkd(a.Ga,a.Na,a.Ne,a.H,a.Sa,a.La,null!=c&&c.yb()),a.Ha(a.Aa),a.Aa.render(a.getElement())):a.Aa&&(a.removeChild(a.Aa,!0),A(a.Aa),a.Aa=null);c&&jjd(c,b)}}function xkd(a){x(a.D,function(b){b.nM(a.Md())})}
function ykd(a){return(a=$a(a.D,function(a){return a instanceof o0}))&&a}function Bkd(a){return(a=$a(a.D,function(a){return a instanceof ckd}))&&a}function zkd(a,b,c){x(a.D,function(a){a.kQa(b,c)});b&&(a.H=null,a.Sa=0,a.La=null,a.E1(),Ijd(a))}
function Ijd(a){var b=a.Ka(t0.ZXa),c=a.Ka(t0.WWa);var d=null;var e=I(H(),"feenas"),f=VV(a.Vb.C);if(a.H||e&&f){if(a.H){var h=yB(a.H);f=a.H.Ff();e&&(d=RJ(a.Ga.C,f).ze())}else h=f.Nc().Mc(),d=f.ze(),a.H=uB(h,f.jb()),a.La=0;d=cK(h,d);d=N(jkd,{Dx:d});a=a.bd.tb();Ud(a);a.appendChild(d);K(b,!0);J(c,t0.hta)}else K(b,!1),Mk(c,t0.hta)}p.E1=function(){Akd(this,!1);Jjd(this,!1)};function Ckd(a){return P('<div class="'+Q("docs-explore-promo-icon-wrapper")+'"><div class="'+Q("docs-explore-promo-icon")+'">'+O(zsc({color:a.DCb,iconSize:"32"}))+"</div></div>")};function Dkd(a,b,c,d,e,f,h){YS.call(this,a,b,d,(Zj(),vma),e,xma,f,"docs-explore-promo",void 0,h);this.Aa=c;this.D=new Lt("",h);Dm(this.D,2,!1);this.Ha(this.D);Raa([vma,xma,uma],!0)}r(Dkd,YS);Dkd.prototype.Ea=function(){YS.prototype.Ea.call(this);var a=N(Ckd,{DCb:this.Aa});this.va().appendChild(this.Qa(),a)};Dkd.prototype.Ja=function(){YS.prototype.Ja.call(this);var a=this.Ka("docs-explore-promo-icon");Gm(this.F,this.D,(Zj(),vma));this.D.Wa(a)};Dkd.prototype.show=function(a){(Zj(),uma).Ob();this.render(a)};function Ekd(a){Dkd.call(this,"More insights, instantly","Now, Sheets Explore uses the power of pivot tables to help you better understand your data","#0F9D58","Check it out","Dismiss","waffle-assistant-entry-promo",a)}r(Ekd,Dkd);function Fkd(a,b,c,d,e,f,h,k,l,m,q,t){var v=this;kT.call(this,b,h);this.J=a;this.C=b;this.Na=c;this.Oa=d;this.Vb=e;this.O=f;this.La=k;this.F=c.C;this.gb=this.Ua=!1;this.H=null;this.Aa=l;this.Jb=t;this.yc=new Fz;this.$a=this.oa=this.L=null;a=new xK;X(a,18,!0);X(a,12,gE);this.rb=new r7c(a,5E4);this.Ga=this.Da=null;Gkd(this);Trb.Pa(!0);a=new dk;G(a,6,Hkd());b=new bk;xf(b,58,a);this.Ra=Pm(Qm(new Om,b),10).build();pq();this.Sa=-1;"true"==Bo(Do(Nd().location.href),"rEPP")&&bM(this.La,"ritz-DisplayExplorePivotPromoV2",
!0);a=new im(function(){return Ikd(v,!1)},100);this.Ba(a);a.start()}w(Fkd,kT);
function Gkd(a){var b=bJ(a.Vb);a.Ma.V(a.Oa,"selectionChange",a.gUb).V(a.F,"eb",a.eUb).V(a.F,"ob",a.iUb).V(b,"zb",a.LEa).V(b,"oc",a.HDa).V(a.C,"Re",a.agb).V(a.C,"Qe",a.$fb).V(a.C,"Pe",a.Yfb).V(a.C,"Xe",a.wvb).V(a.C,"Te",a.shb).V(a.C,"Ve",a.fUb).V(a.C,"We",a.Pob).V(a.C,"af",a.Nyb).V(a.C,"Ye",a.jxb).V(a.C,"Se",a.zgb).V(a.C,"bf",a.jUb).V(a.J.C,"recommender-confidence-update",a.Sib).V(a.C,"Ze",a.hUb);a.ma.xb(Urb,Ma,a.Wob).subscribe(Wrb,"action",a.wgb).subscribe(Vrb,"action",a.ryb).subscribe(Nrb,"action",
a.Kma).subscribe(hF,"action",a.Asb).subscribe(pxb,"action",a.Hyb).subscribe(rvb,"action",a.v5)}p=Fkd.prototype;p.Ag=function(){return Xrb};p.Zr=function(){return Yrb};p.Nv=function(a){Fkd.qa.Nv.call(this,a);Vrb.Pa(a);Ikd(this,!1);!this.Ua&&a&&(this.Ua=!0);su(this.Jb,{Oc:a});a||(this.C.Ic(),(a=Bkd(this.C))&&a.isVisible()&&aed(this.La)&&bM(this.La,"ritz-DisplayExplorePivotPromoV2",!1))};p.zX=function(a){var b=this;this.C.Sna();var c=new im(function(){Fkd.qa.zX.call(b,a)},300);this.Ba(c);c.start()};
p.v5=function(){Fkd.qa.v5.call(this);Jkd(this,!1)};p.rf=function(a){this.C.rf(a);this.J.rf(a)};p.agb=function(a){var b=a.C.H,c=V(V(b,13),3);b=aW(b);var d=new nA;X(d,1,c);var e=new VB;X(e,1,d);X(e,3,!0);qXc(e,!0);this.O.C(new y7c(e,b));u0(this,a.Ji(),!1,W6c(kA(c)))};p.wgb=function(){var a=this.C.isVisible();this.Ag().setVisible(!a);a||this.C.focus();Jkd(this,!a)};function Jkd(a,b){b?(u0(a,2253),a.Sa=Ea()):u0(a,2226,!0)}p.Kma=function(){this.C.isVisible()||this.Nv(!0)};
p.Asb=function(){var a=ykd(this.C);a&&(a.yb()?mjd(a,"",!0):(this.Kma(),ljd(a,"",!0)))};p.ryb=function(a){Djd(this.C,a)};p.Hyb=function(){Akd(this.C,!0)};p.iUb=function(){VV(this.J.C)||(this.J.C.reset(),Ikd(this,!1))};p.gUb=function(){if(eM(this.Na)&&null==this.C.R){var a=VV(this.J.C);a&&TJ(this.F)!=a.jb()||Ikd(this,!0)}};
function Ikd(a,b,c){if(c){if(!c.length)return;if(1==c.length&&a.L&&c[0].equals(a.L)){a.L=null;return}}var d=a.C;d.isVisible()&&(d.Ra.refresh(void 0),Fjd(d));a.J.update(!b,a.C.isVisible(),c)}p.U1a=function(){Kkd(this)};function Kkd(a){a.oa&&(K(a.oa.Qa(),!1),xb(a.oa,a.Ga),a.oa=null,a.Ga=null,a.$a=null)}p.Wlb=function(){Kkd(this);var a=Bkd(this.C);a&&(this.Kma(),a.setActive(!0),a.dispatchEvent("Ye"))};
p.Sib=function(a){var b=this,c=(a=a.C)?a.H:null,d=a?a.C:0,e=!!a&&a.F,f=a?a.H.rect:null;f=!!f&&f.Zg()>=Fpb&&mB(f,"r")>=Hpb&&mB(f,"c")>=Ipb&&f.Zg()<=Gpb;Lkd(this,c,!!a&&a.D&&f);c.equals(this.$a)||Kkd(this);f&&(Mkd(this,c,d,e),aed(this.La)&&(this.Da&&(this.Da.cancel(),this.Da=null),!this.C.isVisible()&&c&&(this.Da=s7c(this.rb,[c]),this.Da.then(function(a){a.C.length&&(b.$a=c,b.oa=new Ekd,b.Ba(b.oa),b.oa.show(),b.Ga=new xe(b),b.Ba(b.Ga),b.Ga.subscribe((Zj(),vma),"action",b.Wlb).subscribe(xma,"action",
b.U1a),bM(b.La,"ritz-DisplayExplorePivotPromoV2",!1))}))))};function Lkd(a,b,c){if(c!==a.gb||b&&!b.intersects(a.H))a.gb=c,a.H=b,a.Sa=Ea(),Trb.Ob({G6:c,Dx:b})}p.vua=function(a){var b=this;this.C.ud=!0;var c=PJ(HK(this.F));if(!PYa.C&&!c){var d=a||this.Ra;this.Ag().setVisible(!0);this.Aa.C(2225,d);u0(this,2253);a=new im(function(){b.C.isVisible()||b.Aa.C(2752,d)},5E3);this.Ba(a);a.start()}};
function Mkd(a,b,c,d){if(b&&b.rect){var e=1E3>=b.rect.Zg();b=ritz_api.RitzModelApi.isFormsRegion(b.C,b.rect.top,b.rect.left,b.rect.height+b.rect.top,b.rect.width+b.rect.left);d=!a.C.isVisible()&&!a.Ua&&d&&e&&!a.Na.qh();e=I(H(),"feeaof")&&b;b=I(H(),"feeaoro")&&a.Na.Md();d&&(e||b)&&(d=new dk,G(d,1,c),G(d,2,e),G(d,3,b),G(d,5,gE),G(d,6,Hkd()),c=new bk,xf(c,58,d),c=Qm(Pm(new Om,10),c).build(),a.vua(c))}}
function Hkd(){switch(Jpb){case "NO_DELAY":return 1;case "DELAY_500MS":return 2;case "DELAY_1S":return 3;case "DELAY_2S":return 4;default:return 0}}p.zgb=function(){this.C.Ic()};p.jUb=function(a){var b=a.C,c=aW(b.H);this.L=yB(c);$Cc(this.O.D);Yjd(b,c);u0(this,a.Ji())};p.eUb=function(){oI(this.F)?(this.C.Pa(!0),this.J.C.reset(),Ikd(this,!1)):(this.Ag().setVisible(!1),this.J.C.reset(),this.C.Pa(!1))};p.Wob=function(){this.C.G$(!Urb.isEnabled())};p.LEa=function(a){Ikd(this,!1,OCb(a))};
p.$fb=function(a){var b=HK(this.F),c=b.kc(),d=[],e=o7c(b);if(e){b=new LC;var f=Gx(e,2);X(b,3,f);f=Gx(e,2);X(b,2,f);e=Gx(e,1);X(b,1,e);d.push(b)}b=a.C.yc;for(e=0;e<b.length;e++)f=new LC,X(f,2,b[e]),d.push(f);this.O.C(new x7c(d,c));u0(this,a.Ji())};
p.Yfb=function(a){var b=a.C,c=f7c(b.C),d=aW(b.H),e=c.ju?c.Vw:null,f=c.C?c.ww:null,h=d.jb(),k=Nkd(d);this.L=yB(d);k?this.O.C(new z7c(k,h,this.L,e,c.Tr,c.Ps,f)):this.O.C(new u7c(h,this.L,e,c.Tr,c.Ps,f));d=new FYc;G(d,1,1);c=new XV;b=V(b.H,2);G(c,2,b);xf(c,5,d);b=Gfd(this.H,TJ(this.F));xf(b,46,c);b=Qm(Pm(new Om,10),b).build();this.Aa.C(a.Ji(),b)};p.wvb=function(a){a=a.C;var b=aW(a.H),c=Nkd(b);this.L=yB(b);this.O.C(new w7c(c));Yjd(a,b)};
p.hUb=function(a){var b=vB(a.getTableRange()),c=Efd(b,a.F,a.ma),d=this.J,e=a.F;wXc(d.C);d.C.oa=b;d.C.Na=c;d.C.Oa=e;MXc(d.C,!0,!0,!1);u0(this,a.Ji());a.getTableRange().C!=TJ(this.F)&&(c=a.getTableRange().C,c=MK(this.F,c))&&(c=bJ(c),this.Ma.V(c,"zb",this.LEa),this.Ma.V(c,"oc",this.HDa));a.R&&(ykd(this.C)&&ykd(this.C).mM(!0,!1,!0),a=this.C,b=[b],a.isVisible()&&(a.Ra.refresh(b),Fjd(a)))};p.HDa=function(a){this.J.C.ud[a.Sa]=a.Ua;Xrb.setVisible(!0);Yrb.Ob();$H("Explore is open to help you create content faster.")};
function Nkd(a){var b=a.jb();a=yB(a);b=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(b,a.rc(),a.qc(),a.Zc(),a.ad(),7,!1);return 0<b.length?b[0]:null}p.shb=function(a){var b=a.Na;GJ(HK(this.F),b);u0(this,a.Ji())};
p.Nyb=function(a){var b=a.C;a=a.Ji();if(b instanceof d0||b instanceof f0||b instanceof bkd)u0(this,a);else{var c=Ejd(this.C),d=new XV,e=V(b.H,2);c=c.indexOf(b);G(d,1,c);G(d,2,e);e=new bk;xf(e,46,d);if(b instanceof N_){(d=b.J)?(b=Okd(this,b,d),b=J4c(b,d,d.qj)):b=null;if(!b)return;xf(e,39,b)}else if(b instanceof Xfd){var f=b.H;c=new ked;if(b instanceof Xfd)b=1;else throw Error("Unknown text analysis card type.");f=Fx(V(f,8),20).slice(0,10);G(c,2,f||[]);G(c,1,b);xf(d,3,c)}e=Qm(Pm(new Om,10),e).build();
this.Aa.C(a,e)}};p.jxb=function(){this.C.Ic()};p.fUb=function(a){var b=a.xw();if(b){var c=a.ma,d=Fx(c,1).map(function(a){return yB(a)});d=H_c(this.Na,d,a.H||void 0,a.O||void 0);VXc(d,c);XXc(d,b);this.Oa.dispatchEvent(new hO("objectRequest"));this.O.C(new XQ([d]));var e=Pkd(this,a.Ga);ced(e,d.getId()||0);F4c(this.Aa,a.Ji(),e,10,b,c,void 0,a.F)}};
p.Pob=function(a){var b=a.R;if(b){var c=a.H;c||(c=nB(nI(this.Oa).C.C));var d=16,e=16,f=a.O;f&&(d=f.x,e=f.y);f=YXc(this.Na.H);d={oid:null,ar:c.y,ac:c.x,x:d,y:e,h:rMb.height,w:rMb.width,p:{context:F_c(f)}};(c=b.qj)?(e=new ro(c),d=new ML(TJ(this.F)||"0",d,!1,!1),f=Bo(e,"headers"),f=null!=f&&na(f)&&Kb(f)?parseInt(f,10):-1,d.oa=f,d.J=0,f="1"==Bo(e,"transpose"),d.Da=f,d.F=f?"ROWS":"COLS",f=Bo(e,"range"),f=q_c($Gb(f,","),this.F),d.ZG(f),(e=Bo(e,"dt"))&&qNb(d,this.yc.yd(DD.Ca(),JSON.parse(decodeURIComponent(e))))):
(e=new MD,X(e,2,"0.6"),rXc(e,a.ge().toJSON()),d=new ML(TJ(this.F)||"0",d,!1,!1,e));OL(d);WXc(d,b);this.Oa.dispatchEvent(new hO("objectRequest"));this.O.C(new XQ([d]));e=Qkd(this,b,a.ma,a.ge());d=d.getId()||0;e.C=d;I4c(this.Aa,a.Ji(),e,10,b,c,void 0,a.F)}};function Okd(a,b,c){var d=Ejd(a.C).filter(function(a){return a instanceof N_});return Qkd(a,c,d.indexOf(b),b.J&&b.J.ge())}
function Pkd(a,b){var c=new ZX;a=Ejd(a.C).filter(function(a){return a instanceof N_}).map(function(a){return a.getChartType()});c.J=a;c.H=b;return c}function Qkd(a,b,c,d){var e=new ZX;a=Ejd(a.C).filter(function(a){return a instanceof N_}).map(function(a){return a.getChartType()});e.J=a;e.H=c;r4c(e,b.getChartType());e.D=d?d.clone():null;return e}
function u0(a,b,c,d){if(a.H){var e=vf(Ewa(a.Ra),dk,58).getTableRange();if(c||!e||e.jb()!=a.H.C||e.qc()!=a.H.rect.qc()||e.rc()!=a.H.rect.rc()||e.ad()!=a.H.rect.ad()||e.Zc()!=a.H.rect.Zc()){e=new dk;G(e,6,Hkd());var f=Ffd(a.H);xf(e,7,f);c&&(c=Ea()-a.Sa,G(e,8,1E3*c),null!=a.C.Wc&&(c=Ea()-a.C.Wc,G(e,10,1E3*c)));d&&hXc(e,d);d=I(H(),"feacos");G(e,9,d);d=new bk;xf(d,58,e);a.Ra=Pm(Qm(new Om,d),10).build()}}a.Aa.C(b,a.Ra)};function Rkd(){z.call(this)}w(Rkd,jE);Rkd.prototype.H=function(){return qjd};Rkd.prototype.F=function(){return s0};Rkd.prototype.D=function(){return Fkd};Rkd.prototype.C=function(){return Wed};pE("assistant",Rkd);
